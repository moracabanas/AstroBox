(function(g,k,h,r){Foundation.libs.abide={name:"abide",version:"5.5.3",settings:{live_validate:!0,validate_on_blur:!0,focus_on_invalid:!0,error_labels:!0,error_class:"error",timeout:1E3,patterns:{alpha:/^[a-zA-Z]+$/,alpha_numeric:/^[a-zA-Z0-9]+$/,integer:/^[-+]?\d+$/,number:/^[-+]?\d*(?:[\.\,]\d+)?$/,card:/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11})$/,cvv:/^([0-9]){3,4}$/,email:/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+$/,
url:/^(https?|ftp|file|ssh):\/\/([-;:&=\+\$,\w]+@{1})?([-A-Za-z0-9\.]+)+:?(\d+)?((\/[-\+~%\/\.\w]+)?\??([-\+=&;%@\.\w]+)?#?([\w]+)?)?/,domain:/^([a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,8}$/,datetime:/^([0-2][0-9]{3})\-([0-1][0-9])\-([0-3][0-9])T([0-5][0-9])\:([0-5][0-9])\:([0-5][0-9])(Z|([\-\+]([0-1][0-9])\:00))$/,date:/(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])-(?:30))|(?:(?:0[13578]|1[02])-31))$/,time:/^(0[0-9]|1[0-9]|2[0-3])(:[0-5][0-9]){2}$/,
dateISO:/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/,month_day_year:/^(0[1-9]|1[012])[- \/.](0[1-9]|[12][0-9]|3[01])[- \/.]\d{4}$/,day_month_year:/^(0[1-9]|[12][0-9]|3[01])[- \/.](0[1-9]|1[012])[- \/.]\d{4}$/,color:/^#?([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/},validators:{equalTo:function(a,d,b){return h.getElementById(a.getAttribute(this.add_namespace("data-equalto"))).value===a.value}}},timer:null,init:function(a,d,b){this.bindings(d,b)},events:function(a){function d(a,c){clearTimeout(b.timer);b.timer=setTimeout(function(){b.validate([a],
c)}.bind(a),e.timeout)}var b=this,c=b.S(a).attr("novalidate","novalidate"),e=c.data(this.attr_name(!0)+"-init")||{};this.invalid_attr=this.add_namespace("data-invalid");c.off(".abide").on("submit.fndtn.abide",function(a){var c=/ajax/i.test(b.S(this).attr(b.attr_name()));return b.validate(b.S(this).find("input, textarea, select").not(":hidden, [data-abide-ignore]").get(),a,c)}).on("validate.fndtn.abide",function(a){"manual"===e.validate_on&&b.validate([a.target],a)}).on("reset",function(a){return b.reset(g(this),
a)}).find("input, textarea, select").not(":hidden, [data-abide-ignore]").off(".abide").on("blur.fndtn.abide change.fndtn.abide",function(a){var b=this.getAttribute("id"),b=c.find('[data-equalto="'+b+'"]');e.validate_on_blur&&!0===e.validate_on_blur&&d(this,a);"undefined"!==typeof b.get(0)&&b.val().length&&d(b.get(0),a);"change"===e.validate_on&&d(this,a)}).on("keydown.fndtn.abide",function(a){var b=this.getAttribute("id"),b=c.find('[data-equalto="'+b+'"]');e.live_validate&&!0===e.live_validate&&9!=
a.which&&d(this,a);"undefined"!==typeof b.get(0)&&b.val().length&&d(b.get(0),a);"tab"===e.validate_on&&9===a.which?d(this,a):"change"===e.validate_on&&d(this,a)}).on("focus",function(a){navigator.userAgent.match(/iPad|iPhone|Android|BlackBerry|Windows Phone|webOS/i)&&g("html, body").animate({scrollTop:g(a.target).offset().top},100)})},reset:function(a,d){a.removeAttr(this.invalid_attr);g("["+this.invalid_attr+"]",a).removeAttr(this.invalid_attr);g("."+this.settings.error_class,a).not("small").removeClass(this.settings.error_class);
g(":input",a).not(":button, :submit, :reset, :hidden, [data-abide-ignore]").val("").removeAttr(this.invalid_attr)},validate:function(a,d,b){var c=this.parse_patterns(a),e=c.length,g=this.S(a[0]).closest("form");d=/submit/.test(d.type);for(var f=0;f<e;f++)if(!c[f]&&(d||b))return this.settings.focus_on_invalid&&a[f].focus(),g.trigger("invalid.fndtn.abide"),this.S(a[f]).closest("form").attr(this.invalid_attr,""),!1;(d||b)&&g.trigger("valid.fndtn.abide");g.removeAttr(this.invalid_attr);return b?!1:!0},
parse_patterns:function(a){for(var d=a.length,b=[];d--;)b.push(this.pattern(a[d]));return this.check_validation_and_apply_styles(b)},pattern:function(a){var d=a.getAttribute("type"),b="string"===typeof a.getAttribute("required"),c=a.getAttribute("pattern")||"";if(this.settings.patterns.hasOwnProperty(c)&&0<c.length)return[a,this.settings.patterns[c],b];if(0<c.length)return[a,new RegExp(c),b];if(this.settings.patterns.hasOwnProperty(d))return[a,this.settings.patterns[d],b];c=/.*/;return[a,c,b]},check_validation_and_apply_styles:function(a){var d=
a.length,b=[];if(0==d)return b;for(this.S(a[0][0]).closest("[data-"+this.attr_name(!0)+"]").data(this.attr_name(!0)+"-init");d--;){var c=a[d][0],e=a[d][2],p=c.value.trim(),f=this.S(c).parent(),n=c.getAttribute(this.add_namespace("data-abide-validator")),h="radio"===c.type,k="checkbox"===c.type,m=this.S('label[for="'+c.getAttribute("id")+'"]'),q=e?0<c.value.length:!0,l=[];c.getAttribute(this.add_namespace("data-equalto"))&&(n="equalTo");f=f.is("label")?f.parent():f;if(h&&e)l.push(this.valid_radio(c,
e));else if(k&&e)l.push(this.valid_checkbox(c,e));else if(n){n=n.split(" ");k=h=!0;for(q=0;q<n.length;q++)p=this.settings.validators[n[q]].apply(this,[c,e,f]),l.push(p),k=p&&h,h=p;k?(this.S(c).removeAttr(this.invalid_attr),f.removeClass("error"),0<m.length&&this.settings.error_labels&&m.removeClass(this.settings.error_class).removeAttr("role"),g(c).triggerHandler("valid")):(this.S(c).attr(this.invalid_attr,""),f.addClass("error"),0<m.length&&this.settings.error_labels&&m.addClass(this.settings.error_class).attr("role",
"alert"),g(c).triggerHandler("invalid"))}else a[d][1].test(p)&&q||!e&&1>c.value.length||g(c).attr("disabled")?l.push(!0):l.push(!1),l=[l.every(function(a){return a})],l[0]?(this.S(c).removeAttr(this.invalid_attr),c.setAttribute("aria-invalid","false"),c.removeAttribute("aria-describedby"),f.removeClass(this.settings.error_class),0<m.length&&this.settings.error_labels&&m.removeClass(this.settings.error_class).removeAttr("role"),g(c).triggerHandler("valid")):(this.S(c).attr(this.invalid_attr,""),c.setAttribute("aria-invalid",
"true"),e=f.find("small."+this.settings.error_class,"span."+this.settings.error_class),e=0<e.length?e[0].id:"",0<e.length&&c.setAttribute("aria-describedby",e),f.addClass(this.settings.error_class),0<m.length&&this.settings.error_labels&&m.addClass(this.settings.error_class).attr("role","alert"),g(c).triggerHandler("invalid"));b=b.concat(l)}return b},valid_checkbox:function(a,d){a=this.S(a);var b=a.is(":checked")||!d||a.get(0).getAttribute("disabled");b?(a.removeAttr(this.invalid_attr).parent().removeClass(this.settings.error_class),
g(a).triggerHandler("valid")):(a.attr(this.invalid_attr,"").parent().addClass(this.settings.error_class),g(a).triggerHandler("invalid"));return b},valid_radio:function(a,d){for(var b=a.getAttribute("name"),b=this.S(a).closest("[data-"+this.attr_name(!0)+"]").find("[name='"+b+"']"),c=b.length,e=!1,h=!1,f=0;f<c;f++)b[f].getAttribute("disabled")?e=h=!0:b[f].checked?e=!0:h&&(e=!1);for(f=0;f<c;f++)e?(this.S(b[f]).removeAttr(this.invalid_attr).parent().removeClass(this.settings.error_class),g(b[f]).triggerHandler("valid")):
(this.S(b[f]).attr(this.invalid_attr,"").parent().addClass(this.settings.error_class),g(b[f]).triggerHandler("invalid"));return e},valid_equal:function(a,d,b){(d=h.getElementById(a.getAttribute(this.add_namespace("data-equalto"))).value===a.value)?(this.S(a).removeAttr(this.invalid_attr),b.removeClass(this.settings.error_class),0<label.length&&settings.error_labels&&label.removeClass(this.settings.error_class)):(this.S(a).attr(this.invalid_attr,""),b.addClass(this.settings.error_class),0<label.length&&
settings.error_labels&&label.addClass(this.settings.error_class));return d},valid_oneof:function(a,d,b,c){a=this.S(a);d=this.S("["+this.add_namespace("data-oneof")+"]");(b=0<d.filter(":checked").length)?a.removeAttr(this.invalid_attr).parent().removeClass(this.settings.error_class):a.attr(this.invalid_attr,"").parent().addClass(this.settings.error_class);if(!c){var e=this;d.each(function(){e.valid_oneof.call(e,this,null,null,!0)})}return b},reflow:function(a,d){var b=this,c=b.S("["+this.attr_name()+
"]").attr("novalidate","novalidate");b.S(c).each(function(a,c){b.events(c)})}}})(jQuery,window,window.document);var LoginModal=Backbone.View.extend({el:"#login-modal",button:null,events:{"valid.fndtn.abide form":"onFormValidated","opened.fndtn.reveal":"onModalOpened"},initialize:function(){this.button=this.$el.find(".loading-button")},onFormValidated:function(g){g.preventDefault();var k=this.$el.find(".alert-box");k.hide();this.button.addClass("loading");$.ajax({url:"/api/astroprint/private-key",type:"POST",data:{email:this.$el.find("input[name=email]").val(),password:this.$el.find("input[name=password]").val()}}).done(function(){setTimeout(function(){location.reload()},
1E3)}).fail(_.bind(function(g){0!=g.status&&(503==g.status?k.text("AstroPrint.com can't be reached").show():k.text("Invalid Email/Password").show(),this.button.removeClass("loading"))},this));return!1},onModalOpened:function(){this.$el.find("input[name='email']").focus()}}),loginModal=new LoginModal;
