!function(b,d){"object"==typeof module&&"object"==typeof module.exports?module.exports=b.document?d(b,!0):function(b){if(!b.document)throw Error("jQuery requires a window with a document");return d(b)}:d(b)}("undefined"!=typeof window?window:this,function(b,d){function c(b){var c=b.length,d=k.type(b);return"function"===d||k.isWindow(b)?!1:1===b.nodeType&&c?!0:"array"===d||0===c||"number"==typeof c&&0<c&&c-1 in b}function f(b,c,d){if(k.isFunction(c))return k.grep(b,function(b,x){return!!c.call(b,x,
b)!==d});if(c.nodeType)return k.grep(b,function(b){return b===c!==d});if("string"==typeof c){if(va.test(c))return k.filter(c,b,d);c=k.filter(c,b)}return k.grep(b,function(b){return 0<=K.call(c,b)!==d})}function e(b,k){for(;(b=b[k])&&1!==b.nodeType;);return b}function g(b){var c=ta[b]={};return k.each(b.match(ja)||[],function(b,x){c[x]=!0}),c}function h(){I.removeEventListener("DOMContentLoaded",h,!1);b.removeEventListener("load",h,!1);k.ready()}function l(){Object.defineProperty(this.cache={},0,{get:function(){return{}}});
this.expando=k.expando+l.uid++}function m(b,c,d){var e;if(void 0===d&&1===b.nodeType)if(e="data-"+c.replace(nb,"-$1").toLowerCase(),d=b.getAttribute(e),"string"==typeof d){try{d="true"===d?!0:"false"===d?!1:"null"===d?null:+d+""===d?+d:ob.test(d)?k.parseJSON(d):d}catch(f){}ea.set(b,c,d)}else d=void 0;return d}function q(){return!0}function r(){return!1}function p(){try{return I.activeElement}catch(b){}}function t(b,c){return k.nodeName(b,"table")&&k.nodeName(11!==c.nodeType?c:c.firstChild,"tr")?b.getElementsByTagName("tbody")[0]||
b.appendChild(b.ownerDocument.createElement("tbody")):b}function s(b){return b.type=(null!==b.getAttribute("type"))+"/"+b.type,b}function u(b){var c=pb.exec(b.type);return c?b.type=c[1]:b.removeAttribute("type"),b}function w(b,c){for(var k=0,d=b.length;d>k;k++)J.set(b[k],"globalEval",!c||J.get(c[k],"globalEval"))}function A(b,c){var d,e,f,g,h,l;if(1===c.nodeType){if(J.hasData(b)&&(d=J.access(b),e=J.set(c,d),l=d.events))for(f in delete e.handle,e.events={},l)for(d=0,e=l[f].length;e>d;d++)k.event.add(c,
f,l[f][d]);ea.hasData(b)&&(g=ea.access(b),h=k.extend({},g),ea.set(c,h))}}function n(b,c){var d=b.getElementsByTagName?b.getElementsByTagName(c||"*"):b.querySelectorAll?b.querySelectorAll(c||"*"):[];return void 0===c||c&&k.nodeName(b,c)?k.merge([b],d):d}function H(x,c){var d,e=k(c.createElement(x)).appendTo(c.body),f=b.getDefaultComputedStyle&&(d=b.getDefaultComputedStyle(e[0]))?d.display:k.css(e[0],"display");return e.detach(),f}function y(b){var c=I,d=Ua[b];return d||(d=H(b,c),"none"!==d&&d||(Da=
(Da||k("<iframe frameborder='0' width='0' height='0'/>")).appendTo(c.documentElement),c=Da[0].contentDocument,c.write(),c.close(),d=H(b,c),Da.detach()),Ua[b]=d),d}function F(b,c,d){var e,f,g,h,l=b.style;return d=d||Ea(b),d&&(h=d.getPropertyValue(c)||d[c]),d&&(""!==h||k.contains(b.ownerDocument,b)||(h=k.style(b,c)),Ka.test(h)&&Va.test(c)&&(e=l.width,f=l.minWidth,g=l.maxWidth,l.minWidth=l.maxWidth=l.width=h,h=d.width,l.width=e,l.minWidth=f,l.maxWidth=g)),void 0!==h?h+"":h}function W(b,c){return{get:function(){return b()?
void delete this.get:(this.get=c).apply(this,arguments)}}}function ca(b,c){if(c in b)return c;for(var d=c[0].toUpperCase()+c.slice(1),k=c,e=Wa.length;e--;)if(c=Wa[e]+d,c in b)return c;return k}function T(b,c,d){return(b=qb.exec(c))?Math.max(0,b[1]-(d||0))+(b[2]||"px"):c}function Q(b,c,d,e,f){c=d===(e?"border":"content")?4:"width"===c?1:0;for(var g=0;4>c;c+=2)"margin"===d&&(g+=k.css(b,d+oa[c],!0,f)),e?("content"===d&&(g-=k.css(b,"padding"+oa[c],!0,f)),"margin"!==d&&(g-=k.css(b,"border"+oa[c]+"Width",
!0,f))):(g+=k.css(b,"padding"+oa[c],!0,f),"padding"!==d&&(g+=k.css(b,"border"+oa[c]+"Width",!0,f)));return g}function G(b,c,d){var e=!0,f="width"===c?b.offsetWidth:b.offsetHeight,g=Ea(b),h="border-box"===k.css(b,"boxSizing",!1,g);if(0>=f||null==f){if(f=F(b,c,g),(0>f||null==f)&&(f=b.style[c]),Ka.test(f))return f;e=h&&(X.boxSizingReliable()||f===b.style[c]);f=parseFloat(f)||0}return f+Q(b,c,d||(h?"border":"content"),e,g)+"px"}function V(b,c){for(var d,e,f,g=[],h=0,l=b.length;l>h;h++)e=b[h],e.style&&
(g[h]=J.get(e,"olddisplay"),d=e.style.display,c?(g[h]||"none"!==d||(e.style.display=""),""===e.style.display&&wa(e)&&(g[h]=J.access(e,"olddisplay",y(e.nodeName)))):(f=wa(e),"none"===d&&f||J.set(e,"olddisplay",f?d:k.css(e,"display"))));for(h=0;l>h;h++)e=b[h],e.style&&(c&&"none"!==e.style.display&&""!==e.style.display||(e.style.display=c?g[h]||"":"none"));return b}function C(b,c,d,k,e){return new C.prototype.init(b,c,d,k,e)}function R(){return setTimeout(function(){ua=void 0}),ua=k.now()}function U(b,
c){var d,k=0,e={height:b};for(c=c?1:0;4>k;k+=2-c)d=oa[k],e["margin"+d]=e["padding"+d]=b;return c&&(e.opacity=e.width=b),e}function Y(b,c,d){for(var k,e=(Aa[c]||[]).concat(Aa["*"]),f=0,g=e.length;g>f;f++)if(k=e[f].call(d,c,b))return k}function O(b,c){var d,e,f,g,h;for(d in b)if(e=k.camelCase(d),f=c[e],g=b[d],k.isArray(g)&&(f=g[1],g=b[d]=g[0]),d!==e&&(b[e]=g,delete b[d]),h=k.cssHooks[e],h&&"expand"in h)for(d in g=h.expand(g),delete b[e],g)d in b||(b[d]=g[d],c[d]=f);else c[e]=f}function E(b,c,d){var e,
f=0,g=Fa.length,h=k.Deferred().always(function(){delete l.elem}),l=function(){if(e)return!1;for(var c=ua||R(),c=Math.max(0,m.startTime+m.duration-c),d=1-(c/m.duration||0),k=0,f=m.tweens.length;f>k;k++)m.tweens[k].run(d);return h.notifyWith(b,[m,d,c]),1>d&&f?c:(h.resolveWith(b,[m]),!1)},m=h.promise({elem:b,props:k.extend({},c),opts:k.extend(!0,{specialEasing:{}},d),originalProperties:c,originalOptions:d,startTime:ua||R(),duration:d.duration,tweens:[],createTween:function(c,d){var e=k.Tween(b,m.opts,
c,d,m.opts.specialEasing[c]||m.opts.easing);return m.tweens.push(e),e},stop:function(c){var d=0,k=c?m.tweens.length:0;if(e)return this;for(e=!0;k>d;d++)m.tweens[d].run(1);return c?h.resolveWith(b,[m,c]):h.rejectWith(b,[m,c]),this}});d=m.props;for(O(d,m.opts.specialEasing);g>f;f++)if(c=Fa[f].call(m,b,d,m.opts))return c;return k.map(d,Y,m),k.isFunction(m.opts.start)&&m.opts.start.call(b,m),k.fx.timer(k.extend(l,{elem:b,anim:m,queue:m.opts.queue})),m.progress(m.opts.progress).done(m.opts.done,m.opts.complete).fail(m.opts.fail).always(m.opts.always)}
function ba(b){return function(c,d){"string"!=typeof c&&(d=c,c="*");var e,f=0,g=c.toLowerCase().match(ja)||[];if(k.isFunction(d))for(;e=g[f++];)"+"===e[0]?(e=e.slice(1)||"*",(b[e]=b[e]||[]).unshift(d)):(b[e]=b[e]||[]).push(d)}}function S(b,c,d,e){function f(l){var m;return g[l]=!0,k.each(b[l]||[],function(b,x){var k=x(c,d,e);return"string"!=typeof k||h||g[k]?h?!(m=k):void 0:(c.dataTypes.unshift(k),f(k),!1)}),m}var g={},h=b===La;return f(c.dataTypes[0])||!g["*"]&&f("*")}function P(b,c){var d,e,f=k.ajaxSettings.flatOptions||
{};for(d in c)void 0!==c[d]&&((f[d]?b:e||(e={}))[d]=c[d]);return e&&k.extend(!0,b,e),b}function L(b,c,d,e){var f;if(k.isArray(c))k.each(c,function(c,k){d||rb.test(b)?e(b,k):L(b+"["+("object"==typeof k?c:"")+"]",k,d,e)});else if(d||"object"!==k.type(c))e(b,c);else for(f in c)L(b+"["+f+"]",c[f],d,e)}function ga(b){return k.isWindow(b)?b:9===b.nodeType&&b.defaultView}var B=[],v=B.slice,z=B.concat,M=B.push,K=B.indexOf,D={},N=D.toString,ka=D.hasOwnProperty,X={},I=b.document,k=function(b,c){return new k.fn.init(b,
c)},Z=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,da=/^-ms-/,ha=/-([\da-z])/gi,aa=function(b,c){return c.toUpperCase()};k.fn=k.prototype={jquery:"2.1.3",constructor:k,selector:"",length:0,toArray:function(){return v.call(this)},get:function(b){return null!=b?0>b?this[b+this.length]:this[b]:v.call(this)},pushStack:function(b){b=k.merge(this.constructor(),b);return b.prevObject=this,b.context=this.context,b},each:function(b,c){return k.each(this,b,c)},map:function(b){return this.pushStack(k.map(this,function(c,
d){return b.call(c,d,c)}))},slice:function(){return this.pushStack(v.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(b){var c=this.length;b=+b+(0>b?c:0);return this.pushStack(0<=b&&c>b?[this[b]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:M,sort:B.sort,splice:B.splice};k.extend=k.fn.extend=function(){var b,c,d,e,f,g,h=arguments[0]||{},l=1,m=arguments.length,r=!1;"boolean"==typeof h&&(r=h,h=arguments[l]||{},l++);
"object"==typeof h||k.isFunction(h)||(h={});for(l===m&&(h=this,l--);m>l;l++)if(null!=(b=arguments[l]))for(c in b)d=h[c],e=b[c],h!==e&&(r&&e&&(k.isPlainObject(e)||(f=k.isArray(e)))?(f?(f=!1,g=d&&k.isArray(d)?d:[]):g=d&&k.isPlainObject(d)?d:{},h[c]=k.extend(r,g,e)):void 0!==e&&(h[c]=e));return h};k.extend({expando:"jQuery"+("2.1.3"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(b){throw Error(b);},noop:function(){},isFunction:function(b){return"function"===k.type(b)},isArray:Array.isArray,
isWindow:function(b){return null!=b&&b===b.window},isNumeric:function(b){return!k.isArray(b)&&0<=b-parseFloat(b)+1},isPlainObject:function(b){return"object"!==k.type(b)||b.nodeType||k.isWindow(b)?!1:b.constructor&&!ka.call(b.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(b){for(var c in b)return!1;return!0},type:function(b){return null==b?b+"":"object"==typeof b||"function"==typeof b?D[N.call(b)]||"object":typeof b},globalEval:function(b){var c,d=eval;(b=k.trim(b))&&(1===b.indexOf("use strict")?
(c=I.createElement("script"),c.text=b,I.head.appendChild(c).parentNode.removeChild(c)):d(b))},camelCase:function(b){return b.replace(da,"ms-").replace(ha,aa)},nodeName:function(b,c){return b.nodeName&&b.nodeName.toLowerCase()===c.toLowerCase()},each:function(b,d,k){var e,f=0,g=b.length,h=c(b);if(k)if(h)for(;g>f&&(e=d.apply(b[f],k),!1!==e);f++);else for(f in b){if(e=d.apply(b[f],k),!1===e)break}else if(h)for(;g>f&&(e=d.call(b[f],f,b[f]),!1!==e);f++);else for(f in b)if(e=d.call(b[f],f,b[f]),!1===e)break;
return b},trim:function(b){return null==b?"":(b+"").replace(Z,"")},makeArray:function(b,d){var e=d||[];return null!=b&&(c(Object(b))?k.merge(e,"string"==typeof b?[b]:b):M.call(e,b)),e},inArray:function(b,c,d){return null==c?-1:K.call(c,b,d)},merge:function(b,c){for(var d=+c.length,e=0,k=b.length;d>e;e++)b[k++]=c[e];return b.length=k,b},grep:function(b,c,d){for(var e=[],k=0,f=b.length,g=!d;f>k;k++)d=!c(b[k],k),d!==g&&e.push(b[k]);return e},map:function(b,d,e){var k,f=0,g=b.length,h=[];if(c(b))for(;g>
f;f++)k=d(b[f],f,e),null!=k&&h.push(k);else for(f in b)k=d(b[f],f,e),null!=k&&h.push(k);return z.apply([],h)},guid:1,proxy:function(b,c){var d,e,f;return"string"==typeof c&&(d=b[c],c=b,b=d),k.isFunction(b)?(e=v.call(arguments,2),f=function(){return b.apply(c||this,e.concat(v.call(arguments)))},f.guid=b.guid=b.guid||k.guid++,f):void 0},now:Date.now,support:X});k.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(b,c){D["[object "+c+"]"]=c.toLowerCase()});var fa=
function(b){function c(b,d,e,k){var f,x,g,h,l;if((d?d.ownerDocument||d:la)!==aa&&ha(d),d=d||aa,e=e||[],h=d.nodeType,"string"!=typeof b||!b||1!==h&&9!==h&&11!==h)return e;if(!k&&S){if(11!==h&&(f=ma.exec(b)))if(g=f[1])if(9===h){if(x=d.getElementById(g),!x||!x.parentNode)return e;if(x.id===g)return e.push(x),e}else{if(d.ownerDocument&&(x=d.ownerDocument.getElementById(g))&&R(d,x)&&x.id===g)return e.push(x),e}else{if(f[2])return U.apply(e,d.getElementsByTagName(b)),e;if((g=f[3])&&u.getElementsByClassName)return U.apply(e,
d.getElementsByClassName(g)),e}if(u.qsa&&(!C||!C.test(b))){if(x=f=P,g=d,l=1!==h&&b,1===h&&"object"!==d.nodeName.toLowerCase()){h=D(b);(f=d.getAttribute("id"))?x=f.replace(ua,"\\$&"):d.setAttribute("id",x);x="[id='"+x+"'] ";for(g=h.length;g--;)h[g]=x+p(h[g]);g=oa.test(b)&&r(d.parentNode)||d;l=h.join(",")}if(l)try{return U.apply(e,g.querySelectorAll(l)),e}catch(m){}finally{f||d.removeAttribute("id")}}}return M(b.replace(va,"$1"),d,e,k)}function d(){function b(d,e){return c.push(d+" ")>z.cacheLength&&
delete b[c.shift()],b[d+" "]=e}var c=[];return b}function e(b){return b[P]=!0,b}function k(b){var c=aa.createElement("div");try{return!!b(c)}catch(d){return!1}finally{c.parentNode&&c.parentNode.removeChild(c)}}function f(b,c){for(var d=b.split("|"),e=b.length;e--;)z.attrHandle[d[e]]=c}function g(b,c){var d=c&&b,e=d&&1===b.nodeType&&1===c.nodeType&&(~c.sourceIndex||-2147483648)-(~b.sourceIndex||-2147483648);if(e)return e;if(d)for(;d=d.nextSibling;)if(d===c)return-1;return b?1:-1}function h(b){return function(c){return"input"===
c.nodeName.toLowerCase()&&c.type===b}}function l(b){return function(c){var d=c.nodeName.toLowerCase();return("input"===d||"button"===d)&&c.type===b}}function m(b){return e(function(c){return c=+c,e(function(d,e){for(var k,f=b([],d.length,c),x=f.length;x--;)d[k=f[x]]&&(d[k]=!(e[k]=d[k]))})})}function r(b){return b&&"undefined"!=typeof b.getElementsByTagName&&b}function q(){}function p(b){for(var c=0,d=b.length,e="";d>c;c++)e+=b[c].value;return e}function B(b,c,d){var e=c.dir,k=d&&"parentNode"===e,
f=ka++;return c.first?function(c,d,f){for(;c=c[e];)if(1===c.nodeType||k)return b(c,d,f)}:function(c,d,x){var g,h,l=[y,f];if(x)for(;c=c[e];){if((1===c.nodeType||k)&&b(c,d,x))return!0}else for(;c=c[e];)if(1===c.nodeType||k){if(h=c[P]||(c[P]={}),(g=h[e])&&g[0]===y&&g[1]===f)return l[2]=g[2];if(h[e]=l,l[2]=b(c,d,x))return!0}}}function n(b){return 1<b.length?function(c,d,e){for(var k=b.length;k--;)if(!b[k](c,d,e))return!1;return!0}:b[0]}function O(b,c,d,e,k){for(var f,x=[],g=0,h=b.length,l=null!=c;h>g;g++)(f=
b[g])&&(!d||d(f,e,k))&&(x.push(f),l&&c.push(g));return x}function v(b,d,k,f,x,g){return f&&!f[P]&&(f=v(f)),x&&!x[P]&&(x=v(x,g)),e(function(e,g,h,l){var m,r,q=[],p=[],ia=g.length,B;if(!(B=e)){B=d||"*";for(var n=h.nodeType?[h]:h,za=[],v=0,t=n.length;t>v;v++)c(B,n[v],za);B=za}B=!b||!e&&d?B:O(B,q,b,h,l);n=k?x||(e?b:ia||f)?[]:g:B;if(k&&k(B,n,h,l),f)for(m=O(n,p),f(m,[],h,l),h=m.length;h--;)(r=m[h])&&(n[p[h]]=!(B[p[h]]=r));if(e){if(x||b){if(x){m=[];for(h=n.length;h--;)(r=n[h])&&m.push(B[h]=r);x(null,n=[],
m,l)}for(h=n.length;h--;)(r=n[h])&&-1<(m=x?G(e,r):q[h])&&(e[m]=!(g[m]=r))}}else n=O(n===g?n.splice(ia,n.length):n),x?x(null,g,n,l):U.apply(g,n)})}function t(b){var c,d,e,k=b.length,f=z.relative[b[0].type];d=f||z.relative[" "];for(var x=f?1:0,g=B(function(b){return b===c},d,!0),h=B(function(b){return-1<G(c,b)},d,!0),l=[function(b,d,e){b=!f&&(e||d!==K)||((c=d).nodeType?g(b,d,e):h(b,d,e));return c=null,b}];k>x;x++)if(d=z.relative[b[x].type])l=[B(n(l),d)];else{if(d=z.filter[b[x].type].apply(null,b[x].matches),
d[P]){for(e=++x;k>e&&!z.relative[b[e].type];e++);return v(1<x&&n(l),1<x&&p(b.slice(0,x-1).concat({value:" "===b[x-2].type?"*":""})).replace(va,"$1"),d,e>x&&t(b.slice(x,e)),k>e&&t(b=b.slice(e)),k>e&&p(b))}l.push(d)}return n(l)}function Z(b,d){var k=0<d.length,x=0<b.length,f=function(e,f,g,h,l){var m,r,p,q=0,ia="0",B=e&&[],n=[],za=K,v=e||x&&z.find.TAG("*",l),t=y+=null==za?1:Math.random()||.1,s=v.length;for(l&&(K=f!==aa&&f);ia!==s&&null!=(m=v[ia]);ia++){if(x&&m){for(r=0;p=b[r++];)if(p(m,f,g)){h.push(m);
break}l&&(y=t)}k&&((m=!p&&m)&&q--,e&&B.push(m))}if(q+=ia,k&&ia!==q){for(r=0;p=d[r++];)p(B,n,f,g);if(e){if(0<q)for(;ia--;)B[ia]||n[ia]||(n[ia]=Ga.call(h));n=O(n)}U.apply(h,n);l&&!e&&0<n.length&&1<q+d.length&&c.uniqueSort(h)}return l&&(y=t,K=za),B};return k?e(f):f}var s,u,z,E,da,D,w,M,K,fa,ba,ha,aa,A,S,C,N,H,R,P="sizzle"+1*new Date,la=b.document,y=0,ka=0,F=d(),T=d(),L=d(),Q=function(b,c){return b===c&&(ba=!0),0},X={}.hasOwnProperty,I=[],Ga=I.pop,xa=I.push,U=I.push,Y=I.slice,G=function(b,c){for(var d=
0,e=b.length;e>d;d++)if(b[d]===c)return d;return-1},ga="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w#"),W="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ga+"))|)[\\x20\\t\\r\\n\\f]*\\]",ca=":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+W+")*)|.*)\\)|)",J=/[\x20\t\r\n\f]+/g,va=/^[\x20\t\r\n\f]+|((?:^|[^\\])(?:\\.)*)[\x20\t\r\n\f]+$/g,
V=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,ya=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,pa=/=[\x20\t\r\n\f]*([^\]'"]*?)[\x20\t\r\n\f]*\]/g,Ma=new RegExp(ca),ea=new RegExp("^"+ga+"$"),ja={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:new RegExp("^("+"(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:new RegExp("^"+W),PSEUDO:new RegExp("^"+ca),CHILD:/^:(only|first|last|nth|nth-last)-(child|of-type)(?:\([\x20\t\r\n\f]*(even|odd|(([+-]|)(\d*)n|)[\x20\t\r\n\f]*(?:([+-]|)[\x20\t\r\n\f]*(\d+)|))[\x20\t\r\n\f]*\)|)/i,
bool:/^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$/i,needsContext:/^[\x20\t\r\n\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\([\x20\t\r\n\f]*((?:-\d)?\d*)[\x20\t\r\n\f]*\)|)(?=[^-]|$)/i},Na=/^(?:input|select|textarea|button)$/i,Oa=/^h\d$/i,ta=/^[^{]+\{\s*\[native \w/,ma=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,oa=/[+~]/,ua=/'|\\/g,qa=/\\([\da-f]{1,6}[\x20\t\r\n\f]?|([\x20\t\r\n\f])|.)/ig,ra=function(b,c,d){b="0x"+c-65536;
return b!==b||d?c:0>b?String.fromCharCode(b+65536):String.fromCharCode(b>>10|55296,1023&b|56320)},sa=function(){ha()};try{U.apply(I=Y.call(la.childNodes),la.childNodes),I[la.childNodes.length].nodeType}catch(wa){U={apply:I.length?function(b,c){xa.apply(b,Y.call(c))}:function(b,c){for(var d=b.length,e=0;b[d++]=c[e++];);b.length=d-1}}}u=c.support={};da=c.isXML=function(b){return(b=b&&(b.ownerDocument||b).documentElement)?"HTML"!==b.nodeName:!1};ha=c.setDocument=function(b){var c,d,e=b?b.ownerDocument||
b:la;return e!==aa&&9===e.nodeType&&e.documentElement?(aa=e,A=e.documentElement,d=e.defaultView,d&&d!==d.top&&(d.addEventListener?d.addEventListener("unload",sa,!1):d.attachEvent&&d.attachEvent("onunload",sa)),S=!da(e),u.attributes=k(function(b){return b.className="i",!b.getAttribute("className")}),u.getElementsByTagName=k(function(b){return b.appendChild(e.createComment("")),!b.getElementsByTagName("*").length}),u.getElementsByClassName=ta.test(e.getElementsByClassName),u.getById=k(function(b){return A.appendChild(b).id=
P,!e.getElementsByName||!e.getElementsByName(P).length}),u.getById?(z.find.ID=function(b,c){if("undefined"!=typeof c.getElementById&&S){var d=c.getElementById(b);return d&&d.parentNode?[d]:[]}},z.filter.ID=function(b){var c=b.replace(qa,ra);return function(b){return b.getAttribute("id")===c}}):(delete z.find.ID,z.filter.ID=function(b){var c=b.replace(qa,ra);return function(b){return(b="undefined"!=typeof b.getAttributeNode&&b.getAttributeNode("id"))&&b.value===c}}),z.find.TAG=u.getElementsByTagName?
function(b,c){return"undefined"!=typeof c.getElementsByTagName?c.getElementsByTagName(b):u.qsa?c.querySelectorAll(b):void 0}:function(b,c){var d,e=[],k=0,f=c.getElementsByTagName(b);if("*"===b){for(;d=f[k++];)1===d.nodeType&&e.push(d);return e}return f},z.find.CLASS=u.getElementsByClassName&&function(b,c){return S?c.getElementsByClassName(b):void 0},N=[],C=[],(u.qsa=ta.test(e.querySelectorAll))&&(k(function(b){A.appendChild(b).innerHTML="<a id='"+P+"'></a><select id='"+P+"-\f]' msallowcapture=''><option selected=''></option></select>";
b.querySelectorAll("[msallowcapture^='']").length&&C.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");b.querySelectorAll("[selected]").length||C.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");b.querySelectorAll("[id~="+P+"-]").length||C.push("~=");b.querySelectorAll(":checked").length||C.push(":checked");b.querySelectorAll("a#"+P+"+*").length||C.push(".#.+[+~]")}),k(function(b){var c=
e.createElement("input");c.setAttribute("type","hidden");b.appendChild(c).setAttribute("name","D");b.querySelectorAll("[name=d]").length&&C.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?=");b.querySelectorAll(":enabled").length||C.push(":enabled",":disabled");b.querySelectorAll("*,:x");C.push(",.*:")})),(u.matchesSelector=ta.test(H=A.matches||A.webkitMatchesSelector||A.mozMatchesSelector||A.oMatchesSelector||A.msMatchesSelector))&&k(function(b){u.disconnectedMatch=H.call(b,"div");H.call(b,"[s!='']:x");N.push("!=",
ca)}),C=C.length&&new RegExp(C.join("|")),N=N.length&&new RegExp(N.join("|")),c=ta.test(A.compareDocumentPosition),R=c||ta.test(A.contains)?function(b,c){var d=9===b.nodeType?b.documentElement:b,e=c&&c.parentNode;return b===e||!(!e||1!==e.nodeType||!(d.contains?d.contains(e):b.compareDocumentPosition&&16&b.compareDocumentPosition(e)))}:function(b,c){if(c)for(;c=c.parentNode;)if(c===b)return!0;return!1},Q=c?function(b,c){if(b===c)return ba=!0,0;var d=!b.compareDocumentPosition-!c.compareDocumentPosition;
return d?d:(d=(b.ownerDocument||b)===(c.ownerDocument||c)?b.compareDocumentPosition(c):1,1&d||!u.sortDetached&&c.compareDocumentPosition(b)===d?b===e||b.ownerDocument===la&&R(la,b)?-1:c===e||c.ownerDocument===la&&R(la,c)?1:fa?G(fa,b)-G(fa,c):0:4&d?-1:1)}:function(b,c){if(b===c)return ba=!0,0;var d,k=0;d=b.parentNode;var f=c.parentNode,x=[b],h=[c];if(!d||!f)return b===e?-1:c===e?1:d?-1:f?1:fa?G(fa,b)-G(fa,c):0;if(d===f)return g(b,c);for(d=b;d=d.parentNode;)x.unshift(d);for(d=c;d=d.parentNode;)h.unshift(d);
for(;x[k]===h[k];)k++;return k?g(x[k],h[k]):x[k]===la?-1:h[k]===la?1:0},e):aa};c.matches=function(b,d){return c(b,null,null,d)};c.matchesSelector=function(b,d){if((b.ownerDocument||b)!==aa&&ha(b),d=d.replace(pa,"='$1']"),!(!u.matchesSelector||!S||N&&N.test(d)||C&&C.test(d)))try{var e=H.call(b,d);if(e||u.disconnectedMatch||b.document&&11!==b.document.nodeType)return e}catch(k){}return 0<c(d,aa,null,[b]).length};c.contains=function(b,c){return(b.ownerDocument||b)!==aa&&ha(b),R(b,c)};c.attr=function(b,
c){(b.ownerDocument||b)!==aa&&ha(b);var d=z.attrHandle[c.toLowerCase()],d=d&&X.call(z.attrHandle,c.toLowerCase())?d(b,c,!S):void 0;return void 0!==d?d:u.attributes||!S?b.getAttribute(c):(d=b.getAttributeNode(c))&&d.specified?d.value:null};c.error=function(b){throw Error("Syntax error, unrecognized expression: "+b);};c.uniqueSort=function(b){var c,d=[],e=0,k=0;if(ba=!u.detectDuplicates,fa=!u.sortStable&&b.slice(0),b.sort(Q),ba){for(;c=b[k++];)c===b[k]&&(e=d.push(k));for(;e--;)b.splice(d[e],1)}return fa=
null,b};E=c.getText=function(b){var c,d="",e=0;if(c=b.nodeType)if(1===c||9===c||11===c){if("string"==typeof b.textContent)return b.textContent;for(b=b.firstChild;b;b=b.nextSibling)d+=E(b)}else{if(3===c||4===c)return b.nodeValue}else for(;c=b[e++];)d+=E(c);return d};z=c.selectors={cacheLength:50,createPseudo:e,match:ja,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(b){return b[1]=
b[1].replace(qa,ra),b[3]=(b[3]||b[4]||b[5]||"").replace(qa,ra),"~="===b[2]&&(b[3]=" "+b[3]+" "),b.slice(0,4)},CHILD:function(b){return b[1]=b[1].toLowerCase(),"nth"===b[1].slice(0,3)?(b[3]||c.error(b[0]),b[4]=+(b[4]?b[5]+(b[6]||1):2*("even"===b[3]||"odd"===b[3])),b[5]=+(b[7]+b[8]||"odd"===b[3])):b[3]&&c.error(b[0]),b},PSEUDO:function(b){var c,d=!b[6]&&b[2];return ja.CHILD.test(b[0])?null:(b[3]?b[2]=b[4]||b[5]||"":d&&Ma.test(d)&&(c=D(d,!0))&&(c=d.indexOf(")",d.length-c)-d.length)&&(b[0]=b[0].slice(0,
c),b[2]=d.slice(0,c)),b.slice(0,3))}},filter:{TAG:function(b){var c=b.replace(qa,ra).toLowerCase();return"*"===b?function(){return!0}:function(b){return b.nodeName&&b.nodeName.toLowerCase()===c}},CLASS:function(b){var c=F[b+" "];return c||(c=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+b+"([\\x20\\t\\r\\n\\f]|$)"))&&F(b,function(b){return c.test("string"==typeof b.className&&b.className||"undefined"!=typeof b.getAttribute&&b.getAttribute("class")||"")})},ATTR:function(b,d,e){return function(k){k=c.attr(k,
b);return null==k?"!="===d:d?(k+="","="===d?k===e:"!="===d?k!==e:"^="===d?e&&0===k.indexOf(e):"*="===d?e&&-1<k.indexOf(e):"$="===d?e&&k.slice(-e.length)===e:"~="===d?-1<(" "+k.replace(J," ")+" ").indexOf(e):"|="===d?k===e||k.slice(0,e.length+1)===e+"-":!1):!0}},CHILD:function(b,c,d,e,k){var f="nth"!==b.slice(0,3),x="last"!==b.slice(-4),h="of-type"===c;return 1===e&&0===k?function(b){return!!b.parentNode}:function(c,d,g){var l,m,na,r,q;d=f!==x?"nextSibling":"previousSibling";var p=c.parentNode,ia=
h&&c.nodeName.toLowerCase();g=!g&&!h;if(p){if(f){for(;d;){for(m=c;m=m[d];)if(h?m.nodeName.toLowerCase()===ia:1===m.nodeType)return!1;q=d="only"===b&&!q&&"nextSibling"}return!0}if(q=[x?p.firstChild:p.lastChild],x&&g)for(g=p[P]||(p[P]={}),l=g[b]||[],r=l[0]===y&&l[1],na=l[0]===y&&l[2],m=r&&p.childNodes[r];m=++r&&m&&m[d]||(na=r=0)||q.pop();){if(1===m.nodeType&&++na&&m===c){g[b]=[y,r,na];break}}else if(g&&(l=(c[P]||(c[P]={}))[b])&&l[0]===y)na=l[1];else for(;(m=++r&&m&&m[d]||(na=r=0)||q.pop())&&((h?m.nodeName.toLowerCase()!==
ia:1!==m.nodeType)||!++na||(g&&((m[P]||(m[P]={}))[b]=[y,na]),m!==c)););return na-=k,na===e||0===na%e&&0<=na/e}}},PSEUDO:function(b,d){var k,f=z.pseudos[b]||z.setFilters[b.toLowerCase()]||c.error("unsupported pseudo: "+b);return f[P]?f(d):1<f.length?(k=[b,b,"",d],z.setFilters.hasOwnProperty(b.toLowerCase())?e(function(b,c){for(var e,k=f(b,d),x=k.length;x--;)e=G(b,k[x]),b[e]=!(c[e]=k[x])}):function(b){return f(b,0,k)}):f}},pseudos:{not:e(function(b){var c=[],d=[],k=w(b.replace(va,"$1"));return k[P]?
e(function(b,c,d,e){var f;d=k(b,null,e,[]);for(e=b.length;e--;)(f=d[e])&&(b[e]=!(c[e]=f))}):function(b,e,f){return c[0]=b,k(c,null,f,d),c[0]=null,!d.pop()}}),has:e(function(b){return function(d){return 0<c(b,d).length}}),contains:e(function(b){return b=b.replace(qa,ra),function(c){return-1<(c.textContent||c.innerText||E(c)).indexOf(b)}}),lang:e(function(b){return ea.test(b||"")||c.error("unsupported lang: "+b),b=b.replace(qa,ra).toLowerCase(),function(c){var d;do if(d=S?c.lang:c.getAttribute("xml:lang")||
c.getAttribute("lang"))return d=d.toLowerCase(),d===b||0===d.indexOf(b+"-");while((c=c.parentNode)&&1===c.nodeType);return!1}}),target:function(c){var d=b.location&&b.location.hash;return d&&d.slice(1)===c.id},root:function(b){return b===A},focus:function(b){return b===aa.activeElement&&(!aa.hasFocus||aa.hasFocus())&&!!(b.type||b.href||~b.tabIndex)},enabled:function(b){return!1===b.disabled},disabled:function(b){return!0===b.disabled},checked:function(b){var c=b.nodeName.toLowerCase();return"input"===
c&&!!b.checked||"option"===c&&!!b.selected},selected:function(b){return b.parentNode&&b.parentNode.selectedIndex,!0===b.selected},empty:function(b){for(b=b.firstChild;b;b=b.nextSibling)if(6>b.nodeType)return!1;return!0},parent:function(b){return!z.pseudos.empty(b)},header:function(b){return Oa.test(b.nodeName)},input:function(b){return Na.test(b.nodeName)},button:function(b){var c=b.nodeName.toLowerCase();return"input"===c&&"button"===b.type||"button"===c},text:function(b){var c;return"input"===b.nodeName.toLowerCase()&&
"text"===b.type&&(null==(c=b.getAttribute("type"))||"text"===c.toLowerCase())},first:m(function(){return[0]}),last:m(function(b,c){return[c-1]}),eq:m(function(b,c,d){return[0>d?d+c:d]}),even:m(function(b,c){for(var d=0;c>d;d+=2)b.push(d);return b}),odd:m(function(b,c){for(var d=1;c>d;d+=2)b.push(d);return b}),lt:m(function(b,c,d){for(c=0>d?d+c:d;0<=--c;)b.push(c);return b}),gt:m(function(b,c,d){for(d=0>d?d+c:d;++d<c;)b.push(d);return b})}};z.pseudos.nth=z.pseudos.eq;for(s in{radio:!0,checkbox:!0,
file:!0,password:!0,image:!0})z.pseudos[s]=h(s);for(s in{submit:!0,reset:!0})z.pseudos[s]=l(s);q.prototype=z.filters=z.pseudos;z.setFilters=new q;D=c.tokenize=function(b,d){var e,k,f,x,h,g,l;if(h=T[b+" "])return d?0:h.slice(0);h=b;g=[];for(l=z.preFilter;h;){e&&!(k=V.exec(h))||(k&&(h=h.slice(k[0].length)||h),g.push(f=[]));e=!1;(k=ya.exec(h))&&(e=k.shift(),f.push({value:e,type:k[0].replace(va," ")}),h=h.slice(e.length));for(x in z.filter)!(k=ja[x].exec(h))||l[x]&&!(k=l[x](k))||(e=k.shift(),f.push({value:e,
type:x,matches:k}),h=h.slice(e.length));if(!e)break}return d?h.length:h?c.error(b):T(b,g).slice(0)};return w=c.compile=function(b,c){var d,e=[],k=[],f=L[b+" "];if(!f){c||(c=D(b));for(d=c.length;d--;)f=t(c[d]),f[P]?e.push(f):k.push(f);f=L(b,Z(k,e));f.selector=b}return f},M=c.select=function(b,c,d,e){var k,f,x,h,g,l="function"==typeof b&&b,m=!e&&D(b=l.selector||b);if(d=d||[],1===m.length){if(f=m[0]=m[0].slice(0),2<f.length&&"ID"===(x=f[0]).type&&u.getById&&9===c.nodeType&&S&&z.relative[f[1].type]){if(c=
(z.find.ID(x.matches[0].replace(qa,ra),c)||[])[0],!c)return d;l&&(c=c.parentNode);b=b.slice(f.shift().value.length)}for(k=ja.needsContext.test(b)?0:f.length;k--&&(x=f[k],!z.relative[h=x.type]);)if((g=z.find[h])&&(e=g(x.matches[0].replace(qa,ra),oa.test(f[0].type)&&r(c.parentNode)||c))){if(f.splice(k,1),b=e.length&&p(f),!b)return U.apply(d,e),d;break}}return(l||w(b,m))(e,c,!S,d,oa.test(b)&&r(c.parentNode)||c),d},u.sortStable=P.split("").sort(Q).join("")===P,u.detectDuplicates=!!ba,ha(),u.sortDetached=
k(function(b){return 1&b.compareDocumentPosition(aa.createElement("div"))}),k(function(b){return b.innerHTML="<a href='#'></a>","#"===b.firstChild.getAttribute("href")})||f("type|href|height|width",function(b,c,d){return d?void 0:b.getAttribute(c,"type"===c.toLowerCase()?1:2)}),u.attributes&&k(function(b){return b.innerHTML="<input/>",b.firstChild.setAttribute("value",""),""===b.firstChild.getAttribute("value")})||f("value",function(b,c,d){return d||"input"!==b.nodeName.toLowerCase()?void 0:b.defaultValue}),
k(function(b){return null==b.getAttribute("disabled")})||f("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",function(b,c,d){var e;return d?void 0:!0===b[c]?c.toLowerCase():(e=b.getAttributeNode(c))&&e.specified?e.value:null}),c}(b);k.find=fa;k.expr=fa.selectors;k.expr[":"]=k.expr.pseudos;k.unique=fa.uniqueSort;k.text=fa.getText;k.isXMLDoc=fa.isXML;k.contains=fa.contains;var la=k.expr.match.needsContext,Ga=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,
va=/^.[^:#\[\.,]*$/;k.filter=function(b,c,d){var e=c[0];return d&&(b=":not("+b+")"),1===c.length&&1===e.nodeType?k.find.matchesSelector(e,b)?[e]:[]:k.find.matches(b,k.grep(c,function(b){return 1===b.nodeType}))};k.fn.extend({find:function(b){var c,d=this.length,e=[],f=this;if("string"!=typeof b)return this.pushStack(k(b).filter(function(){for(c=0;d>c;c++)if(k.contains(f[c],this))return!0}));for(c=0;d>c;c++)k.find(b,f[c],e);return e=this.pushStack(1<d?k.unique(e):e),e.selector=this.selector?this.selector+
" "+b:b,e},filter:function(b){return this.pushStack(f(this,b||[],!1))},not:function(b){return this.pushStack(f(this,b||[],!0))},is:function(b){return!!f(this,"string"==typeof b&&la.test(b)?k(b):b||[],!1).length}});var xa,Ma=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(k.fn.init=function(b,c){var d,e;if(!b)return this;if("string"==typeof b){if(d="<"===b[0]&&">"===b[b.length-1]&&3<=b.length?[null,b,null]:Ma.exec(b),!d||!d[1]&&c)return!c||c.jquery?(c||xa).find(b):this.constructor(c).find(b);if(d[1]){if(c=
c instanceof k?c[0]:c,k.merge(this,k.parseHTML(d[1],c&&c.nodeType?c.ownerDocument||c:I,!0)),Ga.test(d[1])&&k.isPlainObject(c))for(d in c)k.isFunction(this[d])?this[d](c[d]):this.attr(d,c[d]);return this}return e=I.getElementById(d[2]),e&&e.parentNode&&(this.length=1,this[0]=e),this.context=I,this.selector=b,this}return b.nodeType?(this.context=this[0]=b,this.length=1,this):k.isFunction(b)?"undefined"!=typeof xa.ready?xa.ready(b):b(k):(void 0!==b.selector&&(this.selector=b.selector,this.context=b.context),
k.makeArray(b,this))}).prototype=k.fn;xa=k(I);var Na=/^(?:parents|prev(?:Until|All))/,Oa={children:!0,contents:!0,next:!0,prev:!0};k.extend({dir:function(b,c,d){for(var e=[],f=void 0!==d;(b=b[c])&&9!==b.nodeType;)if(1===b.nodeType){if(f&&k(b).is(d))break;e.push(b)}return e},sibling:function(b,c){for(var d=[];b;b=b.nextSibling)1===b.nodeType&&b!==c&&d.push(b);return d}});k.fn.extend({has:function(b){var c=k(b,this),d=c.length;return this.filter(function(){for(var b=0;d>b;b++)if(k.contains(this,c[b]))return!0})},
closest:function(b,c){for(var d,e=0,f=this.length,h=[],g=la.test(b)||"string"!=typeof b?k(b,c||this.context):0;f>e;e++)for(d=this[e];d&&d!==c;d=d.parentNode)if(11>d.nodeType&&(g?-1<g.index(d):1===d.nodeType&&k.find.matchesSelector(d,b))){h.push(d);break}return this.pushStack(1<h.length?k.unique(h):h)},index:function(b){return b?"string"==typeof b?K.call(k(b),this[0]):K.call(this,b.jquery?b[0]:b):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(b,c){return this.pushStack(k.unique(k.merge(this.get(),
k(b,c))))},addBack:function(b){return this.add(null==b?this.prevObject:this.prevObject.filter(b))}});k.each({parent:function(b){return(b=b.parentNode)&&11!==b.nodeType?b:null},parents:function(b){return k.dir(b,"parentNode")},parentsUntil:function(b,c,d){return k.dir(b,"parentNode",d)},next:function(b){return e(b,"nextSibling")},prev:function(b){return e(b,"previousSibling")},nextAll:function(b){return k.dir(b,"nextSibling")},prevAll:function(b){return k.dir(b,"previousSibling")},nextUntil:function(b,
c,d){return k.dir(b,"nextSibling",d)},prevUntil:function(b,c,d){return k.dir(b,"previousSibling",d)},siblings:function(b){return k.sibling((b.parentNode||{}).firstChild,b)},children:function(b){return k.sibling(b.firstChild)},contents:function(b){return b.contentDocument||k.merge([],b.childNodes)}},function(b,c){k.fn[b]=function(d,e){var f=k.map(this,c,d);return"Until"!==b.slice(-5)&&(e=d),e&&"string"==typeof e&&(f=k.filter(e,f)),1<this.length&&(Oa[b]||k.unique(f),Na.test(b)&&f.reverse()),this.pushStack(f)}});
var ja=/\S+/g,ta={};k.Callbacks=function(b){b="string"==typeof b?ta[b]||g(b):k.extend({},b);var c,d,e,f,h,l,m=[],r=!b.once&&[],p=function(k){c=b.memory&&k;d=!0;l=f||0;f=0;h=m.length;for(e=!0;m&&h>l;l++)if(!1===m[l].apply(k[0],k[1])&&b.stopOnFalse){c=!1;break}e=!1;m&&(r?r.length&&p(r.shift()):c?m=[]:q.disable())},q={add:function(){if(m){var d=m.length;!function sb(c){k.each(c,function(c,d){var e=k.type(d);"function"===e?b.unique&&q.has(d)||m.push(d):d&&d.length&&"string"!==e&&sb(d)})}(arguments);e?
h=m.length:c&&(f=d,p(c))}return this},remove:function(){return m&&k.each(arguments,function(b,c){for(var d;-1<(d=k.inArray(c,m,d));)m.splice(d,1),e&&(h>=d&&h--,l>=d&&l--)}),this},has:function(b){return b?-1<k.inArray(b,m):!(!m||!m.length)},empty:function(){return m=[],h=0,this},disable:function(){return m=r=c=void 0,this},disabled:function(){return!m},lock:function(){return r=void 0,c||q.disable(),this},locked:function(){return!r},fireWith:function(b,c){return!m||d&&!r||(c=c||[],c=[b,c.slice?c.slice():
c],e?r.push(c):p(c)),this},fire:function(){return q.fireWith(this,arguments),this},fired:function(){return!!d}};return q};k.extend({Deferred:function(b){var c=[["resolve","done",k.Callbacks("once memory"),"resolved"],["reject","fail",k.Callbacks("once memory"),"rejected"],["notify","progress",k.Callbacks("memory")]],d="pending",e={state:function(){return d},always:function(){return f.done(arguments).fail(arguments),this},then:function(){var b=arguments;return k.Deferred(function(d){k.each(c,function(c,
h){var g=k.isFunction(b[c])&&b[c];f[h[1]](function(){var b=g&&g.apply(this,arguments);b&&k.isFunction(b.promise)?b.promise().done(d.resolve).fail(d.reject).progress(d.notify):d[h[0]+"With"](this===e?d.promise():this,g?[b]:arguments)})});b=null}).promise()},promise:function(b){return null!=b?k.extend(b,e):e}},f={};return e.pipe=e.then,k.each(c,function(b,k){var h=k[2],g=k[3];e[k[1]]=h.add;g&&h.add(function(){d=g},c[1^b][2].disable,c[2][2].lock);f[k[0]]=function(){return f[k[0]+"With"](this===f?e:this,
arguments),this};f[k[0]+"With"]=h.fireWith}),e.promise(f),b&&b.call(f,f),f},when:function(b){var c=0,d=v.call(arguments),e=d.length,f=1!==e||b&&k.isFunction(b.promise)?e:0,h=1===f?b:k.Deferred(),g=function(b,c,d){return function(e){c[b]=this;d[b]=1<arguments.length?v.call(arguments):e;d===l?h.notifyWith(c,d):--f||h.resolveWith(c,d)}},l,m,r;if(1<e)for(l=Array(e),m=Array(e),r=Array(e);e>c;c++)d[c]&&k.isFunction(d[c].promise)?d[c].promise().done(g(c,r,d)).fail(h.reject).progress(g(c,m,l)):--f;return f||
h.resolveWith(r,d),h.promise()}});var ya;k.fn.ready=function(b){return k.ready.promise().done(b),this};k.extend({isReady:!1,readyWait:1,holdReady:function(b){b?k.readyWait++:k.ready(!0)},ready:function(b){(!0===b?--k.readyWait:k.isReady)||(k.isReady=!0,!0!==b&&0<--k.readyWait||(ya.resolveWith(I,[k]),k.fn.triggerHandler&&(k(I).triggerHandler("ready"),k(I).off("ready"))))}});k.ready.promise=function(c){return ya||(ya=k.Deferred(),"complete"===I.readyState?setTimeout(k.ready):(I.addEventListener("DOMContentLoaded",
h,!1),b.addEventListener("load",h,!1))),ya.promise(c)};k.ready.promise();var pa=k.access=function(b,c,d,e,f,h,g){var l=0,m=b.length,r=null==d;if("object"===k.type(d))for(l in f=!0,d)k.access(b,c,l,d[l],!0,h,g);else if(void 0!==e&&(f=!0,k.isFunction(e)||(g=!0),r&&(g?(c.call(b,e),c=null):(r=c,c=function(b,c,d){return r.call(k(b),d)})),c))for(;m>l;l++)c(b[l],d,g?e:e.call(b[l],l,c(b[l],d)));return f?b:r?c.call(b):m?c(b[0],d):h};k.acceptData=function(b){return 1===b.nodeType||9===b.nodeType||!+b.nodeType};
l.uid=1;l.accepts=k.acceptData;l.prototype={key:function(b){if(!l.accepts(b))return 0;var c={},d=b[this.expando];if(!d){d=l.uid++;try{c[this.expando]={value:d},Object.defineProperties(b,c)}catch(e){c[this.expando]=d,k.extend(b,c)}}return this.cache[d]||(this.cache[d]={}),d},set:function(b,c,d){var e;b=this.key(b);var f=this.cache[b];if("string"==typeof c)f[c]=d;else if(k.isEmptyObject(f))k.extend(this.cache[b],c);else for(e in c)f[e]=c[e];return f},get:function(b,c){var d=this.cache[this.key(b)];
return void 0===c?d:d[c]},access:function(b,c,d){var e;return void 0===c||c&&"string"==typeof c&&void 0===d?(e=this.get(b,c),void 0!==e?e:this.get(b,k.camelCase(c))):(this.set(b,c,d),void 0!==d?d:c)},remove:function(b,c){var d,e,f=this.key(b),h=this.cache[f];if(void 0===c)this.cache[f]={};else for(k.isArray(c)?e=c.concat(c.map(k.camelCase)):(d=k.camelCase(c),c in h?e=[c,d]:(e=d,e=e in h?[e]:e.match(ja)||[])),d=e.length;d--;)delete h[e[d]]},hasData:function(b){return!k.isEmptyObject(this.cache[b[this.expando]]||
{})},discard:function(b){b[this.expando]&&delete this.cache[b[this.expando]]}};var J=new l,ea=new l,ob=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,nb=/([A-Z])/g;k.extend({hasData:function(b){return ea.hasData(b)||J.hasData(b)},data:function(b,c,d){return ea.access(b,c,d)},removeData:function(b,c){ea.remove(b,c)},_data:function(b,c,d){return J.access(b,c,d)},_removeData:function(b,c){J.remove(b,c)}});k.fn.extend({data:function(b,c){var d,e,f,h=this[0],g=h&&h.attributes;if(void 0===b){if(this.length&&(f=ea.get(h),
1===h.nodeType&&!J.get(h,"hasDataAttrs"))){for(d=g.length;d--;)g[d]&&(e=g[d].name,0===e.indexOf("data-")&&(e=k.camelCase(e.slice(5)),m(h,e,f[e])));J.set(h,"hasDataAttrs",!0)}return f}return"object"==typeof b?this.each(function(){ea.set(this,b)}):pa(this,function(c){var d,e=k.camelCase(b);if(h&&void 0===c){if((d=ea.get(h,b),void 0!==d)||(d=ea.get(h,e),void 0!==d)||(d=m(h,e,void 0),void 0!==d))return d}else this.each(function(){var d=ea.get(this,e);ea.set(this,e,c);-1!==b.indexOf("-")&&void 0!==d&&
ea.set(this,b,c)})},null,c,1<arguments.length,null,!0)},removeData:function(b){return this.each(function(){ea.remove(this,b)})}});k.extend({queue:function(b,c,d){var e;return b?(c=(c||"fx")+"queue",e=J.get(b,c),d&&(!e||k.isArray(d)?e=J.access(b,c,k.makeArray(d)):e.push(d)),e||[]):void 0},dequeue:function(b,c){c=c||"fx";var d=k.queue(b,c),e=d.length,f=d.shift(),h=k._queueHooks(b,c),g=function(){k.dequeue(b,c)};"inprogress"===f&&(f=d.shift(),e--);f&&("fx"===c&&d.unshift("inprogress"),delete h.stop,
f.call(b,g,h));!e&&h&&h.empty.fire()},_queueHooks:function(b,c){var d=c+"queueHooks";return J.get(b,d)||J.access(b,d,{empty:k.Callbacks("once memory").add(function(){J.remove(b,[c+"queue",d])})})}});k.fn.extend({queue:function(b,c){var d=2;return"string"!=typeof b&&(c=b,b="fx",d--),arguments.length<d?k.queue(this[0],b):void 0===c?this:this.each(function(){var d=k.queue(this,b,c);k._queueHooks(this,b);"fx"===b&&"inprogress"!==d[0]&&k.dequeue(this,b)})},dequeue:function(b){return this.each(function(){k.dequeue(this,
b)})},clearQueue:function(b){return this.queue(b||"fx",[])},promise:function(b,c){var d,e=1,f=k.Deferred(),h=this,g=this.length,l=function(){--e||f.resolveWith(h,[h])};"string"!=typeof b&&(c=b,b=void 0);for(b=b||"fx";g--;)(d=J.get(h[g],b+"queueHooks"))&&d.empty&&(e++,d.empty.add(l));return l(),f.promise(c)}});var Ha=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,oa=["Top","Right","Bottom","Left"],wa=function(b,c){return b=c||b,"none"===k.css(b,"display")||!k.contains(b.ownerDocument,b)},Xa=/^(?:checkbox|radio)$/i;
!function(){var b=I.createDocumentFragment().appendChild(I.createElement("div")),c=I.createElement("input");c.setAttribute("type","radio");c.setAttribute("checked","checked");c.setAttribute("name","t");b.appendChild(c);X.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked;b.innerHTML="<textarea>x</textarea>";X.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();X.focusinBubbles="onfocusin"in b;var tb=/^key/,ub=/^(?:mouse|pointer|contextmenu)|click/,Ya=/^(?:focusinfocus|focusoutblur)$/,
Za=/^([^.]*)(?:\.(.+)|)$/;k.event={global:{},add:function(b,c,d,e,f){var h,g,l,m,r,q,p,B,n,v;if(r=J.get(b))for(d.handler&&(h=d,d=h.handler,f=h.selector),d.guid||(d.guid=k.guid++),(m=r.events)||(m=r.events={}),(g=r.handle)||(g=r.handle=function(c){return"undefined"!==typeof k&&k.event.triggered!==c.type?k.event.dispatch.apply(b,arguments):void 0}),c=(c||"").match(ja)||[""],r=c.length;r--;)l=Za.exec(c[r])||[],n=v=l[1],l=(l[2]||"").split(".").sort(),n&&(p=k.event.special[n]||{},n=(f?p.delegateType:p.bindType)||
n,p=k.event.special[n]||{},q=k.extend({type:n,origType:v,data:e,handler:d,guid:d.guid,selector:f,needsContext:f&&k.expr.match.needsContext.test(f),namespace:l.join(".")},h),(B=m[n])||(B=m[n]=[],B.delegateCount=0,p.setup&&!1!==p.setup.call(b,e,l,g)||b.addEventListener&&b.addEventListener(n,g,!1)),p.add&&(p.add.call(b,q),q.handler.guid||(q.handler.guid=d.guid)),f?B.splice(B.delegateCount++,0,q):B.push(q),k.event.global[n]=!0)},remove:function(b,c,d,e,f){var h,g,l,m,r,p,q,B,n,v,O,t=J.hasData(b)&&J.get(b);
if(t&&(m=t.events)){c=(c||"").match(ja)||[""];for(r=c.length;r--;)if(l=Za.exec(c[r])||[],n=O=l[1],v=(l[2]||"").split(".").sort(),n){q=k.event.special[n]||{};n=(e?q.delegateType:q.bindType)||n;B=m[n]||[];l=l[2]&&new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)");for(g=h=B.length;h--;)p=B[h],!f&&O!==p.origType||d&&d.guid!==p.guid||l&&!l.test(p.namespace)||e&&e!==p.selector&&("**"!==e||!p.selector)||(B.splice(h,1),p.selector&&B.delegateCount--,q.remove&&q.remove.call(b,p));g&&!B.length&&(q.teardown&&
!1!==q.teardown.call(b,v,t.handle)||k.removeEvent(b,n,t.handle),delete m[n])}else for(n in m)k.event.remove(b,n+c[r],d,e,!0);k.isEmptyObject(m)&&(delete t.handle,J.remove(b,"events"))}},trigger:function(c,d,e,f){var h,g,l,m,r,p,q,B=[e||I],n=ka.call(c,"type")?c.type:c;h=ka.call(c,"namespace")?c.namespace.split("."):[];if(g=l=e=e||I,3!==e.nodeType&&8!==e.nodeType&&!Ya.test(n+k.event.triggered)&&(0<=n.indexOf(".")&&(h=n.split("."),n=h.shift(),h.sort()),r=0>n.indexOf(":")&&"on"+n,c=c[k.expando]?c:new k.Event(n,
"object"==typeof c&&c),c.isTrigger=f?2:3,c.namespace=h.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,c.result=void 0,c.target||(c.target=e),d=null==d?[c]:k.makeArray(d,[c]),q=k.event.special[n]||{},f||!q.trigger||!1!==q.trigger.apply(e,d))){if(!f&&!q.noBubble&&!k.isWindow(e)){m=q.delegateType||n;for(Ya.test(m+n)||(g=g.parentNode);g;g=g.parentNode)B.push(g),l=g;l===(e.ownerDocument||I)&&B.push(l.defaultView||l.parentWindow||b)}for(h=0;(g=B[h++])&&
!c.isPropagationStopped();)c.type=1<h?m:q.bindType||n,(p=(J.get(g,"events")||{})[c.type]&&J.get(g,"handle"))&&p.apply(g,d),(p=r&&g[r])&&p.apply&&k.acceptData(g)&&(c.result=p.apply(g,d),!1===c.result&&c.preventDefault());return c.type=n,f||c.isDefaultPrevented()||q._default&&!1!==q._default.apply(B.pop(),d)||!k.acceptData(e)||r&&k.isFunction(e[n])&&!k.isWindow(e)&&(l=e[r],l&&(e[r]=null),k.event.triggered=n,e[n](),k.event.triggered=void 0,l&&(e[r]=l)),c.result}},dispatch:function(b){b=k.event.fix(b);
var c,d,e,f,h,g=[],l=v.call(arguments);c=(J.get(this,"events")||{})[b.type]||[];var m=k.event.special[b.type]||{};if(l[0]=b,b.delegateTarget=this,!m.preDispatch||!1!==m.preDispatch.call(this,b)){g=k.event.handlers.call(this,b,c);for(c=0;(f=g[c++])&&!b.isPropagationStopped();)for(b.currentTarget=f.elem,d=0;(h=f.handlers[d++])&&!b.isImmediatePropagationStopped();)b.namespace_re&&!b.namespace_re.test(h.namespace)||(b.handleObj=h,b.data=h.data,e=((k.event.special[h.origType]||{}).handle||h.handler).apply(f.elem,
l),void 0===e||!1!==(b.result=e)||(b.preventDefault(),b.stopPropagation()));return m.postDispatch&&m.postDispatch.call(this,b),b.result}},handlers:function(b,c){var d,e,f,h,g=[],l=c.delegateCount,m=b.target;if(l&&m.nodeType&&(!b.button||"click"!==b.type))for(;m!==this;m=m.parentNode||this)if(!0!==m.disabled||"click"!==b.type){e=[];for(d=0;l>d;d++)h=c[d],f=h.selector+" ",void 0===e[f]&&(e[f]=h.needsContext?0<=k(f,this).index(m):k.find(f,this,null,[m]).length),e[f]&&e.push(h);e.length&&g.push({elem:m,
handlers:e})}return l<c.length&&g.push({elem:this,handlers:c.slice(l)}),g},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(b,c){return null==b.which&&(b.which=null!=c.charCode?c.charCode:c.keyCode),b}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(b,
c){var d,e,k,f=c.button;return null==b.pageX&&null!=c.clientX&&(d=b.target.ownerDocument||I,e=d.documentElement,k=d.body,b.pageX=c.clientX+(e&&e.scrollLeft||k&&k.scrollLeft||0)-(e&&e.clientLeft||k&&k.clientLeft||0),b.pageY=c.clientY+(e&&e.scrollTop||k&&k.scrollTop||0)-(e&&e.clientTop||k&&k.clientTop||0)),b.which||void 0===f||(b.which=1&f?1:2&f?3:4&f?2:0),b}},fix:function(b){if(b[k.expando])return b;var c,d,e;c=b.type;var f=b,h=this.fixHooks[c];h||(this.fixHooks[c]=h=ub.test(c)?this.mouseHooks:tb.test(c)?
this.keyHooks:{});e=h.props?this.props.concat(h.props):this.props;b=new k.Event(f);for(c=e.length;c--;)d=e[c],b[d]=f[d];return b.target||(b.target=I),3===b.target.nodeType&&(b.target=b.target.parentNode),h.filter?h.filter(b,f):b},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==p()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===p()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===
this.type&&this.click&&k.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(b){return k.nodeName(b.target,"a")}},beforeunload:{postDispatch:function(b){void 0!==b.result&&b.originalEvent&&(b.originalEvent.returnValue=b.result)}}},simulate:function(b,c,d,e){b=k.extend(new k.Event,d,{type:b,isSimulated:!0,originalEvent:{}});e?k.event.trigger(b,null,c):k.event.dispatch.call(c,b);b.isDefaultPrevented()&&d.preventDefault()}};k.removeEvent=function(b,c,d){b.removeEventListener&&b.removeEventListener(c,
d,!1)};k.Event=function(b,c){return this instanceof k.Event?(b&&b.type?(this.originalEvent=b,this.type=b.type,this.isDefaultPrevented=b.defaultPrevented||void 0===b.defaultPrevented&&!1===b.returnValue?q:r):this.type=b,c&&k.extend(this,c),this.timeStamp=b&&b.timeStamp||k.now(),void(this[k.expando]=!0)):new k.Event(b,c)};k.Event.prototype={isDefaultPrevented:r,isPropagationStopped:r,isImmediatePropagationStopped:r,preventDefault:function(){var b=this.originalEvent;this.isDefaultPrevented=q;b&&b.preventDefault&&
b.preventDefault()},stopPropagation:function(){var b=this.originalEvent;this.isPropagationStopped=q;b&&b.stopPropagation&&b.stopPropagation()},stopImmediatePropagation:function(){var b=this.originalEvent;this.isImmediatePropagationStopped=q;b&&b.stopImmediatePropagation&&b.stopImmediatePropagation();this.stopPropagation()}};k.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(b,c){k.event.special[b]={delegateType:c,bindType:c,handle:function(b){var d,
e=b.relatedTarget,f=b.handleObj;return(!e||e!==this&&!k.contains(this,e))&&(b.type=f.origType,d=f.handler.apply(this,arguments),b.type=c),d}}});X.focusinBubbles||k.each({focus:"focusin",blur:"focusout"},function(b,c){var d=function(b){k.event.simulate(c,b.target,k.event.fix(b),!0)};k.event.special[c]={setup:function(){var e=this.ownerDocument||this,k=J.access(e,c);k||e.addEventListener(b,d,!0);J.access(e,c,(k||0)+1)},teardown:function(){var e=this.ownerDocument||this,k=J.access(e,c)-1;k?J.access(e,
c,k):(e.removeEventListener(b,d,!0),J.remove(e,c))}}});k.fn.extend({on:function(b,c,d,e,f){var h,g;if("object"==typeof b){"string"!=typeof c&&(d=d||c,c=void 0);for(g in b)this.on(g,c,d,b[g],f);return this}if(null==d&&null==e?(e=c,d=c=void 0):null==e&&("string"==typeof c?(e=d,d=void 0):(e=d,d=c,c=void 0)),!1===e)e=r;else if(!e)return this;return 1===f&&(h=e,e=function(b){return k().off(b),h.apply(this,arguments)},e.guid=h.guid||(h.guid=k.guid++)),this.each(function(){k.event.add(this,b,e,d,c)})},one:function(b,
c,d,e){return this.on(b,c,d,e,1)},off:function(b,c,d){var e,f;if(b&&b.preventDefault&&b.handleObj)return e=b.handleObj,k(b.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this;if("object"==typeof b){for(f in b)this.off(f,c,b[f]);return this}return(!1===c||"function"==typeof c)&&(d=c,c=void 0),!1===d&&(d=r),this.each(function(){k.event.remove(this,b,d,c)})},trigger:function(b,c){return this.each(function(){k.event.trigger(b,c,this)})},triggerHandler:function(b,
c){var d=this[0];return d?k.event.trigger(b,c,d,!0):void 0}});var $a=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ab=/<([\w:]+)/,vb=/<|&#?\w+;/,wb=/<(?:script|style|link)/i,xb=/checked\s*(?:[^=]|=\s*.checked.)/i,bb=/^$|\/(?:java|ecma)script/i,pb=/^true\/(.*)/,yb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ma={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],
td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ma.optgroup=ma.option;ma.tbody=ma.tfoot=ma.colgroup=ma.caption=ma.thead;ma.th=ma.td;k.extend({clone:function(b,c,d){var e,f,h,g,l=b.cloneNode(!0),m=k.contains(b.ownerDocument,b);if(!(X.noCloneChecked||1!==b.nodeType&&11!==b.nodeType||k.isXMLDoc(b)))for(g=n(l),h=n(b),e=0,f=h.length;f>e;e++){var r=h[e],q=g[e],p=q.nodeName.toLowerCase();"input"===p&&Xa.test(r.type)?q.checked=r.checked:("input"===p||"textarea"===p)&&(q.defaultValue=
r.defaultValue)}if(c)if(d)for(h=h||n(b),g=g||n(l),e=0,f=h.length;f>e;e++)A(h[e],g[e]);else A(b,l);return g=n(l,"script"),0<g.length&&w(g,!m&&n(b,"script")),l},buildFragment:function(b,c,d,e){for(var f,h,g,l,m=c.createDocumentFragment(),r=[],q=0,p=b.length;p>q;q++)if(f=b[q],f||0===f)if("object"===k.type(f))k.merge(r,f.nodeType?[f]:f);else if(vb.test(f)){h=h||m.appendChild(c.createElement("div"));g=(ab.exec(f)||["",""])[1].toLowerCase();g=ma[g]||ma._default;h.innerHTML=g[1]+f.replace($a,"<$1></$2>")+
g[2];for(g=g[0];g--;)h=h.lastChild;k.merge(r,h.childNodes);h=m.firstChild;h.textContent=""}else r.push(c.createTextNode(f));m.textContent="";for(q=0;f=r[q++];)if((!e||-1===k.inArray(f,e))&&(l=k.contains(f.ownerDocument,f),h=n(m.appendChild(f),"script"),l&&w(h),d))for(g=0;f=h[g++];)bb.test(f.type||"")&&d.push(f);return m},cleanData:function(b){for(var c,d,e,f,h=k.event.special,g=0;void 0!==(d=b[g]);g++){if(k.acceptData(d)&&(f=d[J.expando],f&&(c=J.cache[f]))){if(c.events)for(e in c.events)h[e]?k.event.remove(d,
e):k.removeEvent(d,e,c.handle);J.cache[f]&&delete J.cache[f]}delete ea.cache[d[ea.expando]]}}});k.fn.extend({text:function(b){return pa(this,function(b){return void 0===b?k.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=b)})},null,b,arguments.length)},append:function(){return this.domManip(arguments,function(b){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||t(this,b).appendChild(b)})},prepend:function(){return this.domManip(arguments,
function(b){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var c=t(this,b);c.insertBefore(b,c.firstChild)}})},before:function(){return this.domManip(arguments,function(b){this.parentNode&&this.parentNode.insertBefore(b,this)})},after:function(){return this.domManip(arguments,function(b){this.parentNode&&this.parentNode.insertBefore(b,this.nextSibling)})},remove:function(b,c){for(var d,e=b?k.filter(b,this):this,f=0;null!=(d=e[f]);f++)c||1!==d.nodeType||k.cleanData(n(d)),d.parentNode&&
(c&&k.contains(d.ownerDocument,d)&&w(n(d,"script")),d.parentNode.removeChild(d));return this},empty:function(){for(var b,c=0;null!=(b=this[c]);c++)1===b.nodeType&&(k.cleanData(n(b,!1)),b.textContent="");return this},clone:function(b,c){return b=null==b?!1:b,c=null==c?b:c,this.map(function(){return k.clone(this,b,c)})},html:function(b){return pa(this,function(b){var c=this[0]||{},d=0,e=this.length;if(void 0===b&&1===c.nodeType)return c.innerHTML;if("string"==typeof b&&!wb.test(b)&&!ma[(ab.exec(b)||
["",""])[1].toLowerCase()]){b=b.replace($a,"<$1></$2>");try{for(;e>d;d++)c=this[d]||{},1===c.nodeType&&(k.cleanData(n(c,!1)),c.innerHTML=b);c=0}catch(f){}}c&&this.empty().append(b)},null,b,arguments.length)},replaceWith:function(){var b=arguments[0];return this.domManip(arguments,function(c){b=this.parentNode;k.cleanData(n(this));b&&b.replaceChild(c,this)}),b&&(b.length||b.nodeType)?this:this.remove()},detach:function(b){return this.remove(b,!0)},domManip:function(b,c){b=z.apply([],b);var d,e,f,h,
g=0,l=this.length,m=this,r=l-1,q=b[0],p=k.isFunction(q);if(p||1<l&&"string"==typeof q&&!X.checkClone&&xb.test(q))return this.each(function(d){var e=m.eq(d);p&&(b[0]=q.call(this,d,e.html()));e.domManip(b,c)});if(l&&(d=k.buildFragment(b,this[0].ownerDocument,!1,this),e=d.firstChild,1===d.childNodes.length&&(d=e),e)){e=k.map(n(d,"script"),s);for(f=e.length;l>g;g++)h=d,g!==r&&(h=k.clone(h,!0,!0),f&&k.merge(e,n(h,"script"))),c.call(this[g],h,g);if(f)for(d=e[e.length-1].ownerDocument,k.map(e,u),g=0;f>g;g++)h=
e[g],bb.test(h.type||"")&&!J.access(h,"globalEval")&&k.contains(d,h)&&(h.src?k._evalUrl&&k._evalUrl(h.src):k.globalEval(h.textContent.replace(yb,"")))}return this}});k.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(b,c){k.fn[b]=function(b){for(var d=[],e=k(b),f=e.length-1,h=0;f>=h;h++)b=h===f?this:this.clone(!0),k(e[h])[c](b),M.apply(d,b.get());return this.pushStack(d)}});var Da,Ua={},Va=/^margin/,Ka=new RegExp("^("+Ha+")(?!px)[a-z%]+$",
"i"),Ea=function(c){return c.ownerDocument.defaultView.opener?c.ownerDocument.defaultView.getComputedStyle(c,null):b.getComputedStyle(c,null)};!function(){var c,d,e=I.documentElement,f=I.createElement("div"),h=I.createElement("div");if(h.style){var g=function(){h.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute";h.innerHTML="";e.appendChild(f);var k=b.getComputedStyle(h,
null);c="1%"!==k.top;d="4px"===k.width;e.removeChild(f)};h.style.backgroundClip="content-box";h.cloneNode(!0).style.backgroundClip="";X.clearCloneStyle="content-box"===h.style.backgroundClip;f.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute";f.appendChild(h);b.getComputedStyle&&k.extend(X,{pixelPosition:function(){return g(),c},boxSizingReliable:function(){return null==d&&g(),d},reliableMarginRight:function(){var c,d=h.appendChild(I.createElement("div"));
return d.style.cssText=h.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",d.style.marginRight=d.style.width="0",h.style.width="1px",e.appendChild(f),c=!parseFloat(b.getComputedStyle(d,null).marginRight),e.removeChild(f),h.removeChild(d),c}})}}();k.swap=function(b,c,d,e){var f,k={};for(f in c)k[f]=b.style[f],b.style[f]=c[f];d=d.apply(b,e||[]);for(f in c)b.style[f]=k[f];return d};var zb=/^(none|table(?!-c[ea]).+)/,
qb=new RegExp("^("+Ha+")(.*)$","i"),Ab=new RegExp("^([+-])=("+Ha+")","i"),Bb={position:"absolute",visibility:"hidden",display:"block"},cb={letterSpacing:"0",fontWeight:"400"},Wa=["Webkit","O","Moz","ms"];k.extend({cssHooks:{opacity:{get:function(b,c){if(c){var d=F(b,"opacity");return""===d?"1":d}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(b,
c,d,e){if(b&&3!==b.nodeType&&8!==b.nodeType&&b.style){var f,h,g,l=k.camelCase(c),m=b.style;return c=k.cssProps[l]||(k.cssProps[l]=ca(m,l)),g=k.cssHooks[c]||k.cssHooks[l],void 0===d?g&&"get"in g&&void 0!==(f=g.get(b,!1,e))?f:m[c]:(h=typeof d,"string"===h&&(f=Ab.exec(d))&&(d=(f[1]+1)*f[2]+parseFloat(k.css(b,c)),h="number"),null!=d&&d===d&&("number"!==h||k.cssNumber[l]||(d+="px"),X.clearCloneStyle||""!==d||0!==c.indexOf("background")||(m[c]="inherit"),g&&"set"in g&&void 0===(d=g.set(b,d,e))||(m[c]=d)),
void 0)}},css:function(b,c,d,e){var f,h,g,l=k.camelCase(c);return c=k.cssProps[l]||(k.cssProps[l]=ca(b.style,l)),g=k.cssHooks[c]||k.cssHooks[l],g&&"get"in g&&(f=g.get(b,!0,d)),void 0===f&&(f=F(b,c,e)),"normal"===f&&c in cb&&(f=cb[c]),""===d||d?(h=parseFloat(f),!0===d||k.isNumeric(h)?h||0:f):f}});k.each(["height","width"],function(b,c){k.cssHooks[c]={get:function(b,d,e){return d?zb.test(k.css(b,"display"))&&0===b.offsetWidth?k.swap(b,Bb,function(){return G(b,c,e)}):G(b,c,e):void 0},set:function(b,
d,e){var f=e&&Ea(b);return T(b,d,e?Q(b,c,e,"border-box"===k.css(b,"boxSizing",!1,f),f):0)}}});k.cssHooks.marginRight=W(X.reliableMarginRight,function(b,c){return c?k.swap(b,{display:"inline-block"},F,[b,"marginRight"]):void 0});k.each({margin:"",padding:"",border:"Width"},function(b,c){k.cssHooks[b+c]={expand:function(d){var e=0,f={};for(d="string"==typeof d?d.split(" "):[d];4>e;e++)f[b+oa[e]+c]=d[e]||d[e-2]||d[0];return f}};Va.test(b)||(k.cssHooks[b+c].set=T)});k.fn.extend({css:function(b,c){return pa(this,
function(b,c,d){var e,f={},h=0;if(k.isArray(c)){d=Ea(b);for(e=c.length;e>h;h++)f[c[h]]=k.css(b,c[h],!1,d);return f}return void 0!==d?k.style(b,c,d):k.css(b,c)},b,c,1<arguments.length)},show:function(){return V(this,!0)},hide:function(){return V(this)},toggle:function(b){return"boolean"==typeof b?b?this.show():this.hide():this.each(function(){wa(this)?k(this).show():k(this).hide()})}});k.Tween=C;C.prototype={constructor:C,init:function(b,c,d,e,f,h){this.elem=b;this.prop=d;this.easing=f||"swing";this.options=
c;this.start=this.now=this.cur();this.end=e;this.unit=h||(k.cssNumber[d]?"":"px")},cur:function(){var b=C.propHooks[this.prop];return b&&b.get?b.get(this):C.propHooks._default.get(this)},run:function(b){var c,d=C.propHooks[this.prop];return this.pos=c=this.options.duration?k.easing[this.easing](b,this.options.duration*b,0,1,this.options.duration):b,this.now=(this.end-this.start)*c+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),d&&d.set?d.set(this):C.propHooks._default.set(this),
this}};C.prototype.init.prototype=C.prototype;C.propHooks={_default:{get:function(b){var c;return null==b.elem[b.prop]||b.elem.style&&null!=b.elem.style[b.prop]?(c=k.css(b.elem,b.prop,""),c&&"auto"!==c?c:0):b.elem[b.prop]},set:function(b){k.fx.step[b.prop]?k.fx.step[b.prop](b):b.elem.style&&(null!=b.elem.style[k.cssProps[b.prop]]||k.cssHooks[b.prop])?k.style(b.elem,b.prop,b.now+b.unit):b.elem[b.prop]=b.now}}};C.propHooks.scrollTop=C.propHooks.scrollLeft={set:function(b){b.elem.nodeType&&b.elem.parentNode&&
(b.elem[b.prop]=b.now)}};k.easing={linear:function(b){return b},swing:function(b){return.5-Math.cos(b*Math.PI)/2}};k.fx=C.prototype.init;k.fx.step={};var ua,Ia,Cb=/^(?:toggle|show|hide)$/,db=new RegExp("^(?:([+-])=|)("+Ha+")([a-z%]*)$","i"),Db=/queueHooks$/,Fa=[function(b,c,d){var e,f,h,g,l,m,r,q=this,p={},n=b.style,B=b.nodeType&&wa(b),v=J.get(b,"fxshow");d.queue||(g=k._queueHooks(b,"fx"),null==g.unqueued&&(g.unqueued=0,l=g.empty.fire,g.empty.fire=function(){g.unqueued||l()}),g.unqueued++,q.always(function(){q.always(function(){g.unqueued--;
k.queue(b,"fx").length||g.empty.fire()})}));1===b.nodeType&&("height"in c||"width"in c)&&(d.overflow=[n.overflow,n.overflowX,n.overflowY],m=k.css(b,"display"),r="none"===m?J.get(b,"olddisplay")||y(b.nodeName):m,"inline"===r&&"none"===k.css(b,"float")&&(n.display="inline-block"));d.overflow&&(n.overflow="hidden",q.always(function(){n.overflow=d.overflow[0];n.overflowX=d.overflow[1];n.overflowY=d.overflow[2]}));for(e in c)if(f=c[e],Cb.exec(f)){if(delete c[e],h=h||"toggle"===f,f===(B?"hide":"show")){if("show"!==
f||!v||void 0===v[e])continue;B=!0}p[e]=v&&v[e]||k.style(b,e)}else m=void 0;if(k.isEmptyObject(p))"inline"===("none"===m?y(b.nodeName):m)&&(n.display=m);else for(e in v?"hidden"in v&&(B=v.hidden):v=J.access(b,"fxshow",{}),h&&(v.hidden=!B),B?k(b).show():q.done(function(){k(b).hide()}),q.done(function(){var c;J.remove(b,"fxshow");for(c in p)k.style(b,c,p[c])}),p)c=Y(B?v[e]:0,e,q),e in v||(v[e]=c.start,B&&(c.end=c.start,c.start="width"===e||"height"===e?1:0))}],Aa={"*":[function(b,c){var d=this.createTween(b,
c),e=d.cur(),f=db.exec(c),h=f&&f[3]||(k.cssNumber[b]?"":"px"),g=(k.cssNumber[b]||"px"!==h&&+e)&&db.exec(k.css(d.elem,b)),l=1,m=20;if(g&&g[3]!==h){h=h||g[3];f=f||[];g=+e||1;do l=l||".5",g/=l,k.style(d.elem,b,g+h);while(l!==(l=d.cur()/e)&&1!==l&&--m)}return f&&(g=d.start=+g||+e||0,d.unit=h,d.end=f[1]?g+(f[1]+1)*f[2]:+f[2]),d}]};k.Animation=k.extend(E,{tweener:function(b,c){k.isFunction(b)?(c=b,b=["*"]):b=b.split(" ");for(var d,e=0,f=b.length;f>e;e++)d=b[e],Aa[d]=Aa[d]||[],Aa[d].unshift(c)},prefilter:function(b,
c){c?Fa.unshift(b):Fa.push(b)}});k.speed=function(b,c,d){var e=b&&"object"==typeof b?k.extend({},b):{complete:d||!d&&c||k.isFunction(b)&&b,duration:b,easing:d&&c||c&&!k.isFunction(c)&&c};return e.duration=k.fx.off?0:"number"==typeof e.duration?e.duration:e.duration in k.fx.speeds?k.fx.speeds[e.duration]:k.fx.speeds._default,(null==e.queue||!0===e.queue)&&(e.queue="fx"),e.old=e.complete,e.complete=function(){k.isFunction(e.old)&&e.old.call(this);e.queue&&k.dequeue(this,e.queue)},e};k.fn.extend({fadeTo:function(b,
c,d,e){return this.filter(wa).css("opacity",0).show().end().animate({opacity:c},b,d,e)},animate:function(b,c,d,e){var f=k.isEmptyObject(b),h=k.speed(c,d,e);c=function(){var c=E(this,k.extend({},b),h);(f||J.get(this,"finish"))&&c.stop(!0)};return c.finish=c,f||!1===h.queue?this.each(c):this.queue(h.queue,c)},stop:function(b,c,d){var e=function(b){var c=b.stop;delete b.stop;c(d)};return"string"!=typeof b&&(d=c,c=b,b=void 0),c&&!1!==b&&this.queue(b||"fx",[]),this.each(function(){var c=!0,f=null!=b&&
b+"queueHooks",h=k.timers,g=J.get(this);if(f)g[f]&&g[f].stop&&e(g[f]);else for(f in g)g[f]&&g[f].stop&&Db.test(f)&&e(g[f]);for(f=h.length;f--;)h[f].elem!==this||null!=b&&h[f].queue!==b||(h[f].anim.stop(d),c=!1,h.splice(f,1));!c&&d||k.dequeue(this,b)})},finish:function(b){return!1!==b&&(b=b||"fx"),this.each(function(){var c,d=J.get(this),e=d[b+"queue"];c=d[b+"queueHooks"];var f=k.timers,h=e?e.length:0;d.finish=!0;k.queue(this,b,[]);c&&c.stop&&c.stop.call(this,!0);for(c=f.length;c--;)f[c].elem===this&&
f[c].queue===b&&(f[c].anim.stop(!0),f.splice(c,1));for(c=0;h>c;c++)e[c]&&e[c].finish&&e[c].finish.call(this);delete d.finish})}});k.each(["toggle","show","hide"],function(b,c){var d=k.fn[c];k.fn[c]=function(b,e,f){return null==b||"boolean"==typeof b?d.apply(this,arguments):this.animate(U(c,!0),b,e,f)}});k.each({slideDown:U("show"),slideUp:U("hide"),slideToggle:U("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(b,c){k.fn[b]=function(b,d,e){return this.animate(c,
b,d,e)}});k.timers=[];k.fx.tick=function(){var b,c=0,d=k.timers;for(ua=k.now();c<d.length;c++)b=d[c],b()||d[c]!==b||d.splice(c--,1);d.length||k.fx.stop();ua=void 0};k.fx.timer=function(b){k.timers.push(b);b()?k.fx.start():k.timers.pop()};k.fx.interval=13;k.fx.start=function(){Ia||(Ia=setInterval(k.fx.tick,k.fx.interval))};k.fx.stop=function(){clearInterval(Ia);Ia=null};k.fx.speeds={slow:600,fast:200,_default:400};k.fn.delay=function(b,c){return b=k.fx?k.fx.speeds[b]||b:b,c=c||"fx",this.queue(c,function(c,
d){var e=setTimeout(c,b);d.stop=function(){clearTimeout(e)}})};(function(){var b=I.createElement("input"),c=I.createElement("select"),d=c.appendChild(I.createElement("option"));b.type="checkbox";X.checkOn=""!==b.value;X.optSelected=d.selected;c.disabled=!0;X.optDisabled=!d.disabled;b=I.createElement("input");b.value="t";b.type="radio";X.radioValue="t"===b.value})();var eb,Ba=k.expr.attrHandle;k.fn.extend({attr:function(b,c){return pa(this,k.attr,b,c,1<arguments.length)},removeAttr:function(b){return this.each(function(){k.removeAttr(this,
b)})}});k.extend({attr:function(b,c,d){var e,f,h=b.nodeType;if(b&&3!==h&&8!==h&&2!==h)return"undefined"===typeof b.getAttribute?k.prop(b,c,d):(1===h&&k.isXMLDoc(b)||(c=c.toLowerCase(),e=k.attrHooks[c]||(k.expr.match.bool.test(c)?eb:void 0)),void 0===d?e&&"get"in e&&null!==(f=e.get(b,c))?f:(f=k.find.attr(b,c),null==f?void 0:f):null!==d?e&&"set"in e&&void 0!==(f=e.set(b,d,c))?f:(b.setAttribute(c,d+""),d):void k.removeAttr(b,c))},removeAttr:function(b,c){var d,e,f=0,h=c&&c.match(ja);if(h&&1===b.nodeType)for(;d=
h[f++];)e=k.propFix[d]||d,k.expr.match.bool.test(d)&&(b[e]=!1),b.removeAttribute(d)},attrHooks:{type:{set:function(b,c){if(!X.radioValue&&"radio"===c&&k.nodeName(b,"input")){var d=b.value;return b.setAttribute("type",c),d&&(b.value=d),c}}}}});eb={set:function(b,c,d){return!1===c?k.removeAttr(b,d):b.setAttribute(d,d),d}};k.each(k.expr.match.bool.source.match(/\w+/g),function(b,c){var d=Ba[c]||k.find.attr;Ba[c]=function(b,c,e){var f,k;return e||(k=Ba[c],Ba[c]=f,f=null!=d(b,c,e)?c.toLowerCase():null,
Ba[c]=k),f}});var Eb=/^(?:input|select|textarea|button)$/i;k.fn.extend({prop:function(b,c){return pa(this,k.prop,b,c,1<arguments.length)},removeProp:function(b){return this.each(function(){delete this[k.propFix[b]||b]})}});k.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(b,c,d){var e,f,h,g=b.nodeType;if(b&&3!==g&&8!==g&&2!==g)return h=1!==g||!k.isXMLDoc(b),h&&(c=k.propFix[c]||c,f=k.propHooks[c]),void 0!==d?f&&"set"in f&&void 0!==(e=f.set(b,d,c))?e:b[c]=d:f&&"get"in f&&null!==
(e=f.get(b,c))?e:b[c]},propHooks:{tabIndex:{get:function(b){return b.hasAttribute("tabindex")||Eb.test(b.nodeName)||b.href?b.tabIndex:-1}}}});X.optSelected||(k.propHooks.selected={get:function(b){b=b.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null}});k.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),function(){k.propFix[this.toLowerCase()]=this});var Pa=/[\t\r\n\f]/g;k.fn.extend({addClass:function(b){var c,
d,e,f,h;c="string"==typeof b&&b;var g=0,l=this.length;if(k.isFunction(b))return this.each(function(c){k(this).addClass(b.call(this,c,this.className))});if(c)for(c=(b||"").match(ja)||[];l>g;g++)if(d=this[g],e=1===d.nodeType&&(d.className?(" "+d.className+" ").replace(Pa," "):" ")){for(h=0;f=c[h++];)0>e.indexOf(" "+f+" ")&&(e+=f+" ");e=k.trim(e);d.className!==e&&(d.className=e)}return this},removeClass:function(b){var c,d,e,f,h;c=0===arguments.length||"string"==typeof b&&b;var g=0,l=this.length;if(k.isFunction(b))return this.each(function(c){k(this).removeClass(b.call(this,
c,this.className))});if(c)for(c=(b||"").match(ja)||[];l>g;g++)if(d=this[g],e=1===d.nodeType&&(d.className?(" "+d.className+" ").replace(Pa," "):"")){for(h=0;f=c[h++];)for(;0<=e.indexOf(" "+f+" ");)e=e.replace(" "+f+" "," ");e=b?k.trim(e):"";d.className!==e&&(d.className=e)}return this},toggleClass:function(b,c){var d=typeof b;return"boolean"==typeof c&&"string"===d?c?this.addClass(b):this.removeClass(b):this.each(k.isFunction(b)?function(d){k(this).toggleClass(b.call(this,d,this.className,c),c)}:
function(){if("string"===d)for(var c,e=0,f=k(this),h=b.match(ja)||[];c=h[e++];)f.hasClass(c)?f.removeClass(c):f.addClass(c);else("undefined"===d||"boolean"===d)&&(this.className&&J.set(this,"__className__",this.className),this.className=this.className||!1===b?"":J.get(this,"__className__")||"")})},hasClass:function(b){b=" "+b+" ";for(var c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&0<=(" "+this[c].className+" ").replace(Pa," ").indexOf(b))return!0;return!1}});var Fb=/\r/g;k.fn.extend({val:function(b){var c,
d,e,f=this[0];if(arguments.length)return e=k.isFunction(b),this.each(function(d){var f;1===this.nodeType&&(f=e?b.call(this,d,k(this).val()):b,null==f?f="":"number"==typeof f?f+="":k.isArray(f)&&(f=k.map(f,function(b){return null==b?"":b+""})),c=k.valHooks[this.type]||k.valHooks[this.nodeName.toLowerCase()],c&&"set"in c&&void 0!==c.set(this,f,"value")||(this.value=f))});if(f)return c=k.valHooks[f.type]||k.valHooks[f.nodeName.toLowerCase()],c&&"get"in c&&void 0!==(d=c.get(f,"value"))?d:(d=f.value,"string"==
typeof d?d.replace(Fb,""):null==d?"":d)}});k.extend({valHooks:{option:{get:function(b){var c=k.find.attr(b,"value");return null!=c?c:k.trim(k.text(b))}},select:{get:function(b){for(var c,d=b.options,e=b.selectedIndex,f="select-one"===b.type||0>e,h=f?null:[],g=f?e+1:d.length,l=0>e?g:f?e:0;g>l;l++)if(c=d[l],!(!c.selected&&l!==e||(X.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&k.nodeName(c.parentNode,"optgroup"))){if(b=k(c).val(),f)return b;h.push(b)}return h},set:function(b,
c){for(var d,e,f=b.options,h=k.makeArray(c),g=f.length;g--;)e=f[g],(e.selected=0<=k.inArray(e.value,h))&&(d=!0);return d||(b.selectedIndex=-1),h}}}});k.each(["radio","checkbox"],function(){k.valHooks[this]={set:function(b,c){return k.isArray(c)?b.checked=0<=k.inArray(k(b).val(),c):void 0}};X.checkOn||(k.valHooks[this].get=function(b){return null===b.getAttribute("value")?"on":b.value})});k.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),
function(b,c){k.fn[c]=function(b,d){return 0<arguments.length?this.on(c,null,b,d):this.trigger(c)}});k.fn.extend({hover:function(b,c){return this.mouseenter(b).mouseleave(c||b)},bind:function(b,c,d){return this.on(b,null,c,d)},unbind:function(b,c){return this.off(b,null,c)},delegate:function(b,c,d,e){return this.on(c,b,d,e)},undelegate:function(b,c,d){return 1===arguments.length?this.off(b,"**"):this.off(c,b||"**",d)}});var Qa=k.now(),Ra=/\?/;k.parseJSON=function(b){return JSON.parse(b+"")};k.parseXML=
function(b){var c,d;if(!b||"string"!=typeof b)return null;try{d=new DOMParser,c=d.parseFromString(b,"text/xml")}catch(e){c=void 0}return(!c||c.getElementsByTagName("parsererror").length)&&k.error("Invalid XML: "+b),c};var Gb=/#.*$/,fb=/([?&])_=[^&]*/,Hb=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ib=/^(?:GET|HEAD)$/,Jb=/^\/\//,gb=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,hb={},La={},ib="*/".concat("*"),Sa=b.location.href,sa=gb.exec(Sa.toLowerCase())||[];k.extend({active:0,lastModified:{},etag:{},
ajaxSettings:{url:Sa,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(sa[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ib,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":k.parseJSON,
"text xml":k.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(b,c){return c?P(P(b,k.ajaxSettings),c):P(k.ajaxSettings,b)},ajaxPrefilter:ba(hb),ajaxTransport:ba(La),ajax:function(b,c){function d(b,c,g,m){var q,s,Z,z,da=c;if(2!==u){u=2;l&&clearTimeout(l);e=void 0;h=m||"";E.readyState=0<b?4:0;m=200<=b&&300>b||304===b;if(g){Z=p;for(var D=E,w,M,x,K,fa=Z.contents,ba=Z.dataTypes;"*"===ba[0];)ba.shift(),void 0===w&&(w=Z.mimeType||D.getResponseHeader("Content-Type"));if(w)for(M in fa)if(fa[M]&&
fa[M].test(w)){ba.unshift(M);break}if(ba[0]in g)x=ba[0];else{for(M in g){if(!ba[0]||Z.converters[M+" "+ba[0]]){x=M;break}K||(K=M)}x=x||K}Z=x?(x!==ba[0]&&ba.unshift(x),g[x]):void 0}var ha;a:{g=p;w=Z;M=E;x=m;var aa,A,S;Z={};D=g.dataTypes.slice();if(D[1])for(aa in g.converters)Z[aa.toLowerCase()]=g.converters[aa];for(K=D.shift();K;)if(g.responseFields[K]&&(M[g.responseFields[K]]=w),!S&&x&&g.dataFilter&&(w=g.dataFilter(w,g.dataType)),S=K,K=D.shift())if("*"===K)K=S;else if("*"!==S&&S!==K){if(aa=Z[S+" "+
K]||Z["* "+K],!aa)for(ha in Z)if(A=ha.split(" "),A[1]===K&&(aa=Z[S+" "+A[0]]||Z["* "+A[0]])){!0===aa?aa=Z[ha]:!0!==Z[ha]&&(K=A[0],D.unshift(A[1]));break}if(!0!==aa)if(aa&&g["throws"])w=aa(w);else try{w=aa(w)}catch(C){ha={state:"parsererror",error:aa?C:"No conversion from "+S+" to "+K};break a}}ha={state:"success",data:w}}Z=ha;m?(p.ifModified&&(z=E.getResponseHeader("Last-Modified"),z&&(k.lastModified[f]=z),z=E.getResponseHeader("etag"),z&&(k.etag[f]=z)),204===b||"HEAD"===p.type?da="nocontent":304===
b?da="notmodified":(da=Z.state,q=Z.data,s=Z.error,m=!s)):(s=da,(b||!da)&&(da="error",0>b&&(b=0)));E.status=b;E.statusText=(c||da)+"";m?v.resolveWith(n,[q,da,E]):v.rejectWith(n,[E,da,s]);E.statusCode(t);t=void 0;r&&B.trigger(m?"ajaxSuccess":"ajaxError",[E,p,m?q:s]);O.fireWith(n,[E,da]);r&&(B.trigger("ajaxComplete",[E,p]),--k.active||k.event.trigger("ajaxStop"))}}"object"==typeof b&&(c=b,b=void 0);c=c||{};var e,f,h,g,l,m,r,q,p=k.ajaxSetup({},c),n=p.context||p,B=p.context&&(n.nodeType||n.jquery)?k(n):
k.event,v=k.Deferred(),O=k.Callbacks("once memory"),t=p.statusCode||{},s={},Z={},u=0,z="canceled",E={readyState:0,getResponseHeader:function(b){var c;if(2===u){if(!g)for(g={};c=Hb.exec(h);)g[c[1].toLowerCase()]=c[2];c=g[b.toLowerCase()]}return null==c?null:c},getAllResponseHeaders:function(){return 2===u?h:null},setRequestHeader:function(b,c){var d=b.toLowerCase();return u||(b=Z[d]=Z[d]||b,s[b]=c),this},overrideMimeType:function(b){return u||(p.mimeType=b),this},statusCode:function(b){var c;if(b)if(2>
u)for(c in b)t[c]=[t[c],b[c]];else E.always(b[E.status]);return this},abort:function(b){b=b||z;return e&&e.abort(b),d(0,b),this}};if(v.promise(E).complete=O.add,E.success=E.done,E.error=E.fail,p.url=((b||p.url||Sa)+"").replace(Gb,"").replace(Jb,sa[1]+"//"),p.type=c.method||c.type||p.method||p.type,p.dataTypes=k.trim(p.dataType||"*").toLowerCase().match(ja)||[""],null==p.crossDomain&&(m=gb.exec(p.url.toLowerCase()),p.crossDomain=!(!m||m[1]===sa[1]&&m[2]===sa[2]&&(m[3]||("http:"===m[1]?"80":"443"))===
(sa[3]||("http:"===sa[1]?"80":"443")))),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=k.param(p.data,p.traditional)),S(hb,p,c,E),2===u)return E;(r=k.event&&p.global)&&0===k.active++&&k.event.trigger("ajaxStart");p.type=p.type.toUpperCase();p.hasContent=!Ib.test(p.type);f=p.url;p.hasContent||(p.data&&(f=p.url+=(Ra.test(f)?"&":"?")+p.data,delete p.data),!1===p.cache&&(p.url=fb.test(f)?f.replace(fb,"$1_="+Qa++):f+(Ra.test(f)?"&":"?")+"_="+Qa++));p.ifModified&&(k.lastModified[f]&&E.setRequestHeader("If-Modified-Since",
k.lastModified[f]),k.etag[f]&&E.setRequestHeader("If-None-Match",k.etag[f]));(p.data&&p.hasContent&&!1!==p.contentType||c.contentType)&&E.setRequestHeader("Content-Type",p.contentType);E.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+ib+"; q=0.01":""):p.accepts["*"]);for(q in p.headers)E.setRequestHeader(q,p.headers[q]);if(p.beforeSend&&(!1===p.beforeSend.call(n,E,p)||2===u))return E.abort();z="abort";for(q in{success:1,error:1,
complete:1})E[q](p[q]);if(e=S(La,p,c,E)){E.readyState=1;r&&B.trigger("ajaxSend",[E,p]);p.async&&0<p.timeout&&(l=setTimeout(function(){E.abort("timeout")},p.timeout));try{u=1,e.send(s,d)}catch(da){if(!(2>u))throw da;d(-1,da)}}else d(-1,"No Transport");return E},getJSON:function(b,c,d){return k.get(b,c,d,"json")},getScript:function(b,c){return k.get(b,void 0,c,"script")}});k.each(["get","post"],function(b,c){k[c]=function(b,d,e,f){return k.isFunction(d)&&(f=f||e,e=d,d=void 0),k.ajax({url:b,type:c,dataType:f,
data:d,success:e})}});k._evalUrl=function(b){return k.ajax({url:b,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})};k.fn.extend({wrapAll:function(b){var c;return k.isFunction(b)?this.each(function(c){k(this).wrapAll(b.call(this,c))}):(this[0]&&(c=k(b,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&c.insertBefore(this[0]),c.map(function(){for(var b=this;b.firstElementChild;)b=b.firstElementChild;return b}).append(this)),this)},wrapInner:function(b){return this.each(k.isFunction(b)?
function(c){k(this).wrapInner(b.call(this,c))}:function(){var c=k(this),d=c.contents();d.length?d.wrapAll(b):c.append(b)})},wrap:function(b){var c=k.isFunction(b);return this.each(function(d){k(this).wrapAll(c?b.call(this,d):b)})},unwrap:function(){return this.parent().each(function(){k.nodeName(this,"body")||k(this).replaceWith(this.childNodes)}).end()}});k.expr.filters.hidden=function(b){return 0>=b.offsetWidth&&0>=b.offsetHeight};k.expr.filters.visible=function(b){return!k.expr.filters.hidden(b)};
var Kb=/%20/g,rb=/\[\]$/,jb=/\r?\n/g,Lb=/^(?:submit|button|image|reset|file)$/i,Mb=/^(?:input|select|textarea|keygen)/i;k.param=function(b,c){var d,e=[],f=function(b,c){c=k.isFunction(c)?c():null==c?"":c;e[e.length]=encodeURIComponent(b)+"="+encodeURIComponent(c)};if(void 0===c&&(c=k.ajaxSettings&&k.ajaxSettings.traditional),k.isArray(b)||b.jquery&&!k.isPlainObject(b))k.each(b,function(){f(this.name,this.value)});else for(d in b)L(d,b[d],c,f);return e.join("&").replace(Kb,"+")};k.fn.extend({serialize:function(){return k.param(this.serializeArray())},
serializeArray:function(){return this.map(function(){var b=k.prop(this,"elements");return b?k.makeArray(b):this}).filter(function(){var b=this.type;return this.name&&!k(this).is(":disabled")&&Mb.test(this.nodeName)&&!Lb.test(b)&&(this.checked||!Xa.test(b))}).map(function(b,c){var d=k(this).val();return null==d?null:k.isArray(d)?k.map(d,function(b){return{name:c.name,value:b.replace(jb,"\r\n")}}):{name:c.name,value:d.replace(jb,"\r\n")}}).get()}});k.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(b){}};
var Nb=0,Ja={},Ob={0:200,1223:204},Ca=k.ajaxSettings.xhr();b.attachEvent&&b.attachEvent("onunload",function(){for(var b in Ja)Ja[b]()});X.cors=!!Ca&&"withCredentials"in Ca;X.ajax=Ca=!!Ca;k.ajaxTransport(function(b){var c;return X.cors||Ca&&!b.crossDomain?{send:function(d,e){var f,k=b.xhr(),h=++Nb;if(k.open(b.type,b.url,b.async,b.username,b.password),b.xhrFields)for(f in b.xhrFields)k[f]=b.xhrFields[f];b.mimeType&&k.overrideMimeType&&k.overrideMimeType(b.mimeType);b.crossDomain||d["X-Requested-With"]||
(d["X-Requested-With"]="XMLHttpRequest");for(f in d)k.setRequestHeader(f,d[f]);c=function(b){return function(){c&&(delete Ja[h],c=k.onload=k.onerror=null,"abort"===b?k.abort():"error"===b?e(k.status,k.statusText):e(Ob[k.status]||k.status,k.statusText,"string"==typeof k.responseText?{text:k.responseText}:void 0,k.getAllResponseHeaders()))}};k.onload=c();k.onerror=c("error");c=Ja[h]=c("abort");try{k.send(b.hasContent&&b.data||null)}catch(g){if(c)throw g;}},abort:function(){c&&c()}}:void 0});k.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},
contents:{script:/(?:java|ecma)script/},converters:{"text script":function(b){return k.globalEval(b),b}}});k.ajaxPrefilter("script",function(b){void 0===b.cache&&(b.cache=!1);b.crossDomain&&(b.type="GET")});k.ajaxTransport("script",function(b){if(b.crossDomain){var c,d;return{send:function(e,f){c=k("<script>").prop({async:!0,charset:b.scriptCharset,src:b.url}).on("load error",d=function(b){c.remove();d=null;b&&f("error"===b.type?404:200,b.type)});I.head.appendChild(c[0])},abort:function(){d&&d()}}}});
var kb=[],Ta=/(=)\?(?=&|$)|\?\?/;k.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var b=kb.pop()||k.expando+"_"+Qa++;return this[b]=!0,b}});k.ajaxPrefilter("json jsonp",function(c,d,e){var f,h,g,l=!1!==c.jsonp&&(Ta.test(c.url)?"url":"string"==typeof c.data&&!(c.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ta.test(c.data)&&"data");return l||"jsonp"===c.dataTypes[0]?(f=c.jsonpCallback=k.isFunction(c.jsonpCallback)?c.jsonpCallback():c.jsonpCallback,l?c[l]=c[l].replace(Ta,"$1"+
f):!1!==c.jsonp&&(c.url+=(Ra.test(c.url)?"&":"?")+c.jsonp+"="+f),c.converters["script json"]=function(){return g||k.error(f+" was not called"),g[0]},c.dataTypes[0]="json",h=b[f],b[f]=function(){g=arguments},e.always(function(){b[f]=h;c[f]&&(c.jsonpCallback=d.jsonpCallback,kb.push(f));g&&k.isFunction(h)&&h(g[0]);g=h=void 0}),"script"):void 0});k.parseHTML=function(b,c,d){if(!b||"string"!=typeof b)return null;"boolean"==typeof c&&(d=c,c=!1);c=c||I;var e=Ga.exec(b);d=!d&&[];return e?[c.createElement(e[1])]:
(e=k.buildFragment([b],c,d),d&&d.length&&k(d).remove(),k.merge([],e.childNodes))};var lb=k.fn.load;k.fn.load=function(b,c,d){if("string"!=typeof b&&lb)return lb.apply(this,arguments);var e,f,h,g=this,l=b.indexOf(" ");return 0<=l&&(e=k.trim(b.slice(l)),b=b.slice(0,l)),k.isFunction(c)?(d=c,c=void 0):c&&"object"==typeof c&&(f="POST"),0<g.length&&k.ajax({url:b,type:f,dataType:"html",data:c}).done(function(b){h=arguments;g.html(e?k("<div>").append(k.parseHTML(b)).find(e):b)}).complete(d&&function(b,c){g.each(d,
h||[b.responseText,c,b])}),this};k.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(b,c){k.fn[c]=function(b){return this.on(c,b)}});k.expr.filters.animated=function(b){return k.grep(k.timers,function(c){return b===c.elem}).length};var mb=b.document.documentElement;k.offset={setOffset:function(b,c,d){var e,f,h,g,l,m,p=k.css(b,"position"),r=k(b),q={};"static"===p&&(b.style.position="relative");l=r.offset();h=k.css(b,"top");m=k.css(b,"left");("absolute"===p||
"fixed"===p)&&-1<(h+m).indexOf("auto")?(e=r.position(),g=e.top,f=e.left):(g=parseFloat(h)||0,f=parseFloat(m)||0);k.isFunction(c)&&(c=c.call(b,d,l));null!=c.top&&(q.top=c.top-l.top+g);null!=c.left&&(q.left=c.left-l.left+f);"using"in c?c.using.call(b,q):r.css(q)}};k.fn.extend({offset:function(b){if(arguments.length)return void 0===b?this:this.each(function(c){k.offset.setOffset(this,b,c)});var c,d,e=this[0],f={top:0,left:0},h=e&&e.ownerDocument;if(h)return c=h.documentElement,k.contains(c,e)?("undefined"!==
typeof e.getBoundingClientRect&&(f=e.getBoundingClientRect()),d=ga(h),{top:f.top+d.pageYOffset-c.clientTop,left:f.left+d.pageXOffset-c.clientLeft}):f},position:function(){if(this[0]){var b,c,d=this[0],e={top:0,left:0};return"fixed"===k.css(d,"position")?c=d.getBoundingClientRect():(b=this.offsetParent(),c=this.offset(),k.nodeName(b[0],"html")||(e=b.offset()),e.top+=k.css(b[0],"borderTopWidth",!0),e.left+=k.css(b[0],"borderLeftWidth",!0)),{top:c.top-e.top-k.css(d,"marginTop",!0),left:c.left-e.left-
k.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var b=this.offsetParent||mb;b&&!k.nodeName(b,"html")&&"static"===k.css(b,"position");)b=b.offsetParent;return b||mb})}});k.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(c,d){var e="pageYOffset"===d;k.fn[c]=function(f){return pa(this,function(c,f,k){var h=ga(c);return void 0===k?h?h[d]:c[f]:void(h?h.scrollTo(e?b.pageXOffset:k,e?k:b.pageYOffset):c[f]=k)},c,f,arguments.length,null)}});k.each(["top",
"left"],function(b,c){k.cssHooks[c]=W(X.pixelPosition,function(b,d){return d?(d=F(b,c),Ka.test(d)?k(b).position()[c]+"px":d):void 0})});k.each({Height:"height",Width:"width"},function(b,c){k.each({padding:"inner"+b,content:c,"":"outer"+b},function(d,e){k.fn[e]=function(e,f){var h=arguments.length&&(d||"boolean"!=typeof e),g=d||(!0===e||!0===f?"margin":"border");return pa(this,function(c,d,e){var f;return k.isWindow(c)?c.document.documentElement["client"+b]:9===c.nodeType?(f=c.documentElement,Math.max(c.body["scroll"+
b],f["scroll"+b],c.body["offset"+b],f["offset"+b],f["client"+b])):void 0===e?k.css(c,d,g):k.style(c,d,e,g)},c,h?e:void 0,h,null)}})});k.fn.size=function(){return this.length};k.fn.andSelf=k.fn.addBack;"function"==typeof define&&define.amd&&define("jquery",[],function(){return k});var Pb=b.jQuery,Qb=b.$;return k.noConflict=function(c){return b.$===k&&(b.$=Qb),c&&b.jQuery===k&&(b.jQuery=Pb),k},"undefined"===typeof d&&(b.jQuery=b.$=k),k});(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):"object"===typeof exports?b(require("jquery")):b(jQuery)})(function(b){var d=0,c=Array.prototype.slice;b.cleanData=function(c){return function(d){var g,h,l;for(l=0;null!=(h=d[l]);l++)try{(g=b._data(h,"events"))&&g.remove&&b(h).triggerHandler("remove")}catch(m){}c(d)}}(b.cleanData);b.widget=function(c,d,g){var h,l,m,q,r={},p=c.split(".")[0];c=c.split(".")[1];h=p+"-"+c;g||(g=d,d=b.Widget);b.expr[":"][h.toLowerCase()]=function(c){return!!b.data(c,
h)};b[p]=b[p]||{};l=b[p][c];m=b[p][c]=function(b,c){if(!this._createWidget)return new m(b,c);arguments.length&&this._createWidget(b,c)};b.extend(m,l,{version:g.version,_proto:b.extend({},g),_childConstructors:[]});q=new d;q.options=b.widget.extend({},q.options);b.each(g,function(c,f){b.isFunction(f)?r[c]=function(){var b=function(){return d.prototype[c].apply(this,arguments)},h=function(b){return d.prototype[c].apply(this,b)};return function(){var c=this._super,d=this._superApply,e;this._super=b;
this._superApply=h;e=f.apply(this,arguments);this._super=c;this._superApply=d;return e}}():r[c]=f});m.prototype=b.widget.extend(q,{widgetEventPrefix:l?q.widgetEventPrefix||c:c},r,{constructor:m,namespace:p,widgetName:c,widgetFullName:h});l?(b.each(l._childConstructors,function(c,d){var e=d.prototype;b.widget(e.namespace+"."+e.widgetName,m,d._proto)}),delete l._childConstructors):d._childConstructors.push(m);b.widget.bridge(c,m);return m};b.widget.extend=function(d){for(var e=c.call(arguments,1),g=
0,h=e.length,l,m;g<h;g++)for(l in e[g])m=e[g][l],e[g].hasOwnProperty(l)&&void 0!==m&&(b.isPlainObject(m)?d[l]=b.isPlainObject(d[l])?b.widget.extend({},d[l],m):b.widget.extend({},m):d[l]=m);return d};b.widget.bridge=function(d,e){var g=e.prototype.widgetFullName||d;b.fn[d]=function(h){var l="string"===typeof h,m=c.call(arguments,1),q=this;l?this.each(function(){var c,e=b.data(this,g);if("instance"===h)return q=e,!1;if(!e)return b.error("cannot call methods on "+d+" prior to initialization; attempted to call method '"+
h+"'");if(!b.isFunction(e[h])||"_"===h.charAt(0))return b.error("no such method '"+h+"' for "+d+" widget instance");c=e[h].apply(e,m);if(c!==e&&void 0!==c)return q=c&&c.jquery?q.pushStack(c.get()):c,!1}):(m.length&&(h=b.widget.extend.apply(null,[h].concat(m))),this.each(function(){var c=b.data(this,g);c?(c.option(h||{}),c._init&&c._init()):b.data(this,g,new e(h,this))}));return q}};b.Widget=function(){};b.Widget._childConstructors=[];b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",
options:{disabled:!1,create:null},_createWidget:function(c,e){e=b(e||this.defaultElement||this)[0];this.element=b(e);this.uuid=d++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=b();this.hoverable=b();this.focusable=b();e!==this&&(b.data(e,this.widgetFullName,this),this._on(!0,this.element,{remove:function(b){b.target===e&&this.destroy()}}),this.document=b(e.style?e.ownerDocument:e.document||e),this.window=b(this.document[0].defaultView||this.document[0].parentWindow));this.options=
b.widget.extend({},this.options,this._getCreateOptions(),c);this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:b.noop,_getCreateEventData:b.noop,_create:b.noop,_init:b.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(b.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");
this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:b.noop,widget:function(){return this.element},option:function(c,d){var g=c,h,l,m;if(0===arguments.length)return b.widget.extend({},this.options);if("string"===typeof c)if(g={},h=c.split("."),c=h.shift(),h.length){l=g[c]=b.widget.extend({},this.options[c]);for(m=0;m<h.length-1;m++)l[h[m]]=l[h[m]]||{},l=l[h[m]];c=h.pop();if(1===arguments.length)return void 0===
l[c]?null:l[c];l[c]=d}else{if(1===arguments.length)return void 0===this.options[c]?null:this.options[c];g[c]=d}this._setOptions(g);return this},_setOptions:function(b){for(var c in b)this._setOption(c,b[c]);return this},_setOption:function(b,c){this.options[b]=c;"disabled"===b&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!c),c&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")));return this},enable:function(){return this._setOptions({disabled:!1})},
disable:function(){return this._setOptions({disabled:!0})},_on:function(c,d,g){var h,l=this;"boolean"!==typeof c&&(g=d,d=c,c=!1);g?(d=h=b(d),this.bindings=this.bindings.add(d)):(g=d,d=this.element,h=this.widget());b.each(g,function(g,q){function r(){if(c||!0!==l.options.disabled&&!b(this).hasClass("ui-state-disabled"))return("string"===typeof q?l[q]:q).apply(l,arguments)}"string"!==typeof q&&(r.guid=q.guid=q.guid||r.guid||b.guid++);var p=g.match(/^([\w:-]*)\s*(.*)$/),t=p[1]+l.eventNamespace;(p=p[2])?
h.delegate(p,t,r):d.bind(t,r)})},_off:function(c,d){d=(d||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;c.unbind(d).undelegate(d);this.bindings=b(this.bindings.not(c).get());this.focusable=b(this.focusable.not(c).get());this.hoverable=b(this.hoverable.not(c).get())},_delay:function(b,c){var d=this;return setTimeout(function(){return("string"===typeof b?d[b]:b).apply(d,arguments)},c||0)},_hoverable:function(c){this.hoverable=this.hoverable.add(c);this._on(c,{mouseenter:function(c){b(c.currentTarget).addClass("ui-state-hover")},
mouseleave:function(c){b(c.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(c){this.focusable=this.focusable.add(c);this._on(c,{focusin:function(c){b(c.currentTarget).addClass("ui-state-focus")},focusout:function(c){b(c.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(c,d,g){var h,l=this.options[c];g=g||{};d=b.Event(d);d.type=(c===this.widgetEventPrefix?c:this.widgetEventPrefix+c).toLowerCase();d.target=this.element[0];if(c=d.originalEvent)for(h in c)h in d||
(d[h]=c[h]);this.element.trigger(d,g);return!(b.isFunction(l)&&!1===l.apply(this.element[0],[d].concat(g))||d.isDefaultPrevented())}};b.each({show:"fadeIn",hide:"fadeOut"},function(c,d){b.Widget.prototype["_"+c]=function(g,h,l){"string"===typeof h&&(h={effect:h});var m,q=h?!0===h||"number"===typeof h?d:h.effect||d:c;h=h||{};"number"===typeof h&&(h={duration:h});m=!b.isEmptyObject(h);h.complete=l;h.delay&&g.delay(h.delay);if(m&&b.effects&&b.effects.effect[q])g[c](h);else if(q!==c&&g[q])g[q](h.duration,
h.easing,l);else g.queue(function(d){b(this)[c]();l&&l.call(g[0]);d()})}})});(function(){function b(b){return function(c,d,e,f){d=H(d,f,4);var h=!G(c)&&n.keys(c),g=(h||c).length,l=0<b?0:g-1;3>arguments.length&&(e=c[h?h[l]:l],l+=b);for(var m=d,p=e;0<=l&&g>l;l+=b)var k=h?h[l]:l,p=m(p,c[k],k,c);return p}}function d(b){return function(c,d,e){d=y(d,e);e=Q(c);for(var f=0<b?0:e-1;0<=f&&e>f;f+=b)if(d(c[f],f,c))return f;return-1}}function c(b,c,d){return function(e,f,h){var g=0,l=Q(e);if("number"==typeof h)0<b?g=0<=h?h:Math.max(h+l,g):l=0<=h?Math.min(h+1,l):h+l+1;else if(d&&h&&l)return h=
d(e,f),e[h]===f?h:-1;if(f!==f)return h=c(q.call(e,g,l),n.isNaN),0<=h?h+g:-1;for(h=0<b?g:l-1;0<=h&&l>h;h+=b)if(e[h]===f)return h;return-1}}function f(b,c){var d=Y.length,e=b.constructor,e=n.isFunction(e)&&e.prototype||l,f="constructor";for(n.has(b,f)&&!n.contains(c,f)&&c.push(f);d--;)f=Y[d],f in b&&b[f]!==e[f]&&!n.contains(c,f)&&c.push(f)}var e=this,g=e._,h=Array.prototype,l=Object.prototype,m=h.push,q=h.slice,r=l.toString,p=l.hasOwnProperty,t=Array.isArray,s=Object.keys,u=Function.prototype.bind,
w=Object.create,A=function(){},n=function(b){return b instanceof n?b:this instanceof n?void(this._wrapped=b):new n(b)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=n),exports._=n):e._=n;n.VERSION="1.8.3";var H=function(b,c,d){if(void 0===c)return b;switch(null==d?3:d){case 1:return function(d){return b.call(c,d)};case 2:return function(d,e){return b.call(c,d,e)};case 3:return function(d,e,f){return b.call(c,d,e,f)};case 4:return function(d,e,f,h){return b.call(c,
d,e,f,h)}}return function(){return b.apply(c,arguments)}},y=function(b,c,d){return null==b?n.identity:n.isFunction(b)?H(b,c,d):n.isObject(b)?n.matcher(b):n.property(b)};n.iteratee=function(b,c){return y(b,c,1/0)};var F=function(b,c){return function(d){var e=arguments.length;if(2>e||null==d)return d;for(var f=1;e>f;f++)for(var h=arguments[f],g=b(h),l=g.length,m=0;l>m;m++){var p=g[m];c&&void 0!==d[p]||(d[p]=h[p])}return d}},W=function(b){if(!n.isObject(b))return{};if(w)return w(b);A.prototype=b;b=new A;
return A.prototype=null,b},ca=function(b){return function(c){return null==c?void 0:c[b]}},T=Math.pow(2,53)-1,Q=ca("length"),G=function(b){b=Q(b);return"number"==typeof b&&0<=b&&T>=b};n.each=n.forEach=function(b,c,d){c=H(c,d);var e;if(G(b))for(d=0,e=b.length;e>d;d++)c(b[d],d,b);else{var f=n.keys(b);d=0;for(e=f.length;e>d;d++)c(b[f[d]],f[d],b)}return b};n.map=n.collect=function(b,c,d){c=y(c,d);d=!G(b)&&n.keys(b);for(var e=(d||b).length,f=Array(e),h=0;e>h;h++){var g=d?d[h]:h;f[h]=c(b[g],g,b)}return f};
n.reduce=n.foldl=n.inject=b(1);n.reduceRight=n.foldr=b(-1);n.find=n.detect=function(b,c,d){var e;return e=G(b)?n.findIndex(b,c,d):n.findKey(b,c,d),void 0!==e&&-1!==e?b[e]:void 0};n.filter=n.select=function(b,c,d){var e=[];return c=y(c,d),n.each(b,function(b,d,f){c(b,d,f)&&e.push(b)}),e};n.reject=function(b,c,d){return n.filter(b,n.negate(y(c)),d)};n.every=n.all=function(b,c,d){c=y(c,d);d=!G(b)&&n.keys(b);for(var e=(d||b).length,f=0;e>f;f++){var h=d?d[f]:f;if(!c(b[h],h,b))return!1}return!0};n.some=
n.any=function(b,c,d){c=y(c,d);d=!G(b)&&n.keys(b);for(var e=(d||b).length,f=0;e>f;f++){var h=d?d[f]:f;if(c(b[h],h,b))return!0}return!1};n.contains=n.includes=n.include=function(b,c,d,e){return G(b)||(b=n.values(b)),("number"!=typeof d||e)&&(d=0),0<=n.indexOf(b,c,d)};n.invoke=function(b,c){var d=q.call(arguments,2),e=n.isFunction(c);return n.map(b,function(b){var f=e?c:b[c];return null==f?f:f.apply(b,d)})};n.pluck=function(b,c){return n.map(b,n.property(c))};n.where=function(b,c){return n.filter(b,
n.matcher(c))};n.findWhere=function(b,c){return n.find(b,n.matcher(c))};n.max=function(b,c,d){var e,f=-1/0,h=-1/0;if(null==c&&null!=b){b=G(b)?b:n.values(b);for(var g=0,l=b.length;l>g;g++)d=b[g],d>f&&(f=d)}else c=y(c,d),n.each(b,function(b,d,k){e=c(b,d,k);(e>h||e===-1/0&&f===-1/0)&&(f=b,h=e)});return f};n.min=function(b,c,d){var e,f=1/0,h=1/0;if(null==c&&null!=b){b=G(b)?b:n.values(b);for(var g=0,l=b.length;l>g;g++)d=b[g],f>d&&(f=d)}else c=y(c,d),n.each(b,function(b,d,k){e=c(b,d,k);(h>e||1/0===e&&1/
0===f)&&(f=b,h=e)});return f};n.shuffle=function(b){for(var c=G(b)?b:n.values(b),d=c.length,e=Array(d),f=0;d>f;f++)b=n.random(0,f),b!==f&&(e[f]=e[b]),e[b]=c[f];return e};n.sample=function(b,c,d){return null==c||d?(G(b)||(b=n.values(b)),b[n.random(b.length-1)]):n.shuffle(b).slice(0,Math.max(0,c))};n.sortBy=function(b,c,d){return c=y(c,d),n.pluck(n.map(b,function(b,d,e){return{value:b,index:d,criteria:c(b,d,e)}}).sort(function(b,c){var d=b.criteria,e=c.criteria;if(d!==e){if(d>e||void 0===d)return 1;
if(e>d||void 0===e)return-1}return b.index-c.index}),"value")};var V=function(b){return function(c,d,e){var f={};return d=y(d,e),n.each(c,function(e,h){var g=d(e,h,c);b(f,e,g)}),f}};n.groupBy=V(function(b,c,d){n.has(b,d)?b[d].push(c):b[d]=[c]});n.indexBy=V(function(b,c,d){b[d]=c});n.countBy=V(function(b,c,d){n.has(b,d)?b[d]++:b[d]=1});n.toArray=function(b){return b?n.isArray(b)?q.call(b):G(b)?n.map(b,n.identity):n.values(b):[]};n.size=function(b){return null==b?0:G(b)?b.length:n.keys(b).length};n.partition=
function(b,c,d){c=y(c,d);var e=[],f=[];return n.each(b,function(b,d,h){(c(b,d,h)?e:f).push(b)}),[e,f]};n.first=n.head=n.take=function(b,c,d){return null==b?void 0:null==c||d?b[0]:n.initial(b,b.length-c)};n.initial=function(b,c,d){return q.call(b,0,Math.max(0,b.length-(null==c||d?1:c)))};n.last=function(b,c,d){return null==b?void 0:null==c||d?b[b.length-1]:n.rest(b,Math.max(0,b.length-c))};n.rest=n.tail=n.drop=function(b,c,d){return q.call(b,null==c||d?1:c)};n.compact=function(b){return n.filter(b,
n.identity)};var C=function(b,c,d,e){var f=[],h=0;e=e||0;for(var g=Q(b);g>e;e++){var l=b[e];if(G(l)&&(n.isArray(l)||n.isArguments(l))){c||(l=C(l,c,d));var m=0,p=l.length;for(f.length+=p;p>m;)f[h++]=l[m++]}else d||(f[h++]=l)}return f};n.flatten=function(b,c){return C(b,c,!1)};n.without=function(b){return n.difference(b,q.call(arguments,1))};n.uniq=n.unique=function(b,c,d,e){n.isBoolean(c)||(e=d,d=c,c=!1);null!=d&&(d=y(d,e));e=[];for(var f=[],h=0,g=Q(b);g>h;h++){var l=b[h],m=d?d(l,h,b):l;c?(h&&f===
m||e.push(l),f=m):d?n.contains(f,m)||(f.push(m),e.push(l)):n.contains(e,l)||e.push(l)}return e};n.union=function(){return n.uniq(C(arguments,!0,!0))};n.intersection=function(b){for(var c=[],d=arguments.length,e=0,f=Q(b);f>e;e++){var h=b[e];if(!n.contains(c,h)){for(var g=1;d>g&&n.contains(arguments[g],h);g++);g===d&&c.push(h)}}return c};n.difference=function(b){var c=C(arguments,!0,!0,1);return n.filter(b,function(b){return!n.contains(c,b)})};n.zip=function(){return n.unzip(arguments)};n.unzip=function(b){for(var c=
b&&n.max(b,Q).length||0,d=Array(c),e=0;c>e;e++)d[e]=n.pluck(b,e);return d};n.object=function(b,c){for(var d={},e=0,f=Q(b);f>e;e++)c?d[b[e]]=c[e]:d[b[e][0]]=b[e][1];return d};n.findIndex=d(1);n.findLastIndex=d(-1);n.sortedIndex=function(b,c,d,e){d=y(d,e,1);c=d(c);e=0;for(var f=Q(b);f>e;){var h=Math.floor((e+f)/2);d(b[h])<c?e=h+1:f=h}return e};n.indexOf=c(1,n.findIndex,n.sortedIndex);n.lastIndexOf=c(-1,n.findLastIndex);n.range=function(b,c,d){null==c&&(c=b||0,b=0);d=d||1;c=Math.max(Math.ceil((c-b)/
d),0);for(var e=Array(c),f=0;c>f;f++,b+=d)e[f]=b;return e};var R=function(b,c,d,e,f){if(!(e instanceof c))return b.apply(d,f);c=W(b.prototype);b=b.apply(c,f);return n.isObject(b)?b:c};n.bind=function(b,c){if(u&&b.bind===u)return u.apply(b,q.call(arguments,1));if(!n.isFunction(b))throw new TypeError("Bind must be called on a function");var d=q.call(arguments,2),e=function(){return R(b,e,c,this,d.concat(q.call(arguments)))};return e};n.partial=function(b){var c=q.call(arguments,1),d=function(){for(var e=
0,f=c.length,h=Array(f),g=0;f>g;g++)h[g]=c[g]===n?arguments[e++]:c[g];for(;e<arguments.length;)h.push(arguments[e++]);return R(b,d,this,this,h)};return d};n.bindAll=function(b){var c,d,e=arguments.length;if(1>=e)throw Error("bindAll must be passed function names");for(c=1;e>c;c++)d=arguments[c],b[d]=n.bind(b[d],b);return b};n.memoize=function(b,c){var d=function(e){var f=d.cache,h=""+(c?c.apply(this,arguments):e);return n.has(f,h)||(f[h]=b.apply(this,arguments)),f[h]};return d.cache={},d};n.delay=
function(b,c){var d=q.call(arguments,2);return setTimeout(function(){return b.apply(null,d)},c)};n.defer=n.partial(n.delay,n,1);n.throttle=function(b,c,d){var e,f,h,g=null,l=0;d||(d={});var m=function(){l=!1===d.leading?0:n.now();g=null;h=b.apply(e,f);g||(e=f=null)};return function(){var p=n.now();l||!1!==d.leading||(l=p);var k=c-(p-l);return e=this,f=arguments,0>=k||k>c?(g&&(clearTimeout(g),g=null),l=p,h=b.apply(e,f),g||(e=f=null)):g||!1===d.trailing||(g=setTimeout(m,k)),h}};n.debounce=function(b,
c,d){var e,f,h,g,l,m=function(){var p=n.now()-g;c>p&&0<=p?e=setTimeout(m,c-p):(e=null,d||(l=b.apply(h,f),e||(h=f=null)))};return function(){h=this;f=arguments;g=n.now();var p=d&&!e;return e||(e=setTimeout(m,c)),p&&(l=b.apply(h,f),h=f=null),l}};n.wrap=function(b,c){return n.partial(c,b)};n.negate=function(b){return function(){return!b.apply(this,arguments)}};n.compose=function(){var b=arguments,c=b.length-1;return function(){for(var d=c,e=b[c].apply(this,arguments);d--;)e=b[d].call(this,e);return e}};
n.after=function(b,c){return function(){return 1>--b?c.apply(this,arguments):void 0}};n.before=function(b,c){var d;return function(){return 0<--b&&(d=c.apply(this,arguments)),1>=b&&(c=null),d}};n.once=n.partial(n.before,2);var U=!{toString:null}.propertyIsEnumerable("toString"),Y="valueOf isPrototypeOf toString propertyIsEnumerable hasOwnProperty toLocaleString".split(" ");n.keys=function(b){if(!n.isObject(b))return[];if(s)return s(b);var c=[],d;for(d in b)n.has(b,d)&&c.push(d);return U&&f(b,c),c};
n.allKeys=function(b){if(!n.isObject(b))return[];var c=[],d;for(d in b)c.push(d);return U&&f(b,c),c};n.values=function(b){for(var c=n.keys(b),d=c.length,e=Array(d),f=0;d>f;f++)e[f]=b[c[f]];return e};n.mapObject=function(b,c,d){c=y(c,d);for(var e=n.keys(b),f=e.length,h={},g=0;f>g;g++)d=e[g],h[d]=c(b[d],d,b);return h};n.pairs=function(b){for(var c=n.keys(b),d=c.length,e=Array(d),f=0;d>f;f++)e[f]=[c[f],b[c[f]]];return e};n.invert=function(b){for(var c={},d=n.keys(b),e=0,f=d.length;f>e;e++)c[b[d[e]]]=
d[e];return c};n.functions=n.methods=function(b){var c=[],d;for(d in b)n.isFunction(b[d])&&c.push(d);return c.sort()};n.extend=F(n.allKeys);n.extendOwn=n.assign=F(n.keys);n.findKey=function(b,c,d){c=y(c,d);var e;d=n.keys(b);for(var f=0,h=d.length;h>f;f++)if(e=d[f],c(b[e],e,b))return e};n.pick=function(b,c,d){var e,f,h={},g=b;if(null==g)return h;n.isFunction(c)?(f=n.allKeys(g),e=H(c,d)):(f=C(arguments,!1,!1,1),e=function(b,c,d){return c in d},g=Object(g));for(var l=0,m=f.length;m>l;l++){var p=f[l],
k=g[p];e(k,p,g)&&(h[p]=k)}return h};n.omit=function(b,c,d){if(n.isFunction(c))c=n.negate(c);else{var e=n.map(C(arguments,!1,!1,1),String);c=function(b,c){return!n.contains(e,c)}}return n.pick(b,c,d)};n.defaults=F(n.allKeys,!0);n.create=function(b,c){var d=W(b);return c&&n.extendOwn(d,c),d};n.clone=function(b){return n.isObject(b)?n.isArray(b)?b.slice():n.extend({},b):b};n.tap=function(b,c){return c(b),b};n.isMatch=function(b,c){var d=n.keys(c),e=d.length;if(null==b)return!e;for(var f=Object(b),h=
0;e>h;h++){var g=d[h];if(c[g]!==f[g]||!(g in f))return!1}return!0};var O=function(b,c,d,e){if(b===c)return 0!==b||1/b===1/c;if(null==b||null==c)return b===c;b instanceof n&&(b=b._wrapped);c instanceof n&&(c=c._wrapped);var f=r.call(b);if(f!==r.call(c))return!1;switch(f){case "[object RegExp]":case "[object String]":return""+b==""+c;case "[object Number]":return+b!==+b?+c!==+c:0===+b?1/+b===1/c:+b===+c;case "[object Date]":case "[object Boolean]":return+b===+c}f="[object Array]"===f;if(!f){if("object"!=
typeof b||"object"!=typeof c)return!1;var h=b.constructor,g=c.constructor;if(h!==g&&!(n.isFunction(h)&&h instanceof h&&n.isFunction(g)&&g instanceof g)&&"constructor"in b&&"constructor"in c)return!1}d=d||[];e=e||[];for(h=d.length;h--;)if(d[h]===b)return e[h]===c;if(d.push(b),e.push(c),f){if(h=b.length,h!==c.length)return!1;for(;h--;)if(!O(b[h],c[h],d,e))return!1}else{var l,f=n.keys(b);if(h=f.length,n.keys(c).length!==h)return!1;for(;h--;)if(l=f[h],!n.has(c,l)||!O(b[l],c[l],d,e))return!1}return d.pop(),
e.pop(),!0};n.isEqual=function(b,c){return O(b,c)};n.isEmpty=function(b){return null==b?!0:G(b)&&(n.isArray(b)||n.isString(b)||n.isArguments(b))?0===b.length:0===n.keys(b).length};n.isElement=function(b){return!(!b||1!==b.nodeType)};n.isArray=t||function(b){return"[object Array]"===r.call(b)};n.isObject=function(b){var c=typeof b;return"function"===c||"object"===c&&!!b};n.each("Arguments Function String Number Date RegExp Error".split(" "),function(b){n["is"+b]=function(c){return r.call(c)==="[object "+
b+"]"}});n.isArguments(arguments)||(n.isArguments=function(b){return n.has(b,"callee")});"function"!=typeof/./&&"object"!=typeof Int8Array&&(n.isFunction=function(b){return"function"==typeof b||!1});n.isFinite=function(b){return isFinite(b)&&!isNaN(parseFloat(b))};n.isNaN=function(b){return n.isNumber(b)&&b!==+b};n.isBoolean=function(b){return!0===b||!1===b||"[object Boolean]"===r.call(b)};n.isNull=function(b){return null===b};n.isUndefined=function(b){return void 0===b};n.has=function(b,c){return null!=
b&&p.call(b,c)};n.noConflict=function(){return e._=g,this};n.identity=function(b){return b};n.constant=function(b){return function(){return b}};n.noop=function(){};n.property=ca;n.propertyOf=function(b){return null==b?function(){}:function(c){return b[c]}};n.matcher=n.matches=function(b){return b=n.extendOwn({},b),function(c){return n.isMatch(c,b)}};n.times=function(b,c,d){var e=Array(Math.max(0,b));c=H(c,d,1);for(d=0;b>d;d++)e[d]=c(d);return e};n.random=function(b,c){return null==c&&(c=b,b=0),b+
Math.floor(Math.random()*(c-b+1))};n.now=Date.now||function(){return(new Date).getTime()};t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};F=n.invert(t);ca=function(b){var c=function(c){return b[c]},d="(?:"+n.keys(b).join("|")+")",e=RegExp(d),f=RegExp(d,"g");return function(b){return b=null==b?"":""+b,e.test(b)?b.replace(f,c):b}};n.escape=ca(t);n.unescape=ca(F);n.result=function(b,c,d){c=null==b?void 0:b[c];return void 0===c&&(c=d),n.isFunction(c)?c.call(b):c};var E=0;
n.uniqueId=function(b){var c=++E+"";return b?b+c:c};n.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var ba=/(.)^/,S={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},P=/\\|'|\r|\n|\u2028|\u2029/g,L=function(b){return"\\"+S[b]};n.template=function(b,c,d){!c&&d&&(c=d);c=n.defaults({},c,n.templateSettings);d=RegExp([(c.escape||ba).source,(c.interpolate||ba).source,(c.evaluate||ba).source].join("|")+"|$","g");var e=0,f="__p+='";
b.replace(d,function(c,d,h,k,g){return f+=b.slice(e,g).replace(P,L),e=g+c.length,d?f+="'+\n((__t=("+d+"))==null?'':_.escape(__t))+\n'":h?f+="'+\n((__t=("+h+"))==null?'':__t)+\n'":k&&(f+="';\n"+k+"\n__p+='"),c});f+="';\n";c.variable||(f="with(obj||{}){\n"+f+"}\n");f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";try{var h=new Function(c.variable||"obj","_",f)}catch(g){throw g.source=f,g;}d=function(b){return h.call(this,b,n)};return d.source=
"function("+(c.variable||"obj")+"){\n"+f+"}",d};n.chain=function(b){b=n(b);return b._chain=!0,b};var ga=function(b,c){return b._chain?n(c).chain():c};n.mixin=function(b){n.each(n.functions(b),function(c){var d=n[c]=b[c];n.prototype[c]=function(){var b=[this._wrapped];return m.apply(b,arguments),ga(this,d.apply(n,b))}})};n.mixin(n);n.each("pop push reverse shift sort splice unshift".split(" "),function(b){var c=h[b];n.prototype[b]=function(){var d=this._wrapped;return c.apply(d,arguments),"shift"!==
b&&"splice"!==b||0!==d.length||delete d[0],ga(this,d)}});n.each(["concat","join","slice"],function(b){var c=h[b];n.prototype[b]=function(){return ga(this,c.apply(this._wrapped,arguments))}});n.prototype.value=function(){return this._wrapped};n.prototype.valueOf=n.prototype.toJSON=n.prototype.value;n.prototype.toString=function(){return""+this._wrapped};"function"==typeof define&&define.amd&&define("underscore",[],function(){return n})}).call(this);(function(b,d){if("function"===typeof define&&define.amd)define(["underscore","jquery","exports"],function(c,e,g){b.Backbone=d(b,g,c,e)});else if("undefined"!==typeof exports){var c=require("underscore");d(b,exports,c)}else b.Backbone=d(b,{},b._,b.jQuery||b.Zepto||b.ender||b.$)})(this,function(b,d,c,f){var e=b.Backbone,g=[].slice;d.VERSION="1.1.2";d.$=f;d.noConflict=function(){b.Backbone=e;return this};d.emulateHTTP=!1;d.emulateJSON=!1;var h=d.Events={on:function(b,c,d){if(!m(this,"on",b,[c,d])||
!c)return this;this._events||(this._events={});(this._events[b]||(this._events[b]=[])).push({callback:c,context:d,ctx:d||this});return this},once:function(b,d,e){if(!m(this,"once",b,[d,e])||!d)return this;var f=this,h=c.once(function(){f.off(b,h);d.apply(this,arguments)});h._callback=d;return this.on(b,h,e)},off:function(b,d,e){var f,h,g,l,p,r,q,n;if(!this._events||!m(this,"off",b,[d,e]))return this;if(!b&&!d&&!e)return this._events=void 0,this;l=b?[b]:c.keys(this._events);p=0;for(r=l.length;p<r;p++)if(b=
l[p],g=this._events[b]){this._events[b]=f=[];if(d||e)for(q=0,n=g.length;q<n;q++)h=g[q],(d&&d!==h.callback&&d!==h.callback._callback||e&&e!==h.context)&&f.push(h);f.length||delete this._events[b]}return this},trigger:function(b){if(!this._events)return this;var c=g.call(arguments,1);if(!m(this,"trigger",b,c))return this;var d=this._events[b],e=this._events.all;d&&q(d,c);e&&q(e,arguments);return this},stopListening:function(b,d,e){var f=this._listeningTo;if(!f)return this;var h=!d&&!e;e||"object"!==
typeof d||(e=this);b&&((f={})[b._listenId]=b);for(var g in f)b=f[g],b.off(d,e,this),(h||c.isEmpty(b._events))&&delete this._listeningTo[g];return this}},l=/\s+/,m=function(b,c,d,e){if(!d)return!0;if("object"===typeof d){for(var f in d)b[c].apply(b,[f,d[f]].concat(e));return!1}if(l.test(d)){d=d.split(l);f=0;for(var h=d.length;f<h;f++)b[c].apply(b,[d[f]].concat(e));return!1}return!0},q=function(b,c){var d,e=-1,f=b.length,h=c[0],g=c[1],l=c[2];switch(c.length){case 0:for(;++e<f;)(d=b[e]).callback.call(d.ctx);
break;case 1:for(;++e<f;)(d=b[e]).callback.call(d.ctx,h);break;case 2:for(;++e<f;)(d=b[e]).callback.call(d.ctx,h,g);break;case 3:for(;++e<f;)(d=b[e]).callback.call(d.ctx,h,g,l);break;default:for(;++e<f;)(d=b[e]).callback.apply(d.ctx,c)}};c.each({listenTo:"on",listenToOnce:"once"},function(b,d){h[d]=function(d,e,f){var h=this._listeningTo||(this._listeningTo={}),g=d._listenId||(d._listenId=c.uniqueId("l"));h[g]=d;f||"object"!==typeof e||(f=this);d[b](e,f,this);return this}});h.bind=h.on;h.unbind=h.off;
c.extend(d,h);var r=d.Model=function(b,d){var e=b||{};d||(d={});this.cid=c.uniqueId("c");this.attributes={};d.collection&&(this.collection=d.collection);d.parse&&(e=this.parse(e,d)||{});e=c.defaults({},e,c.result(this,"defaults"));this.set(e,d);this.changed={};this.initialize.apply(this,arguments)};c.extend(r.prototype,h,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(b){return c.clone(this.attributes)},sync:function(){return d.sync.apply(this,arguments)},
get:function(b){return this.attributes[b]},escape:function(b){return c.escape(this.get(b))},has:function(b){return null!=this.get(b)},set:function(b,d,e){var f,h,g,l,m,p,r;if(null==b)return this;"object"===typeof b?(h=b,e=d):(h={})[b]=d;e||(e={});if(!this._validate(h,e))return!1;g=e.unset;l=e.silent;b=[];m=this._changing;this._changing=!0;m||(this._previousAttributes=c.clone(this.attributes),this.changed={});r=this.attributes;p=this._previousAttributes;this.idAttribute in h&&(this.id=h[this.idAttribute]);
for(f in h)d=h[f],c.isEqual(r[f],d)||b.push(f),c.isEqual(p[f],d)?delete this.changed[f]:this.changed[f]=d,g?delete r[f]:r[f]=d;if(!l)for(b.length&&(this._pending=e),d=0,f=b.length;d<f;d++)this.trigger("change:"+b[d],this,r[b[d]],e);if(m)return this;if(!l)for(;this._pending;)e=this._pending,this._pending=!1,this.trigger("change",this,e);this._changing=this._pending=!1;return this},unset:function(b,d){return this.set(b,void 0,c.extend({},d,{unset:!0}))},clear:function(b){var d={},e;for(e in this.attributes)d[e]=
void 0;return this.set(d,c.extend({},b,{unset:!0}))},hasChanged:function(b){return null==b?!c.isEmpty(this.changed):c.has(this.changed,b)},changedAttributes:function(b){if(!b)return this.hasChanged()?c.clone(this.changed):!1;var d,e=!1,f=this._changing?this._previousAttributes:this.attributes,h;for(h in b)c.isEqual(f[h],d=b[h])||((e||(e={}))[h]=d);return e},previous:function(b){return null!=b&&this._previousAttributes?this._previousAttributes[b]:null},previousAttributes:function(){return c.clone(this._previousAttributes)},
fetch:function(b){b=b?c.clone(b):{};void 0===b.parse&&(b.parse=!0);var d=this,e=b.success;b.success=function(c){if(!d.set(d.parse(c,b),b))return!1;e&&e(d,c,b);d.trigger("sync",d,c,b)};Y(this,b);return this.sync("read",this,b)},save:function(b,d,e){var f,h=this.attributes;null==b||"object"===typeof b?(f=b,e=d):(f={})[b]=d;e=c.extend({validate:!0},e);if(f&&!e.wait){if(!this.set(f,e))return!1}else if(!this._validate(f,e))return!1;f&&e.wait&&(this.attributes=c.extend({},h,f));void 0===e.parse&&(e.parse=
!0);var g=this,l=e.success;e.success=function(b){g.attributes=h;var d=g.parse(b,e);e.wait&&(d=c.extend(f||{},d));if(c.isObject(d)&&!g.set(d,e))return!1;l&&l(g,b,e);g.trigger("sync",g,b,e)};Y(this,e);b=this.isNew()?"create":e.patch?"patch":"update";"patch"===b&&(e.attrs=f);b=this.sync(b,this,e);f&&e.wait&&(this.attributes=h);return b},destroy:function(b){b=b?c.clone(b):{};var d=this,e=b.success,f=function(){d.trigger("destroy",d,d.collection,b)};b.success=function(c){(b.wait||d.isNew())&&f();e&&e(d,
c,b);d.isNew()||d.trigger("sync",d,c,b)};if(this.isNew())return b.success(),!1;Y(this,b);var h=this.sync("delete",this,b);b.wait||f();return h},url:function(){var b=c.result(this,"urlRoot")||c.result(this.collection,"url")||U();return this.isNew()?b:b.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(b,c){return b},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(b){return this._validate({},c.extend(b||
{},{validate:!0}))},_validate:function(b,d){if(!d.validate||!this.validate)return!0;b=c.extend({},this.attributes,b);var e=this.validationError=this.validate(b,d)||null;if(!e)return!0;this.trigger("invalid",this,e,c.extend(d,{validationError:e}));return!1}});c.each("keys values pairs invert pick omit".split(" "),function(b){r.prototype[b]=function(){var d=g.call(arguments);d.unshift(this.attributes);return c[b].apply(c,d)}});var p=d.Collection=function(b,d){d||(d={});d.model&&(this.model=d.model);
void 0!==d.comparator&&(this.comparator=d.comparator);this._reset();this.initialize.apply(this,arguments);b&&this.reset(b,c.extend({silent:!0},d))},t={add:!0,remove:!0,merge:!0},s={add:!0,remove:!1};c.extend(p.prototype,h,{model:r,initialize:function(){},toJSON:function(b){return this.map(function(c){return c.toJSON(b)})},sync:function(){return d.sync.apply(this,arguments)},add:function(b,d){return this.set(b,c.extend({merge:!1},d,s))},remove:function(b,d){var e=!c.isArray(b);b=e?[b]:c.clone(b);d||
(d={});var f,h,g,l;f=0;for(h=b.length;f<h;f++)if(l=b[f]=this.get(b[f]))delete this._byId[l.id],delete this._byId[l.cid],g=this.indexOf(l),this.models.splice(g,1),this.length--,d.silent||(d.index=g,l.trigger("remove",l,this,d)),this._removeReference(l,d);return e?b[0]:b},set:function(b,d){d=c.defaults({},d,t);d.parse&&(b=this.parse(b,d));var e=!c.isArray(b);b=e?b?[b]:[]:c.clone(b);var f,h,g,l,m,p,q=d.at,n=this.model,s=this.comparator&&null==q&&!1!==d.sort,u=c.isString(this.comparator)?this.comparator:
null,w=[],A=[],C={},H=d.add,k=d.merge,Z=d.remove,da=!s&&H&&Z?[]:!1;f=0;for(h=b.length;f<h;f++){m=b[f]||{};g=m instanceof r?l=m:m[n.prototype.idAttribute||"id"];if(g=this.get(g))Z&&(C[g.cid]=!0),k&&(m=m===l?l.attributes:m,d.parse&&(m=g.parse(m,d)),g.set(m,d),s&&!p&&g.hasChanged(u)&&(p=!0)),b[f]=g;else if(H){l=b[f]=this._prepareModel(m,d);if(!l)continue;w.push(l);this._addReference(l,d)}l=g||l;!da||!l.isNew()&&C[l.id]||da.push(l);C[l.id]=!0}if(Z){f=0;for(h=this.length;f<h;++f)C[(l=this.models[f]).cid]||
A.push(l);A.length&&this.remove(A,d)}if(w.length||da&&da.length)if(s&&(p=!0),this.length+=w.length,null!=q)for(f=0,h=w.length;f<h;f++)this.models.splice(q+f,0,w[f]);else for(da&&(this.models.length=0),m=da||w,f=0,h=m.length;f<h;f++)this.models.push(m[f]);p&&this.sort({silent:!0});if(!d.silent){f=0;for(h=w.length;f<h;f++)(l=w[f]).trigger("add",l,this,d);(p||da&&da.length)&&this.trigger("sort",this,d)}return e?b[0]:b},reset:function(b,d){d||(d={});for(var e=0,f=this.models.length;e<f;e++)this._removeReference(this.models[e],
d);d.previousModels=this.models;this._reset();b=this.add(b,c.extend({silent:!0},d));d.silent||this.trigger("reset",this,d);return b},push:function(b,d){return this.add(b,c.extend({at:this.length},d))},pop:function(b){var c=this.at(this.length-1);this.remove(c,b);return c},unshift:function(b,d){return this.add(b,c.extend({at:0},d))},shift:function(b){var c=this.at(0);this.remove(c,b);return c},slice:function(){return g.apply(this.models,arguments)},get:function(b){return null==b?void 0:this._byId[b]||
this._byId[b.id]||this._byId[b.cid]},at:function(b){return this.models[b]},where:function(b,d){return c.isEmpty(b)?d?void 0:[]:this[d?"find":"filter"](function(c){for(var d in b)if(b[d]!==c.get(d))return!1;return!0})},findWhere:function(b){return this.where(b,!0)},sort:function(b){if(!this.comparator)throw Error("Cannot sort a set without a comparator");b||(b={});c.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(c.bind(this.comparator,
this));b.silent||this.trigger("sort",this,b);return this},pluck:function(b){return c.invoke(this.models,"get",b)},fetch:function(b){b=b?c.clone(b):{};void 0===b.parse&&(b.parse=!0);var d=b.success,e=this;b.success=function(c){e[b.reset?"reset":"set"](c,b);d&&d(e,c,b);e.trigger("sync",e,c,b)};Y(this,b);return this.sync("read",this,b)},create:function(b,d){d=d?c.clone(d):{};if(!(b=this._prepareModel(b,d)))return!1;d.wait||this.add(b,d);var e=this,f=d.success;d.success=function(b,c){d.wait&&e.add(b,
d);f&&f(b,c,d)};b.save(null,d);return b},parse:function(b,c){return b},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(b,d){if(b instanceof r)return b;d=d?c.clone(d):{};d.collection=this;var e=new this.model(b,d);if(!e.validationError)return e;this.trigger("invalid",this,e.validationError,d);return!1},_addReference:function(b,c){this._byId[b.cid]=b;null!=b.id&&(this._byId[b.id]=b);b.collection||(b.collection=
this);b.on("all",this._onModelEvent,this)},_removeReference:function(b,c){this===b.collection&&delete b.collection;b.off("all",this._onModelEvent,this)},_onModelEvent:function(b,c,d,e){if("add"!==b&&"remove"!==b||d===this)"destroy"===b&&this.remove(c,e),c&&b==="change:"+c.idAttribute&&(delete this._byId[c.previous(c.idAttribute)],null!=c.id&&(this._byId[c.id]=c)),this.trigger.apply(this,arguments)}});c.each("forEach each map collect reduce foldl inject reduceRight foldr find detect filter select reject every all some any include contains invoke max min toArray size first head take initial rest tail drop last without difference indexOf shuffle lastIndexOf isEmpty chain sample".split(" "),
function(b){p.prototype[b]=function(){var d=g.call(arguments);d.unshift(this.models);return c[b].apply(c,d)}});c.each(["groupBy","countBy","sortBy","indexBy"],function(b){p.prototype[b]=function(d,e){var f=c.isFunction(d)?d:function(b){return b.get(d)};return c[b](this.models,f,e)}});f=d.View=function(b){this.cid=c.uniqueId("view");b||(b={});c.extend(this,c.pick(b,w));this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var u=/^(\S+)\s*(.*)$/,w="model collection el id attributes className tagName events".split(" ");
c.extend(f.prototype,h,{tagName:"div",$:function(b){return this.$el.find(b)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(b,c){this.$el&&this.undelegateEvents();this.$el=b instanceof d.$?b:d.$(b);this.el=this.$el[0];!1!==c&&this.delegateEvents();return this},delegateEvents:function(b){if(!b&&!(b=c.result(this,"events")))return this;this.undelegateEvents();for(var d in b){var e=b[d];c.isFunction(e)||
(e=this[b[d]]);if(e){var f=d.match(u),h=f[1],f=f[2],e=c.bind(e,this),h=h+(".delegateEvents"+this.cid);if(""===f)this.$el.on(h,e);else this.$el.on(h,f,e)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_ensureElement:function(){if(this.el)this.setElement(c.result(this,"el"),!1);else{var b=c.extend({},c.result(this,"attributes"));this.id&&(b.id=c.result(this,"id"));this.className&&(b["class"]=c.result(this,"className"));b=d.$("<"+c.result(this,"tagName")+
">").attr(b);this.setElement(b,!1)}}});d.sync=function(b,e,f){var h=n[b];c.defaults(f||(f={}),{emulateHTTP:d.emulateHTTP,emulateJSON:d.emulateJSON});var g={type:h,dataType:"json"};f.url||(g.url=c.result(e,"url")||U());null!=f.data||!e||"create"!==b&&"update"!==b&&"patch"!==b||(g.contentType="application/json",g.data=JSON.stringify(f.attrs||e.toJSON(f)));f.emulateJSON&&(g.contentType="application/x-www-form-urlencoded",g.data=g.data?{model:g.data}:{});if(f.emulateHTTP&&("PUT"===h||"DELETE"===h||"PATCH"===
h)){g.type="POST";f.emulateJSON&&(g.data._method=h);var l=f.beforeSend;f.beforeSend=function(b){b.setRequestHeader("X-HTTP-Method-Override",h);if(l)return l.apply(this,arguments)}}"GET"===g.type||f.emulateJSON||(g.processData=!1);"PATCH"===g.type&&A&&(g.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});b=f.xhr=d.ajax(c.extend(g,f));e.trigger("request",e,b,f);return b};var A="undefined"!==typeof window&&!!window.ActiveXObject&&!(window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),
n={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};d.ajax=function(){return d.$.ajax.apply(d.$,arguments)};var H=d.Router=function(b){b||(b={});b.routes&&(this.routes=b.routes);this._bindRoutes();this.initialize.apply(this,arguments)},y=/\((.*?)\)/g,F=/(\(\?)?:\w+/g,W=/\*\w+/g,ca=/[\-{}\[\]+?.,\\\^$|#\s]/g;c.extend(H.prototype,h,{initialize:function(){},route:function(b,e,f){c.isRegExp(b)||(b=this._routeToRegExp(b));c.isFunction(e)&&(f=e,e="");f||(f=this[e]);var h=this;d.history.route(b,
function(c){c=h._extractParameters(b,c);h.execute(f,c);h.trigger.apply(h,["route:"+e].concat(c));h.trigger("route",e,c);d.history.trigger("route",h,e,c)});return this},execute:function(b,c){b&&b.apply(this,c)},navigate:function(b,c){d.history.navigate(b,c);return this},_bindRoutes:function(){if(this.routes){this.routes=c.result(this,"routes");for(var b,d=c.keys(this.routes);null!=(b=d.pop());)this.route(b,this.routes[b])}},_routeToRegExp:function(b){b=b.replace(ca,"\\$&").replace(y,"(?:$1)?").replace(F,
function(b,c){return c?b:"([^/?]+)"}).replace(W,"([^?]*?)");return new RegExp("^"+b+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(b,d){var e=b.exec(d).slice(1);return c.map(e,function(b,c){return c===e.length-1?b||null:b?decodeURIComponent(b):null})}});var T=d.History=function(){this.handlers=[];c.bindAll(this,"checkUrl");"undefined"!==typeof window&&(this.location=window.location,this.history=window.history)},Q=/^[#\/]|\s+$/g,G=/^\/+|\/+$/g,V=/msie [\w.]+/,C=/\/$/,R=/#.*$/;T.started=!1;c.extend(T.prototype,
h,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(b){return(b=(b||this).location.href.match(/#(.*)$/))?b[1]:""},getFragment:function(b,c){if(null==b)if(this._hasPushState||!this._wantsHashChange||c){b=decodeURI(this.location.pathname+this.location.search);var d=this.root.replace(C,"");b.indexOf(d)||(b=b.slice(d.length))}else b=this.getHash();return b.replace(Q,"")},start:function(b){if(T.started)throw Error("Backbone.history has already been started");
T.started=!0;this.options=c.extend({root:"/"},this.options,b);this.root=this.options.root;this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);b=this.getFragment();var e=document.documentMode,e=V.exec(navigator.userAgent.toLowerCase())&&(!e||7>=e);this.root=("/"+this.root+"/").replace(G,"/");e&&this._wantsHashChange&&(this.iframe=d.$('<iframe src="javascript:0" tabindex="-1">').hide().appendTo("body")[0].contentWindow,
this.navigate(b));if(this._hasPushState)d.$(window).on("popstate",this.checkUrl);else if(this._wantsHashChange&&"onhashchange"in window&&!e)d.$(window).on("hashchange",this.checkUrl);else this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));this.fragment=b;b=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&
this.atRoot()&&b.hash&&(this.fragment=this.getHash().replace(Q,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){d.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);this._checkUrlInterval&&clearInterval(this._checkUrlInterval);T.started=!1},route:function(b,c){this.handlers.unshift({route:b,callback:c})},checkUrl:function(b){b=this.getFragment();b===this.fragment&&this.iframe&&(b=this.getFragment(this.getHash(this.iframe)));
if(b===this.fragment)return!1;this.iframe&&this.navigate(b);this.loadUrl()},loadUrl:function(b){b=this.fragment=this.getFragment(b);return c.any(this.handlers,function(c){if(c.route.test(b))return c.callback(b),!0})},navigate:function(b,c){if(!T.started)return!1;c&&!0!==c||(c={trigger:!!c});var d=this.root+(b=this.getFragment(b||""));b=b.replace(R,"");if(this.fragment!==b){this.fragment=b;""===b&&"/"!==d&&(d=d.slice(0,-1));if(this._hasPushState)this.history[c.replace?"replaceState":"pushState"]({},
document.title,d);else if(this._wantsHashChange)this._updateHash(this.location,b,c.replace),this.iframe&&b!==this.getFragment(this.getHash(this.iframe))&&(c.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,b,c.replace));else return this.location.assign(d);if(c.trigger)return this.loadUrl(b)}},_updateHash:function(b,c,d){d?(d=b.href.replace(/(javascript:|#).*$/,""),b.replace(d+"#"+c)):b.hash="#"+c}});d.history=new T;r.extend=p.extend=H.extend=f.extend=T.extend=function(b,
d){var e=this,f;f=b&&c.has(b,"constructor")?b.constructor:function(){return e.apply(this,arguments)};c.extend(f,e,d);var h=function(){this.constructor=f};h.prototype=e.prototype;f.prototype=new h;b&&c.extend(f.prototype,b);f.__super__=e.prototype;return f};var U=function(){throw Error('A "url" property or function must be specified');},Y=function(b,c){var d=c.error;c.error=function(e){d&&d(b,e,c);b.trigger("error",b,e,c)}};return d});window.Modernizr=function(b,d,c){function f(b,c){return typeof b===c}function e(b,d){for(var e in b){var f=b[e];if(!~(""+f).indexOf("-")&&t[f]!==c)return"pfx"==d?f:!0}return!1}function g(b,d,h){var g=b.charAt(0).toUpperCase()+b.slice(1),l=(b+" "+n.join(g+" ")+g).split(" ");if(f(d,"string")||f(d,"undefined"))d=e(l,d);else a:{l=(b+" "+H.join(g+" ")+g).split(" "),b=l;for(var m in b)if(g=d[b[m]],g!==c){d=!1===h?b[m]:f(g,"function")?g.bind(h||d):g;break a}d=!1}return d}function h(){q.input=function(c){for(var e=
0,f=c.length;f>e;e++)F[c[e]]=!!(c[e]in s);return F.list&&(F.list=!(!d.createElement("datalist")||!b.HTMLDataListElement)),F}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" "));q.inputtypes=function(b){for(var e,f,h,g=0,l=b.length;l>g;g++)s.setAttribute("type",f=b[g]),(e="text"!==s.type)&&(s.value=u,s.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(f)&&s.style.WebkitAppearance!==c?(r.appendChild(s),h=d.defaultView,e=h.getComputedStyle&&
"textfield"!==h.getComputedStyle(s,null).WebkitAppearance&&0!==s.offsetHeight,r.removeChild(s)):/^(search|tel)$/.test(f)||(e=/^(url|email)$/.test(f)?s.checkValidity&&!1===s.checkValidity():s.value!=u)),y[b[g]]=!!e;return y}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var l,m,q={},r=d.documentElement,p=d.createElement("modernizr"),t=p.style,s=d.createElement("input"),u=":)",w={}.toString,A=" -webkit- -moz- -o- -ms- ".split(" "),n=["Webkit","Moz",
"O","ms"],H=["webkit","moz","o","ms"],p={},y={},F={},W=[],ca=W.slice,T=function(b,c,e,f){var h,g,l,m,p=d.createElement("div"),q=d.body,n=q||d.createElement("body");if(parseInt(e,10))for(;e--;)l=d.createElement("div"),l.id=f?f[e]:"modernizr"+(e+1),p.appendChild(l);return h=['&#173;<style id="smodernizr">',b,"</style>"].join(""),p.id="modernizr",(q?p:n).innerHTML+=h,n.appendChild(p),q||(n.style.background="",n.style.overflow="hidden",m=r.style.overflow,r.style.overflow="hidden",r.appendChild(n)),g=
c(p,b),q?p.parentNode.removeChild(p):(n.parentNode.removeChild(n),r.style.overflow=m),!!g},Q=function(){var b={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return function(e,h){h=h||d.createElement(b[e]||"div");e="on"+e;var g=e in h;return g||(h.setAttribute||(h=d.createElement("div")),h.setAttribute&&h.removeAttribute&&(h.setAttribute(e,""),g=f(h[e],"function"),f(h[e],"undefined")||(h[e]=c),h.removeAttribute(e))),g}}(),G={}.hasOwnProperty;m=f(G,"undefined")||
f(G.call,"undefined")?function(b,c){return c in b&&f(b.constructor.prototype[c],"undefined")}:function(b,c){return G.call(b,c)};Function.prototype.bind||(Function.prototype.bind=function(b){var c=this;if("function"!=typeof c)throw new TypeError;var d=ca.call(arguments,1),e=function(){if(this instanceof e){var f=function(){};f.prototype=c.prototype;var f=new f,h=c.apply(f,d.concat(ca.call(arguments)));return Object(h)===h?h:f}return c.apply(b,d.concat(ca.call(arguments)))};return e});p.flexbox=function(){return g("flexWrap")};
p.flexboxlegacy=function(){return g("boxDirection")};p.canvas=function(){var b=d.createElement("canvas");return!(!b.getContext||!b.getContext("2d"))};p.canvastext=function(){return!(!q.canvas||!f(d.createElement("canvas").getContext("2d").fillText,"function"))};p.webgl=function(){return!!b.WebGLRenderingContext};p.touch=function(){var c;return"ontouchstart"in b||b.DocumentTouch&&d instanceof DocumentTouch?c=!0:T(["@media (",A.join("touch-enabled),("),"modernizr){#modernizr{top:9px;position:absolute}}"].join(""),
function(b){c=9===b.offsetTop}),c};p.geolocation=function(){return"geolocation"in navigator};p.postmessage=function(){return!!b.postMessage};p.websqldatabase=function(){return!!b.openDatabase};p.indexedDB=function(){return!!g("indexedDB",b)};p.hashchange=function(){return Q("hashchange",b)&&(d.documentMode===c||7<d.documentMode)};p.history=function(){return!(!b.history||!history.pushState)};p.draganddrop=function(){var b=d.createElement("div");return"draggable"in b||"ondragstart"in b&&"ondrop"in b};
p.websockets=function(){return"WebSocket"in b||"MozWebSocket"in b};p.rgba=function(){t.cssText="background-color:rgba(150,255,150,.5)";return!!~(""+t.backgroundColor).indexOf("rgba")};p.hsla=function(){t.cssText="background-color:hsla(120,40%,100%,.5)";return!!~(""+t.backgroundColor).indexOf("rgba")||!!~(""+t.backgroundColor).indexOf("hsla")};p.multiplebgs=function(){t.cssText="background:url(https://),url(https://),red url(https://)";return/(url\s*\(.*?){3}/.test(t.background)};p.backgroundsize=
function(){return g("backgroundSize")};p.borderimage=function(){return g("borderImage")};p.borderradius=function(){return g("borderRadius")};p.boxshadow=function(){return g("boxShadow")};p.textshadow=function(){return""===d.createElement("div").style.textShadow};p.opacity=function(){var b=A.join("opacity:.55;")+"";t.cssText=b;return/^0.55$/.test(t.opacity)};p.cssanimations=function(){return g("animationName")};p.csscolumns=function(){return g("columnCount")};p.cssgradients=function(){var b=("background-image:-webkit-gradient(linear,left top,right bottom,from(#9f9),to(white));background-image:"+
A.join("linear-gradient(left top,#9f9, white);background-image:")).slice(0,-17);t.cssText=b;return!!~(""+t.backgroundImage).indexOf("gradient")};p.cssreflections=function(){return g("boxReflect")};p.csstransforms=function(){return!!g("transform")};p.csstransforms3d=function(){var b=!!g("perspective");return b&&"webkitPerspective"in r.style&&T("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(c){b=9===c.offsetLeft&&3===c.offsetHeight}),b};p.csstransitions=
function(){return g("transition")};p.fontface=function(){var b;return T('@font-face {font-family:"font";src:url("https://")}',function(c,e){var f=d.getElementById("smodernizr"),f=(f=f.sheet||f.styleSheet)?f.cssRules&&f.cssRules[0]?f.cssRules[0].cssText:f.cssText||"":"";b=/src/i.test(f)&&0===f.indexOf(e.split(" ")[0])}),b};p.generatedcontent=function(){var b;return T(['#modernizr{font:0/0 a}#modernizr:after{content:"',u,'";visibility:hidden;font:3px/1 a}'].join(""),function(c){b=3<=c.offsetHeight}),
b};p.video=function(){var b=d.createElement("video"),c=!1;try{(c=!!b.canPlayType)&&(c=new Boolean(c),c.ogg=b.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),c.h264=b.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),c.webm=b.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch(e){}return c};p.audio=function(){var b=d.createElement("audio"),c=!1;try{(c=!!b.canPlayType)&&(c=new Boolean(c),c.ogg=b.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,
""),c.mp3=b.canPlayType("audio/mpeg;").replace(/^no$/,""),c.wav=b.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),c.m4a=(b.canPlayType("audio/x-m4a;")||b.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(e){}return c};p.localstorage=function(){try{return localStorage.setItem("modernizr","modernizr"),localStorage.removeItem("modernizr"),!0}catch(b){return!1}};p.sessionstorage=function(){try{return sessionStorage.setItem("modernizr","modernizr"),sessionStorage.removeItem("modernizr"),!0}catch(b){return!1}};
p.webworkers=function(){return!!b.Worker};p.applicationcache=function(){return!!b.applicationCache};p.svg=function(){return!!d.createElementNS&&!!d.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect};p.inlinesvg=function(){var b=d.createElement("div");return b.innerHTML="<svg/>","http://www.w3.org/2000/svg"==(b.firstChild&&b.firstChild.namespaceURI)};p.smil=function(){return!!d.createElementNS&&/SVGAnimate/.test(w.call(d.createElementNS("http://www.w3.org/2000/svg","animate")))};p.svgclippaths=
function(){return!!d.createElementNS&&/SVGClipPath/.test(w.call(d.createElementNS("http://www.w3.org/2000/svg","clipPath")))};for(var V in p)m(p,V)&&(l=V.toLowerCase(),q[l]=p[V](),W.push((q[l]?"":"no-")+l));q.input||h();q.addTest=function(b,d){if("object"==typeof b)for(var e in b)m(b,e)&&q.addTest(e,b[e]);else{if(b=b.toLowerCase(),q[b]!==c)return q;d="function"==typeof d?d():d;r.className+=" "+(d?"":"no-")+b;q[b]=d}return q};t.cssText="";return p=s=null,function(b,c){function d(){var b=u.elements;
return"string"==typeof b?b.split(" "):b}function e(b){var c=s[b[n]];return c||(c={},t++,b[n]=t,s[t]=c),c}function f(b,d,h){if(d||(d=c),m)return d.createElement(b);h||(h=e(d));var g;return g=h.cache[b]?h.cache[b].cloneNode():q.test(b)?(h.cache[b]=h.createElem(b)).cloneNode():h.createElem(b),!g.canHaveChildren||r.test(b)||g.tagUrn?g:h.frag.appendChild(g)}function h(b,c){c.cache||(c.cache={},c.createElem=b.createElement,c.createFrag=b.createDocumentFragment,c.frag=c.createFrag());b.createElement=function(d){return u.shivMethods?
f(d,b,c):c.createElem(d)};b.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+d().join().replace(/[\w\-]+/g,function(b){return c.createElem(b),c.frag.createElement(b),'c("'+b+'")'})+");return n}")(u,c.frag)}function g(b){b||(b=c);var d=e(b);if(u.shivCSS&&!l&&!d.hasCSS){var f,p=b;f=p.createElement("p");p=p.getElementsByTagName("head")[0]||p.documentElement;f=(f.innerHTML="x<style>article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}</style>",
p.insertBefore(f.lastChild,p.firstChild));d.hasCSS=!!f}return m||h(b,d),b}var l,m,p=b.html5||{},r=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,q=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,n="_html5shiv",t=0,s={};!function(){try{var b=c.createElement("a");b.innerHTML="<xyz></xyz>";l="hidden"in b;var d;if(!(d=1==b.childNodes.length)){c.createElement("a");var e=c.createDocumentFragment();d="undefined"==typeof e.cloneNode||
"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}m=d}catch(f){m=l=!0}}();var u={elements:p.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:"3.7.0",shivCSS:!1!==p.shivCSS,supportsUnknownElements:m,shivMethods:!1!==p.shivMethods,type:"default",shivDocument:g,createElement:f,createDocumentFragment:function(b,f){if(b||(b=c),
m)return b.createDocumentFragment();f=f||e(b);for(var h=f.frag.cloneNode(),g=0,l=d(),k=l.length;k>g;g++)h.createElement(l[g]);return h}};b.html5=u;g(c)}(this,d),q._version="2.7.2",q._prefixes=A,q._domPrefixes=H,q._cssomPrefixes=n,q.mq=function(c){var d=b.matchMedia||b.msMatchMedia;if(d)return d(c).matches;var e;return T("@media "+c+" { #modernizr { position: absolute; } }",function(c){e="absolute"==(b.getComputedStyle?getComputedStyle(c,null):c.currentStyle).position}),e},q.hasEvent=Q,q.testProp=
function(b){return e([b])},q.testAllProps=g,q.testStyles=T,q.prefixed=function(b,c,d){return c?g(b,c,d):g(b,"pfx")},r.className=r.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(" js "+W.join(" ")),q}(this,this.document);(function(b,d,c,f){function e(b){this.selector=b;this.query=""}(function(c){var d=b("head");d.prepend(b.map(c,function(b){if(0===d.has("."+b).length)return'<meta class="'+b+'" />'}))})("foundation-mq-small foundation-mq-small-only foundation-mq-medium foundation-mq-medium-only foundation-mq-large foundation-mq-large-only foundation-mq-xlarge foundation-mq-xlarge-only foundation-mq-xxlarge foundation-data-attribute-namespace".split(" "));b(function(){"undefined"!==typeof FastClick&&"undefined"!==typeof c.body&&
FastClick.attach(c.body)});var g=function(d,e){if("string"===typeof d){if(e){var f;if(e.jquery){if(f=e[0],!f)return e}else f=e;return b(f.querySelectorAll(d))}return b(c.querySelectorAll(d))}return b(d,e)},h=function(b){var c=[];b||c.push("data");0<this.namespace.length&&c.push(this.namespace);c.push(this.name);return c.join("-")},l=function(b){b=b.split("-");for(var c=b.length,d=[];c--;)0!==c?d.push(b[c]):0<this.namespace.length?d.push(this.namespace,b[c]):d.push(b[c]);return d.reverse().join("-")},
m=function(c,d){var e=this,f=function(){var f=g(this),h=!f.data(e.attr_name(!0)+"-init");f.data(e.attr_name(!0)+"-init",b.extend({},e.settings,d||c,e.data_options(f)));h&&e.events(this)};g(this.scope).is("["+this.attr_name()+"]")?f.call(this.scope):g("["+this.attr_name()+"]",this.scope).each(f);if("string"===typeof c)return this[c].call(this,d)},q=function(b,c){function d(){c(b[0])}function e(){this.one("load",d);if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var b=this.attr("src"),c=b.match(/\?/)?
"&":"?",c=c+("random="+(new Date).getTime());this.attr("src",b+c)}}b.attr("src")?b[0].complete||4===b[0].readyState?d():e.call(b):d()};d.matchMedia||(d.matchMedia=function(){var b=d.styleMedia||d.media;if(!b){var e=c.createElement("style"),f=c.getElementsByTagName("script")[0],h=null;e.type="text/css";e.id="matchmediajs-test";f.parentNode.insertBefore(e,f);h="getComputedStyle"in d&&d.getComputedStyle(e,null)||e.currentStyle;b={matchMedium:function(b){b="@media "+b+"{ #matchmediajs-test { width: 1px; } }";
e.styleSheet?e.styleSheet.cssText=b:e.textContent=b;return"1px"===h.width}}}return function(c){return{matches:b.matchMedium(c||"all"),media:c||"all"}}}());(function(b){function c(){e&&(g(c),m&&b.fx.tick())}for(var e,f=0,h=["webkit","moz"],g=d.requestAnimationFrame,l=d.cancelAnimationFrame,m="undefined"!==typeof b.fx;f<h.length&&!g;f++)g=d[h[f]+"RequestAnimationFrame"],l=l||d[h[f]+"CancelAnimationFrame"]||d[h[f]+"CancelRequestAnimationFrame"];g?(d.requestAnimationFrame=g,d.cancelAnimationFrame=l,m&&
(b.fx.timer=function(d){d()&&b.timers.push(d)&&!e&&(e=!0,c())},b.fx.stop=function(){e=!1})):(d.requestAnimationFrame=function(b){var c=(new Date).getTime(),e=Math.max(0,16-(c-f)),h=d.setTimeout(function(){b(c+e)},e);f=c+e;return h},d.cancelAnimationFrame=function(b){clearTimeout(b)})})(b);e.prototype.toString=function(){return this.query||(this.query=g(this.selector).css("font-family").replace(/^[\/\\'"]+|(;\s?})+|[\/\\'"]+$/g,""))};d.Foundation={name:"Foundation",version:"5.5.3",media_queries:{small:new e(".foundation-mq-small"),
"small-only":new e(".foundation-mq-small-only"),medium:new e(".foundation-mq-medium"),"medium-only":new e(".foundation-mq-medium-only"),large:new e(".foundation-mq-large"),"large-only":new e(".foundation-mq-large-only"),xlarge:new e(".foundation-mq-xlarge"),"xlarge-only":new e(".foundation-mq-xlarge-only"),xxlarge:new e(".foundation-mq-xxlarge")},stylesheet:b("<style></style>").appendTo("head")[0].sheet,global:{namespace:f},init:function(b,c,e,f,h){e=[b,e,f,h];f=[];this.rtl=/rtl/i.test(g("html").attr("dir"));
this.scope=b||this.scope;this.set_namespace();if(c&&"string"===typeof c&&!/reflow/i.test(c))this.libs.hasOwnProperty(c)&&f.push(this.init_lib(c,e));else for(var l in this.libs)f.push(this.init_lib(l,c));g(d).load(function(){g(d).trigger("resize.fndtn.clearing").trigger("resize.fndtn.dropdown").trigger("resize.fndtn.equalizer").trigger("resize.fndtn.interchange").trigger("resize.fndtn.joyride").trigger("resize.fndtn.magellan").trigger("resize.fndtn.topbar").trigger("resize.fndtn.slider")});return b},
init_lib:function(c,d){if(this.libs.hasOwnProperty(c)){this.patch(this.libs[c]);if(d&&d.hasOwnProperty(c))return"undefined"!==typeof this.libs[c].settings?b.extend(!0,this.libs[c].settings,d[c]):"undefined"!==typeof this.libs[c].defaults&&b.extend(!0,this.libs[c].defaults,d[c]),this.libs[c].init.apply(this.libs[c],[this.scope,d[c]]);d=d instanceof Array?d:Array(d);return this.libs[c].init.apply(this.libs[c],d)}return function(){}},patch:function(b){b.scope=this.scope;b.namespace=this.global.namespace;
b.rtl=this.rtl;b.data_options=this.utils.data_options;b.attr_name=h;b.add_namespace=l;b.bindings=m;b.S=this.utils.S},inherit:function(b,c){for(var d=c.split(" "),e=d.length;e--;)this.utils.hasOwnProperty(d[e])&&(b[d[e]]=this.utils[d[e]])},set_namespace:function(){var c=this.global.namespace===f?b(".foundation-data-attribute-namespace").css("font-family"):this.global.namespace;this.global.namespace=c===f||/false/i.test(c)?"":c},libs:{},utils:{S:g,throttle:function(b,c){var d=null;return function(){var e=
this,f=arguments;null==d&&(d=setTimeout(function(){b.apply(e,f);d=null},c))}},debounce:function(b,c,d){var e,f;return function(){var h=this,g=arguments,l=d&&!e;clearTimeout(e);e=setTimeout(function(){e=null;d||(f=b.apply(h,g))},c);l&&(f=b.apply(h,g));return f}},data_options:function(c,d){function e(b){return!isNaN(b-0)&&null!==b&&""!==b&&!1!==b&&!0!==b}function f(c){return"string"===typeof c?b.trim(c):c}d=d||"options";var h={},g,l,m;g=function(b){var c=Foundation.global.namespace;return 0<c.length?
b.data(c+"-"+d):b.data(d)}(c);if("object"===typeof g)return g;m=(g||":").split(";");for(g=m.length;g--;)l=m[g].split(":"),l=[l[0],l.slice(1).join(":")],/true/i.test(l[1])&&(l[1]=!0),/false/i.test(l[1])&&(l[1]=!1),e(l[1])&&(-1===l[1].indexOf(".")?l[1]=parseInt(l[1],10):l[1]=parseFloat(l[1])),2===l.length&&0<l[0].length&&(h[f(l[0])]=f(l[1]));return h},register_media:function(c,d){if(Foundation.media_queries[c]===f){b("head").append('<meta class="'+d+'"/>');var e=Foundation.media_queries,h=b("."+d).css("font-family");
if("string"===typeof h||h instanceof String)h=h.replace(/^['\\/"]+|(;\s?})+|['\\/"]+$/g,"");e[c]=h}},add_custom_rule:function(b,c){c===f&&Foundation.stylesheet?Foundation.stylesheet.insertRule(b,Foundation.stylesheet.cssRules.length):Foundation.media_queries[c]!==f&&Foundation.stylesheet.insertRule("@media "+Foundation.media_queries[c]+"{ "+b+" }",Foundation.stylesheet.cssRules.length)},image_loaded:function(b,c){function d(b){for(var c=b.length-1;0<=c;c--)if(b.attr("height")===f)return!1;return!0}
var e=this,h=b.length;(0===h||d(b))&&c(b);b.each(function(){q(e.S(this),function(){--h;0===h&&c(b)})})},random_str:function(){this.fidx||(this.fidx=0);this.prefix=this.prefix||[this.name||"F",(+new Date).toString(36)].join("-");return this.prefix+(this.fidx++).toString(36)},match:function(b){return d.matchMedia(b).matches},is_small_up:function(){return this.match(Foundation.media_queries.small)},is_medium_up:function(){return this.match(Foundation.media_queries.medium)},is_large_up:function(){return this.match(Foundation.media_queries.large)},
is_xlarge_up:function(){return this.match(Foundation.media_queries.xlarge)},is_xxlarge_up:function(){return this.match(Foundation.media_queries.xxlarge)},is_small_only:function(){return!this.is_medium_up()&&!this.is_large_up()&&!this.is_xlarge_up()&&!this.is_xxlarge_up()},is_medium_only:function(){return this.is_medium_up()&&!this.is_large_up()&&!this.is_xlarge_up()&&!this.is_xxlarge_up()},is_large_only:function(){return this.is_medium_up()&&this.is_large_up()&&!this.is_xlarge_up()&&!this.is_xxlarge_up()},
is_xlarge_only:function(){return this.is_medium_up()&&this.is_large_up()&&this.is_xlarge_up()&&!this.is_xxlarge_up()},is_xxlarge_only:function(){return this.is_medium_up()&&this.is_large_up()&&this.is_xlarge_up()&&this.is_xxlarge_up()}}};b.fn.foundation=function(){var b=Array.prototype.slice.call(arguments,0);return this.each(function(){Foundation.init.apply(Foundation,[this].concat(b));return this})}})(jQuery,window,window.document);(function(b,d,c,f){Foundation.libs.offcanvas={name:"offcanvas",version:"5.5.3",settings:{open_method:"move",close_on_click:!1},init:function(b,c,d){this.bindings(c,d)},events:function(){var c=this,d=c.S,f="",l="",m="",q="",r="";"move"===this.settings.open_method?(f="move-",l="right",m="left",q="top",r="bottom"):"overlap_single"===this.settings.open_method?(f="offcanvas-overlap-",l="right",m="left",q="top",r="bottom"):"overlap"===this.settings.open_method&&(f="offcanvas-overlap");d(this.scope).off(".offcanvas").on("click.fndtn.offcanvas",
".left-off-canvas-toggle",function(m){c.click_toggle_class(m,f+l);"overlap"!==c.settings.open_method&&d(".left-submenu").removeClass(f+l);b(".left-off-canvas-toggle").attr("aria-expanded","true")}).on("click.fndtn.offcanvas",".left-off-canvas-menu a",function(m){var q=c.get_settings(m),r=d(this).parent();!q.close_on_click||r.hasClass("has-submenu")||r.hasClass("back")?d(this).parent().hasClass("has-submenu")?(m.preventDefault(),d(this).siblings(".left-submenu").toggleClass(f+l)):r.hasClass("back")&&
(m.preventDefault(),r.parent().removeClass(f+l)):(c.hide.call(c,f+l,c.get_wrapper(m)),r.parent().removeClass(f+l));b(".left-off-canvas-toggle").attr("aria-expanded","true")}).on("click.fndtn.offcanvas",".right-off-canvas-toggle",function(l){c.click_toggle_class(l,f+m);"overlap"!==c.settings.open_method&&d(".right-submenu").removeClass(f+m);b(".right-off-canvas-toggle").attr("aria-expanded","true")}).on("click.fndtn.offcanvas",".right-off-canvas-menu a",function(l){var q=c.get_settings(l),r=d(this).parent();
!q.close_on_click||r.hasClass("has-submenu")||r.hasClass("back")?d(this).parent().hasClass("has-submenu")?(l.preventDefault(),d(this).siblings(".right-submenu").toggleClass(f+m)):r.hasClass("back")&&(l.preventDefault(),r.parent().removeClass(f+m)):(c.hide.call(c,f+m,c.get_wrapper(l)),r.parent().removeClass(f+m));b(".right-off-canvas-toggle").attr("aria-expanded","true")}).on("click.fndtn.offcanvas",".top-off-canvas-toggle",function(l){c.click_toggle_class(l,f+r);"overlap"!==c.settings.open_method&&
d(".top-submenu").removeClass(f+r);b(".top-off-canvas-toggle").attr("aria-expanded","true")}).on("click.fndtn.offcanvas",".top-off-canvas-menu a",function(l){var m=c.get_settings(l),q=d(this).parent();!m.close_on_click||q.hasClass("has-submenu")||q.hasClass("back")?d(this).parent().hasClass("has-submenu")?(l.preventDefault(),d(this).siblings(".top-submenu").toggleClass(f+r)):q.hasClass("back")&&(l.preventDefault(),q.parent().removeClass(f+r)):(c.hide.call(c,f+r,c.get_wrapper(l)),q.parent().removeClass(f+
r));b(".top-off-canvas-toggle").attr("aria-expanded","true")}).on("click.fndtn.offcanvas",".bottom-off-canvas-toggle",function(l){c.click_toggle_class(l,f+q);"overlap"!==c.settings.open_method&&d(".bottom-submenu").removeClass(f+q);b(".bottom-off-canvas-toggle").attr("aria-expanded","true")}).on("click.fndtn.offcanvas",".bottom-off-canvas-menu a",function(l){var m=c.get_settings(l),r=d(this).parent();!m.close_on_click||r.hasClass("has-submenu")||r.hasClass("back")?d(this).parent().hasClass("has-submenu")?
(l.preventDefault(),d(this).siblings(".bottom-submenu").toggleClass(f+q)):r.hasClass("back")&&(l.preventDefault(),r.parent().removeClass(f+q)):(c.hide.call(c,f+q,c.get_wrapper(l)),r.parent().removeClass(f+q));b(".bottom-off-canvas-toggle").attr("aria-expanded","true")}).on("click.fndtn.offcanvas",".exit-off-canvas",function(q){c.click_remove_class(q,f+m);d(".right-submenu").removeClass(f+m);l&&(c.click_remove_class(q,f+l),d(".left-submenu").removeClass(f+m));b(".right-off-canvas-toggle").attr("aria-expanded",
"true")}).on("click.fndtn.offcanvas",".exit-off-canvas",function(d){c.click_remove_class(d,f+m);b(".left-off-canvas-toggle").attr("aria-expanded","false");l&&(c.click_remove_class(d,f+l),b(".right-off-canvas-toggle").attr("aria-expanded","false"))}).on("click.fndtn.offcanvas",".exit-off-canvas",function(l){c.click_remove_class(l,f+q);d(".bottom-submenu").removeClass(f+q);r&&(c.click_remove_class(l,f+r),d(".top-submenu").removeClass(f+q));b(".bottom-off-canvas-toggle").attr("aria-expanded","true")}).on("click.fndtn.offcanvas",
".exit-off-canvas",function(d){c.click_remove_class(d,f+q);b(".top-off-canvas-toggle").attr("aria-expanded","false");r&&(c.click_remove_class(d,f+r),b(".bottom-off-canvas-toggle").attr("aria-expanded","false"))})},toggle:function(b,c){c=c||this.get_wrapper();c.is("."+b)?this.hide(b,c):this.show(b,c)},show:function(b,c){c=c||this.get_wrapper();c.trigger("open.fndtn.offcanvas");c.addClass(b)},hide:function(b,c){c=c||this.get_wrapper();c.trigger("close.fndtn.offcanvas");c.removeClass(b)},click_toggle_class:function(b,
c){b.preventDefault();var d=this.get_wrapper(b);this.toggle(c,d)},click_remove_class:function(b,c){b.preventDefault();var d=this.get_wrapper(b);this.hide(c,d)},get_settings:function(b){return this.S(b.target).closest("["+this.attr_name()+"]").data(this.attr_name(!0)+"-init")||this.settings},get_wrapper:function(b){b=this.S(b?b.target:this.scope).closest(".off-canvas-wrap");0===b.length&&(b=this.S(".off-canvas-wrap"));return b},reflow:function(){}}})(jQuery,window,window.document);(function(b,d,c,f){function e(b){var c=/fade/i.test(b);b=/pop/i.test(b);return{animate:c||b,pop:b,fade:c}}var g=[];Foundation.libs.reveal={name:"reveal",version:"5.5.3",locked:!1,settings:{animation:"fadeAndPop",animation_speed:250,close_on_background_click:!0,close_on_esc:!0,dismiss_modal_class:"close-reveal-modal",multiple_opened:!1,bg_class:"reveal-modal-bg",root_element:"body",open:function(){},opened:function(){},close:function(){},closed:function(){},on_ajax_error:b.noop,bg:b(".reveal-modal-bg"),
css:{open:{opacity:0,visibility:"visible",display:"block"},close:{opacity:1,visibility:"hidden",display:"none"}}},init:function(c,d,e){b.extend(!0,this.settings,d,e);this.bindings(d,e)},events:function(b){var d=this,e=d.S;e(this.scope).off(".reveal").on("click.fndtn.reveal","["+this.add_namespace("data-reveal-id")+"]:not([disabled])",function(b){b.preventDefault();if(!d.locked){b=e(this);var c=b.data(d.data_attr("reveal-ajax")),f=b.data(d.data_attr("reveal-replace-content"));d.locked=!0;"undefined"===
typeof c?d.open.call(d,b):(c=!0===c?b.attr("href"):c,d.open.call(d,b,{url:c},{replaceContentSel:f}))}});e(c).on("click.fndtn.reveal",this.close_targets(),function(b){b.preventDefault();if(!d.locked){var c=e("["+d.attr_name()+"].open").data(d.attr_name(!0)+"-init")||d.settings,f=e(b.target)[0]===e("."+c.bg_class)[0];if(f)if(c.close_on_background_click)b.stopPropagation();else return;d.locked=!0;d.close.call(d,f?e("["+d.attr_name()+"].open:not(.toback)"):e(this).closest("["+d.attr_name()+"]"))}});if(0<
e("["+d.attr_name()+"]",this.scope).length)e(this.scope).on("open.fndtn.reveal",this.settings.open).on("opened.fndtn.reveal",this.settings.opened).on("opened.fndtn.reveal",this.open_video).on("close.fndtn.reveal",this.settings.close).on("closed.fndtn.reveal",this.settings.closed).on("closed.fndtn.reveal",this.close_video);else e(this.scope).on("open.fndtn.reveal","["+d.attr_name()+"]",this.settings.open).on("opened.fndtn.reveal","["+d.attr_name()+"]",this.settings.opened).on("opened.fndtn.reveal",
"["+d.attr_name()+"]",this.open_video).on("close.fndtn.reveal","["+d.attr_name()+"]",this.settings.close).on("closed.fndtn.reveal","["+d.attr_name()+"]",this.settings.closed).on("closed.fndtn.reveal","["+d.attr_name()+"]",this.close_video);return!0},key_up_on:function(b){var c=this;c.S("body").off("keyup.fndtn.reveal").on("keyup.fndtn.reveal",function(b){var d=c.S("["+c.attr_name()+"].open"),e=d.data(c.attr_name(!0)+"-init")||c.settings;e&&27===b.which&&e.close_on_esc&&!c.locked&&c.close.call(c,d)});
return!0},key_up_off:function(b){this.S("body").off("keyup.fndtn.reveal");return!0},open:function(c,e){var m=this,q;c?"undefined"!==typeof c.selector?q=m.S("#"+c.data(m.data_attr("reveal-id"))).first():(q=m.S(this.scope),e=c):q=m.S(this.scope);var r=q.data(m.attr_name(!0)+"-init"),r=r||this.settings;if(q.hasClass("open")&&c!==f&&c.attr("data-reveal-id")==q.attr("id"))return m.close(q);if(!q.hasClass("open")){var p=m.S("["+m.attr_name()+"].open");"undefined"===typeof q.data("css-top")&&q.data("css-top",
parseInt(q.css("top"),10)).data("offset",this.cache_offset(q));q.attr("tabindex","0").attr("aria-hidden","false");this.key_up_on(q);q.on("open.fndtn.reveal",function(b){});q.on("open.fndtn.reveal").trigger("open.fndtn.reveal");1>p.length&&this.toggle_bg(q,!0);"string"===typeof e&&(e={url:e});var t=function(){0<p.length&&(r.multiple_opened?m.to_back(p):m.hide(p,r.css.close));r.multiple_opened&&g.push(q);m.show(q,r.css.open)};if("undefined"!==typeof e&&e.url){var s="undefined"!==typeof e.success?e.success:
null;b.extend(e,{success:function(c,d,e){b.isFunction(s)&&(d=s(c,d,e),"string"==typeof d&&(c=d));"undefined"!==typeof options&&"undefined"!==typeof options.replaceContentSel?q.find(options.replaceContentSel).html(c):q.html(c);m.S(q).foundation("section","reflow");m.S(q).children().foundation();t()}});r.on_ajax_error!==b.noop&&b.extend(e,{error:r.on_ajax_error});b.ajax(e)}else t()}m.S(d).trigger("resize")},close:function(c){c=c&&c.length?c:this.S(this.scope);var d=this.S("["+this.attr_name()+"].open"),
e=c.data(this.attr_name(!0)+"-init")||this.settings,f=this;if(0<d.length){c.removeAttr("tabindex","0").attr("aria-hidden","true");this.locked=!0;this.key_up_off(c);c.trigger("close.fndtn.reveal");if(e.multiple_opened&&1===d.length||!e.multiple_opened||1<c.length)f.toggle_bg(c,!1),f.to_front(c);e.multiple_opened?(d=c.is(":not(.toback)"),f.hide(c,e.css.close,e),d?g.pop():g=b.grep(g,function(b){(b=b[0]===c[0])&&f.to_front(c);return!b}),0<g.length&&f.to_front(g[g.length-1])):f.hide(d,e.css.close,e)}},
close_targets:function(){var b="."+this.settings.dismiss_modal_class;return this.settings.close_on_background_click?b+", ."+this.settings.bg_class:b},toggle_bg:function(c,d){0===this.S("."+this.settings.bg_class).length&&(this.settings.bg=b("<div />",{"class":this.settings.bg_class}).appendTo("body").hide());var e=0<this.settings.bg.filter(":visible").length;d!=e&&((d==f?e:!d)?this.hide(this.settings.bg):this.show(this.settings.bg))},show:function(c,f){if(f){var g=c.data(this.attr_name(!0)+"-init")||
this.settings,q=g.root_element,r=this;if(0===c.parent(q).length){var p=c.wrap('<div style="display: none;" />').parent();c.on("closed.fndtn.reveal.wrapped",function(){c.detach().appendTo(p);c.unwrap().unbind("closed.fndtn.reveal.wrapped")});c.detach().appendTo(q)}q=e(g.animation);q.animate||(this.locked=!1);if(q.pop){f.top=b(d).scrollTop()-c.data("offset")+"px";var t={top:b(d).scrollTop()+c.data("css-top")+"px",opacity:1};return setTimeout(function(){return c.css(f).animate(t,g.animation_speed,"linear",
function(){r.locked=!1;c.trigger("opened.fndtn.reveal")}).addClass("open")},g.animation_speed/2)}f.top=b(d).scrollTop()+c.data("css-top")+"px";return q.fade?(t={opacity:1},setTimeout(function(){return c.css(f).animate(t,g.animation_speed,"linear",function(){r.locked=!1;c.trigger("opened.fndtn.reveal")}).addClass("open")},g.animation_speed/2)):c.css(f).show().css({opacity:1}).addClass("open").trigger("opened.fndtn.reveal")}g=this.settings;if(e(g.animation).fade)return c.fadeIn(g.animation_speed/2);
this.locked=!1;return c.show()},to_back:function(b){b.addClass("toback")},to_front:function(b){b.removeClass("toback")},hide:function(c,f){if(f){var g=c.data(this.attr_name(!0)+"-init"),q=this,g=g||this.settings,r=e(g.animation);r.animate||(this.locked=!1);if(r.pop){var p={top:-b(d).scrollTop()-c.data("offset")+"px",opacity:0};return setTimeout(function(){return c.animate(p,g.animation_speed,"linear",function(){q.locked=!1;c.css(f).trigger("closed.fndtn.reveal")}).removeClass("open")},g.animation_speed/
2)}return r.fade?(p={opacity:0},setTimeout(function(){return c.animate(p,g.animation_speed,"linear",function(){q.locked=!1;c.css(f).trigger("closed.fndtn.reveal")}).removeClass("open")},g.animation_speed/2)):c.hide().css(f).removeClass("open").trigger("closed.fndtn.reveal")}g=this.settings;return e(g.animation).fade?c.fadeOut(g.animation_speed/2):c.hide()},close_video:function(c){c=b(".flex-video",c.target);var d=b("iframe",c);0<d.length&&(d.attr("data-src",d[0].src),d.attr("src",d.attr("src")),c.hide())},
open_video:function(c){c=b(".flex-video",c.target);var d=c.find("iframe");if(0<d.length){if("string"===typeof d.attr("data-src"))d[0].src=d.attr("data-src");else{var e=d[0].src;d[0].src=f;d[0].src=e}c.show()}},data_attr:function(b){return 0<this.namespace.length?this.namespace+"-"+b:b},cache_offset:function(b){var c=b.show().height()+parseInt(b.css("top"),10)+b.scrollY;b.hide();return c},off:function(){b(this.scope).off(".fndtn.reveal")},reflow:function(){}}})(jQuery,window,window.document);(function(b,d,c,f){Foundation.libs.abide={name:"abide",version:"5.5.3",settings:{live_validate:!0,validate_on_blur:!0,focus_on_invalid:!0,error_labels:!0,error_class:"error",timeout:1E3,patterns:{alpha:/^[a-zA-Z]+$/,alpha_numeric:/^[a-zA-Z0-9]+$/,integer:/^[-+]?\d+$/,number:/^[-+]?\d*(?:[\.\,]\d+)?$/,card:/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11})$/,cvv:/^([0-9]){3,4}$/,email:/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+$/,
url:/^(https?|ftp|file|ssh):\/\/([-;:&=\+\$,\w]+@{1})?([-A-Za-z0-9\.]+)+:?(\d+)?((\/[-\+~%\/\.\w]+)?\??([-\+=&;%@\.\w]+)?#?([\w]+)?)?/,domain:/^([a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,8}$/,datetime:/^([0-2][0-9]{3})\-([0-1][0-9])\-([0-3][0-9])T([0-5][0-9])\:([0-5][0-9])\:([0-5][0-9])(Z|([\-\+]([0-1][0-9])\:00))$/,date:/(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])-(?:30))|(?:(?:0[13578]|1[02])-31))$/,time:/^(0[0-9]|1[0-9]|2[0-3])(:[0-5][0-9]){2}$/,
dateISO:/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/,month_day_year:/^(0[1-9]|1[012])[- \/.](0[1-9]|[12][0-9]|3[01])[- \/.]\d{4}$/,day_month_year:/^(0[1-9]|[12][0-9]|3[01])[- \/.](0[1-9]|1[012])[- \/.]\d{4}$/,color:/^#?([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/},validators:{equalTo:function(b,d,f){return c.getElementById(b.getAttribute(this.add_namespace("data-equalto"))).value===b.value}}},timer:null,init:function(b,c,d){this.bindings(c,d)},events:function(c){function d(b,c){clearTimeout(f.timer);f.timer=setTimeout(function(){f.validate([b],
c)}.bind(b),m.timeout)}var f=this,l=f.S(c).attr("novalidate","novalidate"),m=l.data(this.attr_name(!0)+"-init")||{};this.invalid_attr=this.add_namespace("data-invalid");l.off(".abide").on("submit.fndtn.abide",function(b){var c=/ajax/i.test(f.S(this).attr(f.attr_name()));return f.validate(f.S(this).find("input, textarea, select").not(":hidden, [data-abide-ignore]").get(),b,c)}).on("validate.fndtn.abide",function(b){"manual"===m.validate_on&&f.validate([b.target],b)}).on("reset",function(c){return f.reset(b(this),
c)}).find("input, textarea, select").not(":hidden, [data-abide-ignore]").off(".abide").on("blur.fndtn.abide change.fndtn.abide",function(b){var c=this.getAttribute("id"),c=l.find('[data-equalto="'+c+'"]');m.validate_on_blur&&!0===m.validate_on_blur&&d(this,b);"undefined"!==typeof c.get(0)&&c.val().length&&d(c.get(0),b);"change"===m.validate_on&&d(this,b)}).on("keydown.fndtn.abide",function(b){var c=this.getAttribute("id"),c=l.find('[data-equalto="'+c+'"]');m.live_validate&&!0===m.live_validate&&9!=
b.which&&d(this,b);"undefined"!==typeof c.get(0)&&c.val().length&&d(c.get(0),b);"tab"===m.validate_on&&9===b.which?d(this,b):"change"===m.validate_on&&d(this,b)}).on("focus",function(c){navigator.userAgent.match(/iPad|iPhone|Android|BlackBerry|Windows Phone|webOS/i)&&b("html, body").animate({scrollTop:b(c.target).offset().top},100)})},reset:function(c,d){c.removeAttr(this.invalid_attr);b("["+this.invalid_attr+"]",c).removeAttr(this.invalid_attr);b("."+this.settings.error_class,c).not("small").removeClass(this.settings.error_class);
b(":input",c).not(":button, :submit, :reset, :hidden, [data-abide-ignore]").val("").removeAttr(this.invalid_attr)},validate:function(b,c,d){var f=this.parse_patterns(b),m=f.length,q=this.S(b[0]).closest("form");c=/submit/.test(c.type);for(var r=0;r<m;r++)if(!f[r]&&(c||d))return this.settings.focus_on_invalid&&b[r].focus(),q.trigger("invalid.fndtn.abide"),this.S(b[r]).closest("form").attr(this.invalid_attr,""),!1;(c||d)&&q.trigger("valid.fndtn.abide");q.removeAttr(this.invalid_attr);return d?!1:!0},
parse_patterns:function(b){for(var c=b.length,d=[];c--;)d.push(this.pattern(b[c]));return this.check_validation_and_apply_styles(d)},pattern:function(b){var c=b.getAttribute("type"),d="string"===typeof b.getAttribute("required"),f=b.getAttribute("pattern")||"";if(this.settings.patterns.hasOwnProperty(f)&&0<f.length)return[b,this.settings.patterns[f],d];if(0<f.length)return[b,new RegExp(f),d];if(this.settings.patterns.hasOwnProperty(c))return[b,this.settings.patterns[c],d];f=/.*/;return[b,f,d]},check_validation_and_apply_styles:function(c){var d=
c.length,f=[];if(0==d)return f;for(this.S(c[0][0]).closest("[data-"+this.attr_name(!0)+"]").data(this.attr_name(!0)+"-init");d--;){var l=c[d][0],m=c[d][2],q=l.value.trim(),r=this.S(l).parent(),p=l.getAttribute(this.add_namespace("data-abide-validator")),t="radio"===l.type,s="checkbox"===l.type,u=this.S('label[for="'+l.getAttribute("id")+'"]'),w=m?0<l.value.length:!0,A=[];l.getAttribute(this.add_namespace("data-equalto"))&&(p="equalTo");r=r.is("label")?r.parent():r;if(t&&m)A.push(this.valid_radio(l,
m));else if(s&&m)A.push(this.valid_checkbox(l,m));else if(p){p=p.split(" ");s=t=!0;for(w=0;w<p.length;w++)q=this.settings.validators[p[w]].apply(this,[l,m,r]),A.push(q),s=q&&t,t=q;s?(this.S(l).removeAttr(this.invalid_attr),r.removeClass("error"),0<u.length&&this.settings.error_labels&&u.removeClass(this.settings.error_class).removeAttr("role"),b(l).triggerHandler("valid")):(this.S(l).attr(this.invalid_attr,""),r.addClass("error"),0<u.length&&this.settings.error_labels&&u.addClass(this.settings.error_class).attr("role",
"alert"),b(l).triggerHandler("invalid"))}else c[d][1].test(q)&&w||!m&&1>l.value.length||b(l).attr("disabled")?A.push(!0):A.push(!1),A=[A.every(function(b){return b})],A[0]?(this.S(l).removeAttr(this.invalid_attr),l.setAttribute("aria-invalid","false"),l.removeAttribute("aria-describedby"),r.removeClass(this.settings.error_class),0<u.length&&this.settings.error_labels&&u.removeClass(this.settings.error_class).removeAttr("role"),b(l).triggerHandler("valid")):(this.S(l).attr(this.invalid_attr,""),l.setAttribute("aria-invalid",
"true"),m=r.find("small."+this.settings.error_class,"span."+this.settings.error_class),m=0<m.length?m[0].id:"",0<m.length&&l.setAttribute("aria-describedby",m),r.addClass(this.settings.error_class),0<u.length&&this.settings.error_labels&&u.addClass(this.settings.error_class).attr("role","alert"),b(l).triggerHandler("invalid"));f=f.concat(A)}return f},valid_checkbox:function(c,d){c=this.S(c);var f=c.is(":checked")||!d||c.get(0).getAttribute("disabled");f?(c.removeAttr(this.invalid_attr).parent().removeClass(this.settings.error_class),
b(c).triggerHandler("valid")):(c.attr(this.invalid_attr,"").parent().addClass(this.settings.error_class),b(c).triggerHandler("invalid"));return f},valid_radio:function(c,d){for(var f=c.getAttribute("name"),f=this.S(c).closest("[data-"+this.attr_name(!0)+"]").find("[name='"+f+"']"),l=f.length,m=!1,q=!1,r=0;r<l;r++)f[r].getAttribute("disabled")?m=q=!0:f[r].checked?m=!0:q&&(m=!1);for(r=0;r<l;r++)m?(this.S(f[r]).removeAttr(this.invalid_attr).parent().removeClass(this.settings.error_class),b(f[r]).triggerHandler("valid")):
(this.S(f[r]).attr(this.invalid_attr,"").parent().addClass(this.settings.error_class),b(f[r]).triggerHandler("invalid"));return m},valid_equal:function(b,d,f){(d=c.getElementById(b.getAttribute(this.add_namespace("data-equalto"))).value===b.value)?(this.S(b).removeAttr(this.invalid_attr),f.removeClass(this.settings.error_class),0<label.length&&settings.error_labels&&label.removeClass(this.settings.error_class)):(this.S(b).attr(this.invalid_attr,""),f.addClass(this.settings.error_class),0<label.length&&
settings.error_labels&&label.addClass(this.settings.error_class));return d},valid_oneof:function(b,c,d,f){b=this.S(b);c=this.S("["+this.add_namespace("data-oneof")+"]");(d=0<c.filter(":checked").length)?b.removeAttr(this.invalid_attr).parent().removeClass(this.settings.error_class):b.attr(this.invalid_attr,"").parent().addClass(this.settings.error_class);if(!f){var m=this;c.each(function(){m.valid_oneof.call(m,this,null,null,!0)})}return d},reflow:function(b,c){var d=this,f=d.S("["+this.attr_name()+
"]").attr("novalidate","novalidate");d.S(f).each(function(b,c){d.events(c)})}}})(jQuery,window,window.document);(function(b,d,c,f){Foundation.libs.equalizer={name:"equalizer",version:"5.5.3",settings:{use_tallest:!0,before_height_change:b.noop,after_height_change:b.noop,equalize_on_stack:!1,act_on_hidden_el:!1},init:function(b,c,d){Foundation.inherit(this,"image_loaded");this.bindings(c,d);this.reflow()},events:function(){this.S(d).off(".equalizer").on("resize.fndtn.equalizer",function(b){this.reflow()}.bind(this))},equalize:function(c){var d=!1,f=c.data("equalizer"),l=c.data(this.attr_name(!0)+"-init")||this.settings,
m,f=l.act_on_hidden_el?f?c.find("["+this.attr_name()+'-watch="'+f+'"]'):c.find("["+this.attr_name()+"-watch]"):f?c.find("["+this.attr_name()+'-watch="'+f+'"]:visible'):c.find("["+this.attr_name()+"-watch]:visible");if(0!==f.length){l.before_height_change();c.trigger("before-height-change.fndth.equalizer");f.height("inherit");if(!1===l.equalize_on_stack&&(m=f.first().offset().top,f.each(function(){if(b(this).offset().top!==m)return d=!0,!1}),d))return;var q=f.map(function(){return b(this).outerHeight(!1)}).get(),
q=l.use_tallest?Math.max.apply(null,q):Math.min.apply(null,q);f.css("height",q);l.after_height_change();c.trigger("after-height-change.fndtn.equalizer")}},reflow:function(){var c=this;this.S("["+this.attr_name()+"]",this.scope).each(function(){var d=b(this),f=d.data("equalizer-mq"),l=!0;f&&(f="is_"+f.replace(/-/g,"_"),Foundation.utils.hasOwnProperty(f)&&(l=!1));c.image_loaded(c.S("img",this),function(){l||Foundation.utils[f]()?c.equalize(d):d.find("["+c.attr_name()+"-watch]:visible").css("height",
"auto")})})}}})(jQuery,window,window.document);!function(b){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=b();else if("function"==typeof define&&define.amd)define([],b);else{var d;"undefined"!=typeof window?d=window:"undefined"!=typeof global?d=global:"undefined"!=typeof self&&(d=self);d.SockJS=b()}}(function(){return function d(c,f,e){function g(l,q){if(!f[l]){if(!c[l]){var r="function"==typeof require&&require;if(!q&&r)return r(l,!0);if(h)return h(l,!0);r=Error("Cannot find module '"+l+"'");throw r.code="MODULE_NOT_FOUND",
r;}r=f[l]={exports:{}};c[l][0].call(r.exports,function(d){var e=c[l][1][d];return g(e?e:d)},r,r.exports,d,c,f,e)}return f[l].exports}for(var h="function"==typeof require&&require,l=0;l<e.length;l++)g(e[l]);return g}({1:[function(d,c){var f="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e=d("./transport-list");c.exports=d("./main")(e);"_sockjs_onload"in f&&setTimeout(f._sockjs_onload,1)},{"./main":14,"./transport-list":16}],2:[function(d,c){function f(){g.call(this);
this.initEvent("close",!1,!1);this.wasClean=!1;this.code=0;this.reason=""}var e=d("inherits"),g=d("./event");e(f,g);c.exports=f},{"./event":4,inherits:54}],3:[function(d,c){function f(){g.call(this)}var e=d("inherits"),g=d("./eventtarget");e(f,g);f.prototype.removeAllListeners=function(c){c?delete this._listeners[c]:this._listeners={}};f.prototype.once=function(c,d){function e(){f.removeListener(c,e);g||(g=!0,d.apply(this,arguments))}var f=this,g=!1;this.on(c,e)};f.prototype.emit=function(){var c=
this._listeners[arguments[0]];if(c){for(var d=arguments.length,e=Array(d-1),f=1;d>f;f++)e[f-1]=arguments[f];for(d=0;d<c.length;d++)c[d].apply(this,e)}};f.prototype.on=f.prototype.addListener=g.prototype.addEventListener;f.prototype.removeListener=g.prototype.removeEventListener;c.exports.EventEmitter=f},{"./eventtarget":5,inherits:54}],4:[function(d,c){function f(c){this.type=c}f.prototype.initEvent=function(c,d,f){return this.type=c,this.bubbles=d,this.cancelable=f,this.timeStamp=+new Date,this};
f.prototype.stopPropagation=function(){};f.prototype.preventDefault=function(){};f.CAPTURING_PHASE=1;f.AT_TARGET=2;f.BUBBLING_PHASE=3;c.exports=f},{}],5:[function(d,c){function f(){this._listeners={}}f.prototype.addEventListener=function(c,d){c in this._listeners||(this._listeners[c]=[]);var f=this._listeners[c];-1===f.indexOf(d)&&(f=f.concat([d]));this._listeners[c]=f};f.prototype.removeEventListener=function(c,d){var f=this._listeners[c];if(f){var l=f.indexOf(d);return-1!==l?void(1<f.length?this._listeners[c]=
f.slice(0,l).concat(f.slice(l+1)):delete this._listeners[c]):void 0}};f.prototype.dispatchEvent=function(){var c=arguments[0],d=c.type,c=1===arguments.length?[c]:Array.apply(null,arguments);if(this["on"+d]&&this["on"+d].apply(this,c),d in this._listeners)for(var d=this._listeners[d],f=0;f<d.length;f++)d[f].apply(this,c)};c.exports=f},{}],6:[function(d,c){function f(c){g.call(this);this.initEvent("message",!1,!1);this.data=c}var e=d("inherits"),g=d("./event");e(f,g);c.exports=f},{"./event":4,inherits:54}],
7:[function(d,c){function f(c){this._transport=c;c.on("message",this._transportMessage.bind(this));c.on("close",this._transportClose.bind(this))}var e=d("json3"),g=d("./utils/iframe");f.prototype._transportClose=function(c,d){g.postMessage("c",e.stringify([c,d]))};f.prototype._transportMessage=function(c){g.postMessage("t",c)};f.prototype._send=function(c){this._transport.send(c)};f.prototype._close=function(){this._transport.close();this._transport.removeAllListeners()};c.exports=f},{"./utils/iframe":47,
json3:55}],8:[function(d,c){var f=d("./utils/url"),e=d("./utils/event"),g=d("json3"),h=d("./facade"),l=d("./info-iframe-receiver"),m=d("./utils/iframe"),q=d("./location");c.exports=function(c,d){var t={};d.forEach(function(c){c.facadeTransport&&(t[c.facadeTransport.transportName]=c.facadeTransport)});t[l.transportName]=l;var s;c.bootstrap_iframe=function(){var d;m.currentWindowId=q.hash.slice(1);e.attachEvent("message",function(e){if(e.source===parent&&("undefined"==typeof s&&(s=e.origin),e.origin===
s)){var l;try{l=g.parse(e.data)}catch(p){return}if(l.windowId===m.currentWindowId)switch(l.type){case "s":var H;try{H=g.parse(l.data)}catch(y){break}e=H[0];l=H[1];var F=H[2];H=H[3];if(e!==c.version)throw Error('Incompatible SockJS! Main site uses: "'+e+'", the iframe: "'+c.version+'".');if(!f.isOriginEqual(F,q.href)||!f.isOriginEqual(H,q.href))throw Error("Can't connect to different domain from within an iframe. ("+q.href+", "+F+", "+H+")");d=new h(new t[l](F,H));break;case "m":d._send(l.data);break;
case "c":d&&d._close(),d=null}}});m.postMessage("s")}}},{"./facade":7,"./info-iframe-receiver":10,"./location":13,"./utils/event":46,"./utils/iframe":47,"./utils/url":52,debug:void 0,json3:55}],9:[function(d,c){function f(c,d){e.call(this);var f=this,g=+new Date;this.xo=new d("GET",c);this.xo.once("finish",function(c,d){var e,m;if(200===c){if(m=+new Date-g,d)try{e=h.parse(d)}catch(q){}l.isObject(e)||(e={})}f.emit("finish",e,m);f.removeAllListeners()})}var e=d("events").EventEmitter,g=d("inherits"),
h=d("json3"),l=d("./utils/object");g(f,e);f.prototype.close=function(){this.removeAllListeners();this.xo.close()};c.exports=f},{"./utils/object":49,debug:void 0,events:3,inherits:54,json3:55}],10:[function(d,c){function f(c){var d=this;g.call(this);this.ir=new m(c,l);this.ir.once("finish",function(c,e){d.ir=null;d.emit("message",h.stringify([c,e]))})}var e=d("inherits"),g=d("events").EventEmitter,h=d("json3"),l=d("./transport/sender/xhr-local"),m=d("./info-ajax");e(f,g);f.transportName="iframe-info-receiver";
f.prototype.close=function(){this.ir&&(this.ir.close(),this.ir=null);this.removeAllListeners()};c.exports=f},{"./info-ajax":9,"./transport/sender/xhr-local":37,events:3,inherits:54,json3:55}],11:[function(d,c){(function(f){function e(c,d){var e=this;g.call(this);var h=function(){var f=e.ifr=new q(r.transportName,d,c);f.once("message",function(c){if(c){var d;try{d=l.parse(c)}catch(f){return e.emit("finish"),void e.close()}e.emit("finish",d[0],d[1])}e.close()});f.once("close",function(){e.emit("finish");
e.close()})};f.document.body?h():m.attachEvent("load",h)}var g=d("events").EventEmitter,h=d("inherits"),l=d("json3"),m=d("./utils/event"),q=d("./transport/iframe"),r=d("./info-iframe-receiver");h(e,g);e.enabled=function(){return q.enabled()};e.prototype.close=function(){this.ifr&&this.ifr.close();this.removeAllListeners();this.ifr=null};c.exports=e}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./info-iframe-receiver":10,"./transport/iframe":22,
"./utils/event":46,debug:void 0,events:3,inherits:54,json3:55}],12:[function(d,c){function f(c,d){var f=this;e.call(this);setTimeout(function(){f.doXhr(c,d)},0)}var e=d("events").EventEmitter,g=d("inherits"),h=d("./utils/url"),l=d("./transport/sender/xdr"),m=d("./transport/sender/xhr-cors"),q=d("./transport/sender/xhr-local"),r=d("./transport/sender/xhr-fake"),p=d("./info-iframe"),t=d("./info-ajax");g(f,e);f._getReceiver=function(c,d,e){return e.sameOrigin?new t(d,q):m.enabled?new t(d,m):l.enabled&&
e.sameScheme?new t(d,l):p.enabled()?new p(c,d):new t(d,r)};f.prototype.doXhr=function(c,d){var e=this,g=h.addPath(c,"/info");this.xo=f._getReceiver(c,g,d);this.timeoutRef=setTimeout(function(){e._cleanup(!1);e.emit("finish")},f.timeout);this.xo.once("finish",function(c,d){e._cleanup(!0);e.emit("finish",c,d)})};f.prototype._cleanup=function(c){clearTimeout(this.timeoutRef);this.timeoutRef=null;!c&&this.xo&&this.xo.close();this.xo=null};f.prototype.close=function(){this.removeAllListeners();this._cleanup(!1)};
f.timeout=8E3;c.exports=f},{"./info-ajax":9,"./info-iframe":11,"./transport/sender/xdr":34,"./transport/sender/xhr-cors":35,"./transport/sender/xhr-fake":36,"./transport/sender/xhr-local":37,"./utils/url":52,debug:void 0,events:3,inherits:54}],13:[function(d,c){c.exports=("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}).location||{origin:"http://localhost:80",protocol:"http",host:"localhost",port:80,href:"http://localhost/",hash:""}},{}],14:[function(d,
c){(function(f){function e(c,d,f){if(!(this instanceof e))return new e(c,d,f);if(1>arguments.length)throw new TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present");H.call(this);this.readyState=e.CONNECTING;this.protocol=this.extensions="";f=f||{};f.protocols_whitelist&&A.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead.");this._transportsWhitelist=f.transports;this._transportOptions=f.transportOptions||{};var g=f.sessionId||8;if("function"==typeof g)this._generateSessionId=
g;else{if("number"!=typeof g)throw new TypeError("If sessionId is used in the options, it needs to be a number or a function.");this._generateSessionId=function(){return q.string(g)}}this._server=f.server||q.numberString(1E3);var l=new h(c);if(!l.host||!l.protocol)throw new SyntaxError("The URL '"+c+"' is invalid");if(l.hash)throw new SyntaxError("The URL must not contain a fragment");if("http:"!==l.protocol&&"https:"!==l.protocol)throw new SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+
l.protocol+"' is not allowed.");var m="https:"===l.protocol;if("https"===y.protocol&&!m)throw Error("SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS");d?Array.isArray(d)||(d=[d]):d=[];var r=d.sort();r.forEach(function(c,d){if(!c)throw new SyntaxError("The protocols entry '"+c+"' is invalid.");if(d<r.length-1&&c===r[d+1])throw new SyntaxError("The protocols entry '"+c+"' is duplicated.");});this._origin=(m=p.getOrigin(y.href))?m.toLowerCase():null;l.set("pathname",
l.pathname.replace(/\/+$/,""));this.url=l.href;this._urlInfo={nullOrigin:!w.hasDomain(),sameOrigin:p.isOriginEqual(this.url,y.href),sameScheme:p.isSchemeEqual(this.url,y.href)};this._ir=new ca(this.url,this._urlInfo);this._ir.once("finish",this._receiveInfo.bind(this))}d("./shims");var g,h=d("url-parse"),l=d("inherits"),m=d("json3"),q=d("./utils/random"),r=d("./utils/escape"),p=d("./utils/url"),t=d("./utils/event"),s=d("./utils/transport"),u=d("./utils/object"),w=d("./utils/browser"),A=d("./utils/log"),
n=d("./event/event"),H=d("./event/eventtarget"),y=d("./location"),F=d("./event/close"),W=d("./event/trans-message"),ca=d("./info-receiver");l(e,H);e.prototype.close=function(c,d){if(c&&!(1E3===c||3E3<=c&&4999>=c))throw Error("InvalidAccessError: Invalid code");if(d&&123<d.length)throw new SyntaxError("reason argument has an invalid length");this.readyState!==e.CLOSING&&this.readyState!==e.CLOSED&&this._close(c||1E3,d||"Normal closure",!0)};e.prototype.send=function(c){if("string"!=typeof c&&(c=""+
c),this.readyState===e.CONNECTING)throw Error("InvalidStateError: The connection has not been established yet");this.readyState===e.OPEN&&this._transport.send(r.quote(c))};e.version=d("./version");e.CONNECTING=0;e.OPEN=1;e.CLOSING=2;e.CLOSED=3;e.prototype._receiveInfo=function(c,d){if(this._ir=null,!c)return void this._close(1002,"Cannot connect to server");this._rto=this.countRTO(d);this._transUrl=c.base_url?c.base_url:this.url;c=u.extend(c,this._urlInfo);this._transports=g.filterToEnabled(this._transportsWhitelist,
c).main;this._connect()};e.prototype._connect=function(){for(var c=this._transports.shift();c;){if(c.needBody&&(!f.document.body||"undefined"!=typeof f.document.readyState&&"complete"!==f.document.readyState&&"interactive"!==f.document.readyState))return this._transports.unshift(c),void t.attachEvent("load",this._connect.bind(this));var d=this._rto*c.roundTrips||5E3;this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),d);d=p.addPath(this._transUrl,"/"+this._server+"/"+this._generateSessionId());
d=new c(d,this._transUrl,this._transportOptions[c.transportName]);return d.on("message",this._transportMessage.bind(this)),d.once("close",this._transportClose.bind(this)),d.transportName=c.transportName,void(this._transport=d)}this._close(2E3,"All transports failed",!1)};e.prototype._transportTimeout=function(){this.readyState===e.CONNECTING&&this._transportClose(2007,"Transport timed out")};e.prototype._transportMessage=function(c){var d,e=this,f=c.slice(0,1);c=c.slice(1);switch(f){case "o":return void this._open();
case "h":return void this.dispatchEvent(new n("heartbeat"))}if(c)try{d=m.parse(c)}catch(g){}if("undefined"!=typeof d)switch(f){case "a":Array.isArray(d)&&d.forEach(function(c){e.dispatchEvent(new W(c))});break;case "m":this.dispatchEvent(new W(d));break;case "c":Array.isArray(d)&&2===d.length&&this._close(d[0],d[1],!0)}};e.prototype._transportClose=function(c,d){return this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),1E3===c||3E3<=c&&4999>=c||2E3===
c||this.readyState!==e.CONNECTING?void this._close(c,d):void this._connect()};e.prototype._open=function(){this.readyState===e.CONNECTING?(this._transportTimeoutId&&(clearTimeout(this._transportTimeoutId),this._transportTimeoutId=null),this.readyState=e.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new n("open"))):this._close(1006,"Server lost session")};e.prototype._close=function(c,d,f){var g=!1;if(this._ir&&(g=!0,this._ir.close(),this._ir=null),this._transport&&(this._transport.close(),
this._transport=null,this.transport=null),this.readyState===e.CLOSED)throw Error("InvalidStateError: SockJS has already been closed");this.readyState=e.CLOSING;setTimeout(function(){this.readyState=e.CLOSED;g&&this.dispatchEvent(new n("error"));var h=new F("close");h.wasClean=f||!1;h.code=c||1E3;h.reason=d;this.dispatchEvent(h);this.onmessage=this.onclose=this.onerror=null}.bind(this),0)};e.prototype.countRTO=function(c){return 100<c?4*c:300+c};c.exports=function(c){return g=s(c),d("./iframe-bootstrap")(e,
c),e}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./event/close":2,"./event/event":4,"./event/eventtarget":5,"./event/trans-message":6,"./iframe-bootstrap":8,"./info-receiver":12,"./location":13,"./shims":15,"./utils/browser":44,"./utils/escape":45,"./utils/event":46,"./utils/log":48,"./utils/object":49,"./utils/random":50,"./utils/transport":51,"./utils/url":52,"./version":53,debug:void 0,inherits:54,json3:55,"url-parse":56}],
15:[function(){function d(){}var c,f=Array.prototype,e=Object.prototype,g=Function.prototype,h=String.prototype,l=f.slice,m=e.toString,q;if(q=Object.defineProperty)try{q=(Object.defineProperty({},"x",{}),!0)}catch(r){q=!1}c=q?function(c,d,e,f){!f&&d in c||Object.defineProperty(c,d,{configurable:!0,enumerable:!1,writable:!0,value:e})}:function(c,d,e,f){!f&&d in c||(c[d]=e)};q=function(d,f,g){for(var h in f)e.hasOwnProperty.call(f,h)&&c(d,h,f[h],g)};var p=function(c){if(null==c)throw new TypeError("can't convert "+
c+" to object");return Object(c)};q(g,{bind:function(c){var f=this;if("[object Function]"!==e.toString.call(f))throw new TypeError("Function.prototype.bind called on incompatible "+f);for(var g=l.call(arguments,1),h=Math.max(0,f.length-g.length),m=[],q=0;h>q;q++)m.push("$"+q);var p=Function("binder","return function ("+m.join(",")+"){ return binder.apply(this, arguments); }")(function(){if(this instanceof p){var d=f.apply(this,g.concat(l.call(arguments)));return Object(d)===d?d:this}return f.apply(c,
g.concat(l.call(arguments)))});return f.prototype&&(d.prototype=f.prototype,p.prototype=new d,d.prototype=null),p}});q(Array,{isArray:function(c){return"[object Array]"===m.call(c)}});var g=Object("a"),t="a"!==g[0]||!(0 in g);q(f,{forEach:function(c,d){var f=p(this),g=t&&"[object String]"===m.call(this)?this.split(""):f,h=-1,l=g.length>>>0;if("[object Function]"!==e.toString.call(c))throw new TypeError;for(;++h<l;)h in g&&c.call(d,g[h],h,f)}},!function(c){var d=!0,e=!0;return c&&(c.call("foo",function(c,
e,f){"object"!=typeof f&&(d=!1)}),c.call([1],function(){e="string"==typeof this},"x")),!!c&&d&&e}(f.forEach));g=Array.prototype.indexOf&&-1!==[0,1].indexOf(1,2);q(f,{indexOf:function(c){var d=t&&"[object String]"===m.call(this)?this.split(""):p(this),e=d.length>>>0;if(!e)return-1;var f=0;if(1<arguments.length)var g=+arguments[1],f=(g!==g?g=0:0!==g&&g!==1/0&&g!==-(1/0)&&(g=(0<g||-1)*Math.floor(Math.abs(g))),g);for(f=0<=f?f:Math.max(0,e+f);e>f;f++)if(f in d&&d[f]===c)return f;return-1}},g);var s=h.split;
2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||1<".".split(/()()/).length?!function(){var c=void 0===/()??/.exec("")[1];h.split=function(d,e){var g=this;if(void 0===d&&0===e)return[];if("[object RegExp]"!==m.call(d))return s.call(this,d,e);var h,l,q,p,r=[],t=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.extended?"x":"")+(d.sticky?"y":""),u=0;d=new RegExp(d.source,t+"g");g+="";c||(h=new RegExp("^"+
d.source+"$(?!\\s)",t));for(e=void 0===e?4294967295:e>>>0;(l=d.exec(g))&&(q=l.index+l[0].length,!(q>u&&(r.push(g.slice(u,l.index)),!c&&1<l.length&&l[0].replace(h,function(){for(var c=1;c<arguments.length-2;c++)void 0===arguments[c]&&(l[c]=void 0)}),1<l.length&&l.index<g.length&&f.push.apply(r,l.slice(1)),p=l[0].length,u=q,r.length>=e)));)d.lastIndex===l.index&&d.lastIndex++;return u===g.length?(p||!d.test(""))&&r.push(""):r.push(g.slice(u)),r.length>e?r.slice(0,e):r}}():"0".split(void 0,0).length&&
(h.split=function(c,d){return void 0===c&&0===d?[]:s.call(this,c,d)});var u=/^[ \n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][ \n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*/,w=/[ \n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][ \n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*$/,
g=h.trim&&(" \n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff".trim()||!"\u200b".trim());q(h,{trim:function(){if(void 0===this||null===this)throw new TypeError("can't convert "+this+" to object");return String(this).replace(u,"").replace(w,"")}},g);var A=h.substr,g="".substr&&"b"!=="0b".substr(-1);q(h,{substr:function(c,d){return A.call(this,0>c&&0>(c=this.length+c)?0:c,d)}},g)},{}],16:[function(d,c){c.exports=[d("./transport/websocket"),
d("./transport/xhr-streaming"),d("./transport/xdr-streaming"),d("./transport/eventsource"),d("./transport/lib/iframe-wrap")(d("./transport/eventsource")),d("./transport/htmlfile"),d("./transport/lib/iframe-wrap")(d("./transport/htmlfile")),d("./transport/xhr-polling"),d("./transport/xdr-polling"),d("./transport/lib/iframe-wrap")(d("./transport/xhr-polling")),d("./transport/jsonp-polling")]},{"./transport/eventsource":20,"./transport/htmlfile":21,"./transport/jsonp-polling":23,"./transport/lib/iframe-wrap":26,
"./transport/websocket":38,"./transport/xdr-polling":39,"./transport/xdr-streaming":40,"./transport/xhr-polling":41,"./transport/xhr-streaming":42}],17:[function(d,c){(function(f){function e(c,d,e,f){var h=this;g.call(this);setTimeout(function(){h._start(c,d,e,f)},0)}var g=d("events").EventEmitter,h=d("inherits"),l=d("../../utils/event"),m=d("../../utils/url"),q=f.XMLHttpRequest;h(e,g);e.prototype._start=function(c,d,f,g){var h=this;try{this.xhr=new q}catch(p){}if(!this.xhr)return this.emit("finish",
0,"no xhr support"),void this._cleanup();d=m.addQuery(d,"t="+ +new Date);this.unloadRef=l.unloadAdd(function(){h._cleanup(!0)});try{this.xhr.open(c,d,!0),this.timeout&&"timeout"in this.xhr&&(this.xhr.timeout=this.timeout,this.xhr.ontimeout=function(){h.emit("finish",0,"");h._cleanup(!1)})}catch(r){return this.emit("finish",0,""),void this._cleanup(!1)}if(g&&g.noCredentials||!e.supportsCORS||(this.xhr.withCredentials="true"),g&&g.headers)for(var y in g.headers)this.xhr.setRequestHeader(y,g.headers[y]);
this.xhr.onreadystatechange=function(){if(h.xhr){var c,d,e=h.xhr;switch(e.readyState){case 3:try{d=e.status,c=e.responseText}catch(f){}1223===d&&(d=204);200===d&&c&&0<c.length&&h.emit("chunk",d,c);break;case 4:d=e.status,1223===d&&(d=204),12005!==d&&12029!==d||(d=0),h.emit("finish",d,e.responseText),h._cleanup(!1)}}};try{h.xhr.send(f)}catch(F){h.emit("finish",0,""),h._cleanup(!1)}};e.prototype._cleanup=function(c){if(this.xhr){if(this.removeAllListeners(),l.unloadDel(this.unloadRef),this.xhr.onreadystatechange=
function(){},this.xhr.ontimeout&&(this.xhr.ontimeout=null),c)try{this.xhr.abort()}catch(d){}this.unloadRef=this.xhr=null}};e.prototype.close=function(){this._cleanup(!0)};e.enabled=!!q;var r=["Active"].concat("Object").join("X");!e.enabled&&r in f&&(q=function(){try{return new f[r]("Microsoft.XMLHTTP")}catch(c){return null}},e.enabled=!!new q);h=!1;try{h="withCredentials"in new q}catch(p){}e.supportsCORS=h;c.exports=e}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=
typeof window?window:{})},{"../../utils/event":46,"../../utils/url":52,debug:void 0,events:3,inherits:54}],18:[function(d,c){c.exports=("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}).EventSource},{}],19:[function(d,c){var f="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};c.exports=f.WebSocket||f.MozWebSocket},{}],20:[function(d,c){function f(c){if(!f.enabled())throw Error("Transport created when disabled");
g.call(this,c,"/eventsource",h,l)}var e=d("inherits"),g=d("./lib/ajax-based"),h=d("./receiver/eventsource"),l=d("./sender/xhr-cors"),m=d("eventsource");e(f,g);f.enabled=function(){return!!m};f.transportName="eventsource";f.roundTrips=2;c.exports=f},{"./lib/ajax-based":24,"./receiver/eventsource":29,"./sender/xhr-cors":35,eventsource:18,inherits:54}],21:[function(d,c){function f(c){if(!g.enabled)throw Error("Transport created when disabled");l.call(this,c,"/htmlfile",g,h)}var e=d("inherits"),g=d("./receiver/htmlfile"),
h=d("./sender/xhr-local"),l=d("./lib/ajax-based");e(f,l);f.enabled=function(c){return g.enabled&&c.sameOrigin};f.transportName="htmlfile";f.roundTrips=2;c.exports=f},{"./lib/ajax-based":24,"./receiver/htmlfile":30,"./sender/xhr-local":37,inherits:54}],22:[function(d,c){function f(c,d,e){if(!f.enabled())throw Error("Transport created when disabled");h.call(this);var g=this;this.origin=m.getOrigin(e);this.baseUrl=e;this.transUrl=d;this.transport=c;this.windowId=p.string(8);c=m.addPath(e,"/iframe.html")+
"#"+this.windowId;this.iframeObj=q.createIframe(c,function(c){g.emit("close",1006,"Unable to load an iframe ("+c+")");g.close()});this.onmessageCallback=this._message.bind(this);r.attachEvent("message",this.onmessageCallback)}var e=d("inherits"),g=d("json3"),h=d("events").EventEmitter,l=d("../version"),m=d("../utils/url"),q=d("../utils/iframe"),r=d("../utils/event"),p=d("../utils/random");e(f,h);f.prototype.close=function(){if(this.removeAllListeners(),this.iframeObj){r.detachEvent("message",this.onmessageCallback);
try{this.postMessage("c")}catch(c){}this.iframeObj.cleanup();this.onmessageCallback=this.iframeObj=this.iframeObj=null}};f.prototype._message=function(c){if(m.isOriginEqual(c.origin,this.origin)){var d;try{d=g.parse(c.data)}catch(e){return}if(d.windowId===this.windowId)switch(d.type){case "s":this.iframeObj.loaded();this.postMessage("s",g.stringify([l,this.transport,this.transUrl,this.baseUrl]));break;case "t":this.emit("message",d.data);break;case "c":var f;try{f=g.parse(d.data)}catch(h){break}this.emit("close",
f[0],f[1]);this.close()}}};f.prototype.postMessage=function(c,d){this.iframeObj.post(g.stringify({windowId:this.windowId,type:c,data:d||""}),this.origin)};f.prototype.send=function(c){this.postMessage("m",c)};f.enabled=function(){return q.iframeEnabled};f.transportName="iframe";f.roundTrips=2;c.exports=f},{"../utils/event":46,"../utils/iframe":47,"../utils/random":50,"../utils/url":52,"../version":53,debug:void 0,events:3,inherits:54,json3:55}],23:[function(d,c){(function(f){function e(c){if(!e.enabled())throw Error("Transport created when disabled");
h.call(this,c,"/jsonp",m,l)}var g=d("inherits"),h=d("./lib/sender-receiver"),l=d("./receiver/jsonp"),m=d("./sender/jsonp");g(e,h);e.enabled=function(){return!!f.document};e.transportName="jsonp-polling";e.roundTrips=1;e.needBody=!0;c.exports=e}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/sender-receiver":28,"./receiver/jsonp":31,"./sender/jsonp":33,inherits:54}],24:[function(d,c){function f(c){return function(d,e,f){var g=
{};"string"==typeof e&&(g.headers={"Content-type":"text/plain"});d=h.addPath(d,"/xhr_send");var l=new c("POST",d,e,g);return l.once("finish",function(c){return l=null,200!==c&&204!==c?f(Error("http status "+c)):void f()}),function(){l.close();l=null;var c=Error("Aborted");c.code=1E3;f(c)}}}function e(c,d,e,g){l.call(this,c,d,f(g),e,g)}var g=d("inherits"),h=d("../../utils/url"),l=d("./sender-receiver");g(e,l);c.exports=e},{"../../utils/url":52,"./sender-receiver":28,debug:void 0,inherits:54}],25:[function(d,
c){function f(c,d){g.call(this);this.sendBuffer=[];this.sender=d;this.url=c}var e=d("inherits"),g=d("events").EventEmitter;e(f,g);f.prototype.send=function(c){this.sendBuffer.push(c);this.sendStop||this.sendSchedule()};f.prototype.sendScheduleWait=function(){var c,d=this;this.sendStop=function(){d.sendStop=null;clearTimeout(c)};c=setTimeout(function(){d.sendStop=null;d.sendSchedule()},25)};f.prototype.sendSchedule=function(){var c=this;if(0<this.sendBuffer.length){var d="["+this.sendBuffer.join(",")+
"]";this.sendStop=this.sender(this.url,d,function(d){c.sendStop=null;d?(c.emit("close",d.code||1006,"Sending error: "+d),c._cleanup()):c.sendScheduleWait()});this.sendBuffer=[]}};f.prototype._cleanup=function(){this.removeAllListeners()};f.prototype.stop=function(){this._cleanup();this.sendStop&&(this.sendStop(),this.sendStop=null)};c.exports=f},{debug:void 0,events:3,inherits:54}],26:[function(d,c){(function(f){var e=d("inherits"),g=d("../iframe"),h=d("../../utils/object");c.exports=function(c){function d(e,
f){g.call(this,c.transportName,e,f)}return e(d,g),d.enabled=function(d,e){if(!f.document)return!1;var m=h.extend({},e);return m.sameOrigin=!0,c.enabled(m)&&g.enabled()},d.transportName="iframe-"+c.transportName,d.needBody=!0,d.roundTrips=g.roundTrips+c.roundTrips-1,d.facadeTransport=c,d}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/object":49,"../iframe":22,inherits:54}],27:[function(d,c){function f(c,d,e){g.call(this);
this.Receiver=c;this.receiveUrl=d;this.AjaxObject=e;this._scheduleReceiver()}var e=d("inherits"),g=d("events").EventEmitter;e(f,g);f.prototype._scheduleReceiver=function(){var c=this,d=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);d.on("message",function(d){c.emit("message",d)});d.once("close",function(e,f){c.poll=d=null;c.pollIsClosing||("network"===f?c._scheduleReceiver():(c.emit("close",e||1006,f),c.removeAllListeners()))})};f.prototype.abort=function(){this.removeAllListeners();
this.pollIsClosing=!0;this.poll&&this.poll.abort()};c.exports=f},{debug:void 0,events:3,inherits:54}],28:[function(d,c){function f(c,d,e,f,t){d=g.addPath(c,d);var s=this;h.call(this,c,e);this.poll=new l(f,d,t);this.poll.on("message",function(c){s.emit("message",c)});this.poll.once("close",function(c,d){s.poll=null;s.emit("close",c,d);s.close()})}var e=d("inherits"),g=d("../../utils/url"),h=d("./buffered-sender"),l=d("./polling");e(f,h);f.prototype.close=function(){this.removeAllListeners();this.poll&&
(this.poll.abort(),this.poll=null);this.stop()};c.exports=f},{"../../utils/url":52,"./buffered-sender":25,"./polling":27,debug:void 0,inherits:54}],29:[function(d,c){function f(c){g.call(this);var d=this,e=this.es=new h(c);e.onmessage=function(c){d.emit("message",decodeURI(c.data))};e.onerror=function(c){c=2!==e.readyState?"network":"permanent";d._cleanup();d._close(c)}}var e=d("inherits"),g=d("events").EventEmitter,h=d("eventsource");e(f,g);f.prototype.abort=function(){this._cleanup();this._close("user")};
f.prototype._cleanup=function(){var c=this.es;c&&(c.onmessage=c.onerror=null,c.close(),this.es=null)};f.prototype._close=function(c){var d=this;setTimeout(function(){d.emit("close",null,c);d.removeAllListeners()},200)};c.exports=f},{debug:void 0,events:3,eventsource:18,inherits:54}],30:[function(d,c){(function(f){function e(c){m.call(this);var d=this;h.polluteGlobalNamespace();this.id="a"+q.string(6);c=l.addQuery(c,"c="+decodeURIComponent(h.WPrefix+"."+this.id));var g=e.htmlfileEnabled?h.createHtmlfile:
h.createIframe;f[h.WPrefix][this.id]={start:function(){d.iframeObj.loaded()},message:function(c){d.emit("message",c)},stop:function(){d._cleanup();d._close("network")}};this.iframeObj=g(c,function(){d._cleanup();d._close("permanent")})}var g=d("inherits"),h=d("../../utils/iframe"),l=d("../../utils/url"),m=d("events").EventEmitter,q=d("../../utils/random");g(e,m);e.prototype.abort=function(){this._cleanup();this._close("user")};e.prototype._cleanup=function(){this.iframeObj&&(this.iframeObj.cleanup(),
this.iframeObj=null);delete f[h.WPrefix][this.id]};e.prototype._close=function(c){this.emit("close",null,c);this.removeAllListeners()};e.htmlfileEnabled=!1;g=["Active"].concat("Object").join("X");if(g in f)try{e.htmlfileEnabled=!!new f[g]("htmlfile")}catch(r){}e.enabled=e.htmlfileEnabled||h.iframeEnabled;c.exports=e}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/iframe":47,"../../utils/random":50,"../../utils/url":52,
debug:void 0,events:3,inherits:54}],31:[function(d,c){(function(f){function e(c){var d=this;r.call(this);g.polluteGlobalNamespace();this.id="a"+h.string(6);c=m.addQuery(c,"c="+encodeURIComponent(g.WPrefix+"."+this.id));f[g.WPrefix][this.id]=this._callback.bind(this);this._createScript(c);this.timeoutId=setTimeout(function(){d._abort(Error("JSONP script loaded abnormally (timeout)"))},e.timeout)}var g=d("../../utils/iframe"),h=d("../../utils/random"),l=d("../../utils/browser"),m=d("../../utils/url"),
q=d("inherits"),r=d("events").EventEmitter;q(e,r);e.prototype.abort=function(){if(f[g.WPrefix][this.id]){var c=Error("JSONP user aborted read");c.code=1E3;this._abort(c)}};e.timeout=35E3;e.scriptErrorTimeout=1E3;e.prototype._callback=function(c){this._cleanup();this.aborting||(c&&this.emit("message",c),this.emit("close",null,"network"),this.removeAllListeners())};e.prototype._abort=function(c){this._cleanup();this.aborting=!0;this.emit("close",c.code,c.message);this.removeAllListeners()};e.prototype._cleanup=
function(){if(clearTimeout(this.timeoutId),this.script2&&(this.script2.parentNode.removeChild(this.script2),this.script2=null),this.script){var c=this.script;c.parentNode.removeChild(c);this.script=c.onreadystatechange=c.onerror=c.onload=c.onclick=null}delete f[g.WPrefix][this.id]};e.prototype._scriptError=function(){var c=this;this.errorTimer||(this.errorTimer=setTimeout(function(){c.loadedOkay||c._abort(Error("JSONP script loaded abnormally (onerror)"))},e.scriptErrorTimeout))};e.prototype._createScript=
function(c){var d,e=this,g=this.script=f.document.createElement("script");if(g.id="a"+h.string(8),g.src=c,g.type="text/javascript",g.charset="UTF-8",g.onerror=this._scriptError.bind(this),g.onload=function(){e._abort(Error("JSONP script loaded abnormally (onload)"))},g.onreadystatechange=function(){if(/loaded|closed/.test(g.readyState)){if(g&&g.htmlFor&&g.onclick){e.loadedOkay=!0;try{g.onclick()}catch(c){}}g&&e._abort(Error("JSONP script loaded abnormally (onreadystatechange)"))}},"undefined"==typeof g.async&&
f.document.attachEvent)if(l.isOpera())d=this.script2=f.document.createElement("script"),d.text="try{var a = document.getElementById('"+g.id+"'); if(a)a.onerror();}catch(x){};",g.async=d.async=!1;else{try{g.htmlFor=g.id,g.event="onclick"}catch(m){}g.async=!0}"undefined"!=typeof g.async&&(g.async=!0);c=f.document.getElementsByTagName("head")[0];c.insertBefore(g,c.firstChild);d&&c.insertBefore(d,c.firstChild)};c.exports=e}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=
typeof window?window:{})},{"../../utils/browser":44,"../../utils/iframe":47,"../../utils/random":50,"../../utils/url":52,debug:void 0,events:3,inherits:54}],32:[function(d,c){function f(c,d){g.call(this);var e=this;this.bufferPosition=0;this.xo=new d("POST",c,null);this.xo.on("chunk",this._chunkHandler.bind(this));this.xo.once("finish",function(c,d){e._chunkHandler(c,d);e.xo=null;e.emit("close",null,200===c?"network":"permanent");e._cleanup()})}var e=d("inherits"),g=d("events").EventEmitter;e(f,g);
f.prototype._chunkHandler=function(c,d){if(200===c&&d)for(var e=-1;;this.bufferPosition+=e+1){var f=d.slice(this.bufferPosition);if(e=f.indexOf("\n"),-1===e)break;(f=f.slice(0,e))&&this.emit("message",f)}};f.prototype._cleanup=function(){this.removeAllListeners()};f.prototype.abort=function(){this.xo&&(this.xo.close(),this.emit("close",null,"user"),this.xo=null);this._cleanup()};c.exports=f},{debug:void 0,events:3,inherits:54}],33:[function(d,c){(function(f){function e(c){try{return f.document.createElement('<iframe name="'+
c+'">')}catch(d){var e=f.document.createElement("iframe");return e.name=c,e}}var g,h,l=d("../../utils/random"),m=d("../../utils/url");c.exports=function(c,d,p){g||(g=f.document.createElement("form"),g.style.display="none",g.style.position="absolute",g.method="POST",g.enctype="application/x-www-form-urlencoded",g.acceptCharset="UTF-8",h=f.document.createElement("textarea"),h.name="d",g.appendChild(h),f.document.body.appendChild(g));var t="a"+l.string(8);g.target=t;g.action=m.addQuery(m.addPath(c,"/jsonp_send"),
"i="+t);var s=e(t);s.id=t;s.style.display="none";g.appendChild(s);try{h.value=d}catch(u){}g.submit();var w=function(c){s.onerror&&(s.onreadystatechange=s.onerror=s.onload=null,setTimeout(function(){s.parentNode.removeChild(s);s=null},500),h.value="",p(c))};return s.onerror=function(){w()},s.onload=function(){w()},s.onreadystatechange=function(c){"complete"===s.readyState&&w()},function(){w(Error("Aborted"))}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=
typeof window?window:{})},{"../../utils/random":50,"../../utils/url":52,debug:void 0}],34:[function(d,c){(function(f){function e(c,d,e){var f=this;g.call(this);setTimeout(function(){f._start(c,d,e)},0)}var g=d("events").EventEmitter,h=d("inherits"),l=d("../../utils/event"),m=d("../../utils/browser"),q=d("../../utils/url");h(e,g);e.prototype._start=function(c,d,e){var g=this,h=new f.XDomainRequest;d=q.addQuery(d,"t="+ +new Date);h.onerror=function(){g._error()};h.ontimeout=function(){g._error()};h.onprogress=
function(){g.emit("chunk",200,h.responseText)};h.onload=function(){g.emit("finish",200,h.responseText);g._cleanup(!1)};this.xdr=h;this.unloadRef=l.unloadAdd(function(){g._cleanup(!0)});try{this.xdr.open(c,d),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(e)}catch(m){this._error()}};e.prototype._error=function(){this.emit("finish",0,"");this._cleanup(!1)};e.prototype._cleanup=function(c){if(this.xdr){if(this.removeAllListeners(),l.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=
this.xdr.onprogress=this.xdr.onload=null,c)try{this.xdr.abort()}catch(d){}this.unloadRef=this.xdr=null}};e.prototype.close=function(){this._cleanup(!0)};e.enabled=!(!f.XDomainRequest||!m.hasDomain());c.exports=e}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/browser":44,"../../utils/event":46,"../../utils/url":52,debug:void 0,events:3,inherits:54}],35:[function(d,c){function f(c,d,e,f){g.call(this,c,d,e,f)}var e=d("inherits"),
g=d("../driver/xhr");e(f,g);f.enabled=g.enabled&&g.supportsCORS;c.exports=f},{"../driver/xhr":17,inherits:54}],36:[function(d,c){function f(){var c=this;e.call(this);this.to=setTimeout(function(){c.emit("finish",200,"{}")},f.timeout)}var e=d("events").EventEmitter;d("inherits")(f,e);f.prototype.close=function(){clearTimeout(this.to)};f.timeout=2E3;c.exports=f},{events:3,inherits:54}],37:[function(d,c){function f(c,d,e){g.call(this,c,d,e,{noCredentials:!0})}var e=d("inherits"),g=d("../driver/xhr");
e(f,g);f.enabled=g.enabled;c.exports=f},{"../driver/xhr":17,inherits:54}],38:[function(d,c){function f(c,d,h){if(!f.enabled())throw Error("Transport created when disabled");l.call(this);var t=this;c=g.addPath(c,"/websocket");this.url=c="https"===c.slice(0,5)?"wss"+c.slice(5):"ws"+c.slice(4);this.ws=new m(this.url,void 0,h);this.ws.onmessage=function(c){t.emit("message",c.data)};this.unloadRef=e.unloadAdd(function(){t.ws.close()});this.ws.onclose=function(c){t.emit("close",c.code,c.reason);t._cleanup()};
this.ws.onerror=function(c){t.emit("close",1006,"WebSocket connection broken");t._cleanup()}}var e=d("../utils/event"),g=d("../utils/url"),h=d("inherits"),l=d("events").EventEmitter,m=d("./driver/websocket");h(f,l);f.prototype.send=function(c){this.ws.send("["+c+"]")};f.prototype.close=function(){this.ws&&this.ws.close();this._cleanup()};f.prototype._cleanup=function(){var c=this.ws;c&&(c.onmessage=c.onclose=c.onerror=null);e.unloadDel(this.unloadRef);this.unloadRef=this.ws=null;this.removeAllListeners()};
f.enabled=function(){return!!m};f.transportName="websocket";f.roundTrips=2;c.exports=f},{"../utils/event":46,"../utils/url":52,"./driver/websocket":19,debug:void 0,events:3,inherits:54}],39:[function(d,c){function f(c){if(!m.enabled)throw Error("Transport created when disabled");g.call(this,c,"/xhr",l,m)}var e=d("inherits"),g=d("./lib/ajax-based"),h=d("./xdr-streaming"),l=d("./receiver/xhr"),m=d("./sender/xdr");e(f,g);f.enabled=h.enabled;f.transportName="xdr-polling";f.roundTrips=2;c.exports=f},{"./lib/ajax-based":24,
"./receiver/xhr":32,"./sender/xdr":34,"./xdr-streaming":40,inherits:54}],40:[function(d,c){function f(c){if(!l.enabled)throw Error("Transport created when disabled");g.call(this,c,"/xhr_streaming",h,l)}var e=d("inherits"),g=d("./lib/ajax-based"),h=d("./receiver/xhr"),l=d("./sender/xdr");e(f,g);f.enabled=function(c){return c.cookie_needed||c.nullOrigin?!1:l.enabled&&c.sameScheme};f.transportName="xdr-streaming";f.roundTrips=2;c.exports=f},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xdr":34,
inherits:54}],41:[function(d,c){function f(c){if(!m.enabled&&!l.enabled)throw Error("Transport created when disabled");g.call(this,c,"/xhr",h,l)}var e=d("inherits"),g=d("./lib/ajax-based"),h=d("./receiver/xhr"),l=d("./sender/xhr-cors"),m=d("./sender/xhr-local");e(f,g);f.enabled=function(c){return c.nullOrigin?!1:m.enabled&&c.sameOrigin?!0:l.enabled};f.transportName="xhr-polling";f.roundTrips=2;c.exports=f},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xhr-cors":35,"./sender/xhr-local":37,inherits:54}],
42:[function(d,c){(function(f){function e(c){if(!q.enabled&&!m.enabled)throw Error("Transport created when disabled");h.call(this,c,"/xhr_streaming",l,m)}var g=d("inherits"),h=d("./lib/ajax-based"),l=d("./receiver/xhr"),m=d("./sender/xhr-cors"),q=d("./sender/xhr-local"),r=d("../utils/browser");g(e,h);e.enabled=function(c){return c.nullOrigin?!1:r.isOpera()?!1:m.enabled};e.transportName="xhr-streaming";e.roundTrips=2;e.needBody=!!f.document;c.exports=e}).call(this,"undefined"!=typeof global?global:
"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../utils/browser":44,"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xhr-cors":35,"./sender/xhr-local":37,inherits:54}],43:[function(d,c){(function(d){c.exports.randomBytes=d.crypto&&d.crypto.getRandomValues?function(c){c=new Uint8Array(c);return d.crypto.getRandomValues(c),c}:function(c){for(var d=Array(c),f=0;c>f;f++)d[f]=Math.floor(256*Math.random());return d}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?
self:"undefined"!=typeof window?window:{})},{}],44:[function(d,c){(function(d){c.exports={isOpera:function(){return d.navigator&&/opera/i.test(d.navigator.userAgent)},isKonqueror:function(){return d.navigator&&/konqueror/i.test(d.navigator.userAgent)},hasDomain:function(){if(!d.document)return!0;try{return!!d.document.domain}catch(c){return!1}}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],45:[function(d,c){var f,e=d("json3"),
g=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,
h=function(c){var d,e={},f=[];for(d=0;65536>d;d++)f.push(String.fromCharCode(d));return c.lastIndex=0,f.join("").replace(c,function(c){return e[c]="\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4),""}),c.lastIndex=0,e};c.exports={quote:function(c){c=e.stringify(c);return g.lastIndex=0,g.test(c)?(f||(f=h(g)),c.replace(g,function(c){return f[c]})):c}}},{json3:55}],46:[function(d,c){(function(f){var e=d("./random"),g={},h=!1,l=f.chrome&&f.chrome.app&&f.chrome.app.runtime;c.exports={attachEvent:function(c,
d){"undefined"!=typeof f.addEventListener?f.addEventListener(c,d,!1):f.document&&f.attachEvent&&(f.document.attachEvent("on"+c,d),f.attachEvent("on"+c,d))},detachEvent:function(c,d){"undefined"!=typeof f.addEventListener?f.removeEventListener(c,d,!1):f.document&&f.detachEvent&&(f.document.detachEvent("on"+c,d),f.detachEvent("on"+c,d))},unloadAdd:function(c){if(l)return null;var d=e.string(8);return g[d]=c,h&&setTimeout(this.triggerUnloadCallbacks,0),d},unloadDel:function(c){c in g&&delete g[c]},triggerUnloadCallbacks:function(){for(var c in g)g[c](),
delete g[c]}};l||c.exports.attachEvent("unload",function(){h||(h=!0,c.exports.triggerUnloadCallbacks())})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./random":50}],47:[function(d,c){(function(f){var e=d("./event"),g=d("json3"),h=d("./browser");c.exports={WPrefix:"_jp",currentWindowId:null,polluteGlobalNamespace:function(){c.exports.WPrefix in f||(f[c.exports.WPrefix]={})},postMessage:function(d,e){f.parent!==f&&f.parent.postMessage(g.stringify({windowId:c.exports.currentWindowId,
type:d,data:e||""}),"*")},createIframe:function(c,d){var g,h,p=f.document.createElement("iframe"),t=function(){clearTimeout(g);try{p.onload=null}catch(c){}p.onerror=null},s=function(){p&&(t(),setTimeout(function(){p&&p.parentNode.removeChild(p);p=null},0),e.unloadDel(h))};return p.src=c,p.style.display="none",p.style.position="absolute",p.onerror=function(){p&&(s(),d("onerror"))},p.onload=function(){clearTimeout(g);g=setTimeout(function(){p&&(s(),d("onload timeout"))},2E3)},f.document.body.appendChild(p),
g=setTimeout(function(){p&&(s(),d("timeout"))},15E3),h=e.unloadAdd(s),{post:function(c,d){try{setTimeout(function(){p&&p.contentWindow&&p.contentWindow.postMessage(c,d)},0)}catch(e){}},cleanup:s,loaded:t}},createHtmlfile:function(d,g){var h,r,p,t=["Active"].concat("Object").join("X"),s=new f[t]("htmlfile"),u=function(){clearTimeout(h);p.onerror=null},w=function(){s&&(u(),e.unloadDel(r),p.parentNode.removeChild(p),p=s=null,CollectGarbage())};s.open();s.write('<html><script>document.domain="'+f.document.domain+
'";\x3c/script></html>');s.close();s.parentWindow[c.exports.WPrefix]=f[c.exports.WPrefix];t=s.createElement("div");return s.body.appendChild(t),p=s.createElement("iframe"),t.appendChild(p),p.src=d,p.onerror=function(){s&&(w(),g("onerror"))},h=setTimeout(function(){s&&(w(),g("timeout"))},15E3),r=e.unloadAdd(w),{post:function(c,d){try{setTimeout(function(){p&&p.contentWindow&&p.contentWindow.postMessage(c,d)},0)}catch(e){}},cleanup:w,loaded:u}}};c.exports.iframeEnabled=!1;f.document&&(c.exports.iframeEnabled=
("function"==typeof f.postMessage||"object"==typeof f.postMessage)&&!h.isKonqueror())}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./browser":44,"./event":46,debug:void 0,json3:55}],48:[function(d,c){(function(d){var e={};["log","debug","warn"].forEach(function(c){var h;try{h=d.console&&d.console[c]&&d.console[c].apply}catch(l){}e[c]=h?function(){return d.console[c].apply(d.console,arguments)}:"log"===c?function(){}:e.log});c.exports=
e}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],49:[function(d,c){c.exports={isObject:function(c){var d=typeof c;return"function"===d||"object"===d&&!!c},extend:function(c){if(!this.isObject(c))return c;for(var d,g,h=1,l=arguments.length;l>h;h++)for(g in d=arguments[h],d)Object.prototype.hasOwnProperty.call(d,g)&&(c[g]=d[g]);return c}}},{}],50:[function(d,c){var f=d("crypto");c.exports={string:function(c){for(var d=f.randomBytes(c),
h=[],l=0;c>l;l++)h.push("abcdefghijklmnopqrstuvwxyz012345".substr(d[l]%32,1));return h.join("")},number:function(c){return Math.floor(Math.random()*c)},numberString:function(c){var d=(""+(c-1)).length;return(Array(d+1).join("0")+this.number(c)).slice(-d)}}},{crypto:43}],51:[function(d,c){c.exports=function(c){return{filterToEnabled:function(d,g){var h={main:[],facade:[]};return d?"string"==typeof d&&(d=[d]):d=[],c.forEach(function(c){c&&("websocket"!==c.transportName||!1!==g.websocket)&&(d.length&&
-1===d.indexOf(c.transportName)||c.enabled(g)&&(h.main.push(c),c.facadeTransport&&h.facade.push(c.facadeTransport)))}),h}}}},{debug:void 0}],52:[function(d,c){var f=d("url-parse");c.exports={getOrigin:function(c){if(!c)return null;c=new f(c);if("file:"===c.protocol)return null;var d=c.port;return d||(d="https:"===c.protocol?"443":"80"),c.protocol+"//"+c.hostname+":"+d},isOriginEqual:function(c,d){return this.getOrigin(c)===this.getOrigin(d)},isSchemeEqual:function(c,d){return c.split(":")[0]===d.split(":")[0]},
addPath:function(c,d){var f=c.split("?");return f[0]+d+(f[1]?"?"+f[1]:"")},addQuery:function(c,d){return c+(-1===c.indexOf("?")?"?"+d:"&"+d)}}},{debug:void 0,"url-parse":56}],53:[function(d,c){c.exports="1.1.0"},{}],54:[function(d,c){c.exports="function"==typeof Object.create?function(c,d){c.super_=d;c.prototype=Object.create(d.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}})}:function(c,d){c.super_=d;var g=function(){};g.prototype=d.prototype;c.prototype=new g;c.prototype.constructor=
c}},{}],55:[function(d,c,f){(function(d){(function(){function g(c,d){function e(c){if(e[c]!==C)return e[c];var g;if("bug-string-char-index"==c)g="a"!="a"[0];else if("json"==c)g=e("json-stringify")&&e("json-parse");else{var h;if("json-stringify"==c){g=d.stringify;var m="function"==typeof g&&U;if(m){(h=function(){return 1}).toJSON=h;try{m="0"===g(0)&&"0"===g(new f)&&'""'==g(new l)&&g(R)===C&&g(C)===C&&g()===C&&"1"===g(h)&&"[1]"==g([h])&&"[null]"==g([C])&&"null"==g(null)&&"[null,null,null]"==g([C,R,
null])&&'{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'==g({a:[h,!0,!1,null,"\x00\b\n\f\r  "]})&&"1"===g(null,h)&&"[\n 1,\n 2\n]"==g([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==g(new q(-864E13))&&'"+275760-09-13T00:00:00.000Z"'==g(new q(864E13))&&'"-000001-01-01T00:00:00.000Z"'==g(new q(-621987552E5))&&'"1969-12-31T23:59:59.999Z"'==g(new q(-1))}catch(p){m=!1}}g=m}if("json-parse"==c){g=d.parse;if("function"==typeof g)try{if(0===g("0")&&!g(!1)){h=g('{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}');
var r=5==h.a.length&&1===h.a[0];if(r){try{r=!g('" "')}catch(t){}if(r)try{r=1!==g("01")}catch(s){}if(r)try{r=1!==g("1.")}catch(u){}}}}catch(v){r=!1}g=r}}return e[c]=!!g}c||(c=m.Object());d||(d=m.Object());var f=c.Number||m.Number,l=c.String||m.String,p=c.Object||m.Object,q=c.Date||m.Date,r=c.SyntaxError||m.SyntaxError,t=c.TypeError||m.TypeError,s=c.Math||m.Math,Q=c.JSON||m.JSON;"object"==typeof Q&&Q&&(d.stringify=Q.stringify,d.parse=Q.parse);var G,V,C,p=p.prototype,R=p.toString,U=new q(-0xc782b5b800cec);
try{U=-109252==U.getUTCFullYear()&&0===U.getUTCMonth()&&1===U.getUTCDate()&&10==U.getUTCHours()&&37==U.getUTCMinutes()&&6==U.getUTCSeconds()&&708==U.getUTCMilliseconds()}catch(Y){}if(!e("json")){var O=e("bug-string-char-index");if(!U)var E=s.floor,ba=[0,31,59,90,120,151,181,212,243,273,304,334],S=function(c,d){return ba[d]+365*(c-1970)+E((c-1969+(d=+(1<d)))/4)-E((c-1901+d)/100)+E((c-1601+d)/400)};if((G=p.hasOwnProperty)||(G=function(c){var d,e={};return(e.__proto__=null,e.__proto__={toString:1},e).toString!=
R?G=function(c){var d=this.__proto__;c=c in(this.__proto__=null,this);return this.__proto__=d,c}:(d=e.constructor,G=function(c){var e=(this.constructor||d).prototype;return c in this&&!(c in e&&this[c]===e[c])}),e=null,G.call(this,c)}),V=function(c,d){var e,f,g,l=0;(e=function(){this.valueOf=0}).prototype.valueOf=0;f=new e;for(g in f)G.call(f,g)&&l++;return e=f=null,l?V=2==l?function(c,d){var e,f={},g="[object Function]"==R.call(c);for(e in c)g&&"prototype"==e||G.call(f,e)||!(f[e]=1)||!G.call(c,e)||
d(e)}:function(c,d){var e,f,g="[object Function]"==R.call(c);for(e in c)g&&"prototype"==e||!G.call(c,e)||(f="constructor"===e)||d(e);(f||G.call(c,e="constructor"))&&d(e)}:(f="valueOf toString toLocaleString propertyIsEnumerable isPrototypeOf hasOwnProperty constructor".split(" "),V=function(c,d){var e,g;g="[object Function]"==R.call(c);var k=!g&&"function"!=typeof c.constructor&&h[typeof c.hasOwnProperty]&&c.hasOwnProperty||G;for(e in c)g&&"prototype"==e||!k.call(c,e)||d(e);for(g=f.length;e=f[--g];k.call(c,
e)&&d(e));}),V(c,d)},!e("json-stringify")){var P={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},L=function(c,d){return("000000"+(d||0)).slice(-c)},ga=function(c){for(var d='"',e=0,f=c.length,g=!O||10<f,h=g&&(O?c.split(""):c);f>e;e++){var l=c.charCodeAt(e);switch(l){case 8:case 9:case 10:case 12:case 13:case 34:case 92:d+=P[l];break;default:if(32>l){d+="\\u00"+L(2,l.toString(16));break}d+=g?h[e]:c.charAt(e)}}return d+'"'},B=function(c,d,e,f,g,h,l){var m,p,q,r,n,s,u,w,A,v;try{m=d[c]}catch(y){}if("object"==
typeof m&&m)if(p=R.call(m),"[object Date]"!=p||G.call(m,"toJSON"))"function"==typeof m.toJSON&&("[object Number]"!=p&&"[object String]"!=p&&"[object Array]"!=p||G.call(m,"toJSON"))&&(m=m.toJSON(c));else if(m>-1/0&&1/0>m){if(S){n=E(m/864E5);for(q=E(n/365.2425)+1970-1;S(q+1,0)<=n;q++);for(r=E((n-S(q,0))/30.42);S(q,r+1)<=n;r++);n=1+n-S(q,r);s=(m%864E5+864E5)%864E5;u=E(s/36E5)%24;w=E(s/6E4)%60;A=E(s/1E3)%60;s%=1E3}else q=m.getUTCFullYear(),r=m.getUTCMonth(),n=m.getUTCDate(),u=m.getUTCHours(),w=m.getUTCMinutes(),
A=m.getUTCSeconds(),s=m.getUTCMilliseconds();m=(0>=q||1E4<=q?(0>q?"-":"+")+L(6,0>q?-q:q):L(4,q))+"-"+L(2,r+1)+"-"+L(2,n)+"T"+L(2,u)+":"+L(2,w)+":"+L(2,A)+"."+L(3,s)+"Z"}else m=null;if(e&&(m=e.call(d,c,m)),null===m)return"null";if(p=R.call(m),"[object Boolean]"==p)return""+m;if("[object Number]"==p)return m>-1/0&&1/0>m?""+m:"null";if("[object String]"==p)return ga(""+m);if("object"==typeof m){for(c=l.length;c--;)if(l[c]===m)throw t();if(l.push(m),v=[],d=h,h+=g,"[object Array]"==p){q=0;for(c=m.length;c>
q;q++)p=B(q,m,e,f,g,h,l),v.push(p===C?"null":p);p=v.length?g?"[\n"+h+v.join(",\n"+h)+"\n"+d+"]":"["+v.join(",")+"]":"[]"}else V(f||m,function(c){var d=B(c,m,e,f,g,h,l);d!==C&&v.push(ga(c)+":"+(g?" ":"")+d)}),p=v.length?g?"{\n"+h+v.join(",\n"+h)+"\n"+d+"}":"{"+v.join(",")+"}":"{}";return l.pop(),p}};d.stringify=function(c,d,e){var f,g,l,m;if(h[typeof d]&&d)if("[object Function]"==(m=R.call(d)))g=d;else if("[object Array]"==m){l={};for(var p,q=0,r=d.length;r>q;p=d[q++],m=R.call(p),("[object String]"==
m||"[object Number]"==m)&&(l[p]=1));}if(e)if("[object Number]"==(m=R.call(e))){if(0<(e-=e%1))for(f="",10<e&&(e=10);f.length<e;f+=" ");}else"[object String]"==m&&(f=10>=e.length?e:e.slice(0,10));return B("",(p={},p[""]=c,p),g,l,f,"",[])}}if(!e("json-parse")){var v,z,M=l.fromCharCode,K={92:"\\",34:'"',47:"/",98:"\b",116:" ",110:"\n",102:"\f",114:"\r"},D=function(){throw v=z=null,r();},N=function(){for(var c,d,e,f,g,h=z,l=h.length;l>v;)switch(g=h.charCodeAt(v)){case 9:case 10:case 13:case 32:v++;break;
case 123:case 125:case 91:case 93:case 58:case 44:return c=O?h.charAt(v):h[v],v++,c;case 34:c="@";for(v++;l>v;)if(g=h.charCodeAt(v),32>g)D();else if(92==g)switch(g=h.charCodeAt(++v)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:c+=K[g];v++;break;case 117:d=++v;for(e=v+4;e>v;v++)g=h.charCodeAt(v),48<=g&&57>=g||97<=g&&102>=g||65<=g&&70>=g||D();c+=M("0x"+h.slice(d,v));break;default:D()}else{if(34==g)break;g=h.charCodeAt(v);for(d=v;32<=g&&92!=g&&34!=g;)g=h.charCodeAt(++v);c+=h.slice(d,
v)}if(34==h.charCodeAt(v))return v++,c;D();default:if(d=v,45==g&&(f=!0,g=h.charCodeAt(++v)),48<=g&&57>=g){for(48==g&&(g=h.charCodeAt(v+1),48<=g&&57>=g)&&D();l>v&&(g=h.charCodeAt(v),48<=g&&57>=g);v++);if(46==h.charCodeAt(v)){for(e=++v;l>e&&(g=h.charCodeAt(e),48<=g&&57>=g);e++);e==v&&D();v=e}if(g=h.charCodeAt(v),101==g||69==g){g=h.charCodeAt(++v);43!=g&&45!=g||v++;for(e=v;l>e&&(g=h.charCodeAt(e),48<=g&&57>=g);e++);e==v&&D();v=e}return+h.slice(d,v)}if(f&&D(),"true"==h.slice(v,v+4))return v+=4,!0;if("false"==
h.slice(v,v+5))return v+=5,!1;if("null"==h.slice(v,v+4))return v+=4,null;D()}return"$"},ka=function(c){var d,e;if("$"==c&&D(),"string"==typeof c){if("@"==(O?c.charAt(0):c[0]))return c.slice(1);if("["==c){for(d=[];c=N(),"]"!=c;e||(e=!0))e&&(","==c?(c=N(),"]"==c&&D()):D()),","==c&&D(),d.push(ka(c));return d}if("{"==c){for(d={};c=N(),"}"!=c;e||(e=!0))e&&(","==c?(c=N(),"}"==c&&D()):D()),","!=c&&"string"==typeof c&&"@"==(O?c.charAt(0):c[0])&&":"==N()||D(),d[c.slice(1)]=ka(N());return d}D()}return c},X=
function(c,d,e){e=I(c,d,e);e===C?delete c[d]:c[d]=e},I=function(c,d,e){var f,g=c[d];if("object"==typeof g&&g)if("[object Array]"==R.call(g))for(f=g.length;f--;)X(g,f,e);else V(g,function(c){X(g,c,e)});return e.call(c,d,g)};d.parse=function(c,d){var e,f;return v=0,z=""+c,e=ka(N()),"$"!=N()&&D(),v=z=null,d&&"[object Function]"==R.call(d)?I((f={},f[""]=e,f),"",d):e}}}return d.runInContext=g,d}var h={"function":!0,object:!0},l=h[typeof f]&&f&&!f.nodeType&&f,m=h[typeof window]&&window||this,q=l&&h[typeof c]&&
c&&!c.nodeType&&"object"==typeof d&&d;if(!q||q.global!==q&&q.window!==q&&q.self!==q||(m=q),l&&!0)g(m,l);else{var r=m.JSON,p=m.JSON3,t=!1,s=g(m,m.JSON3={noConflict:function(){return t||(t=!0,m.JSON=r,m.JSON3=p,r=p=null),s}});m.JSON={parse:s.parse,stringify:s.stringify}}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],56:[function(d,c){function f(c,d,p){if(!(this instanceof f))return new f(c,d,p);var t,s,u,w,A=l.test(c);
t=typeof d;var n=0;"object"!==t&&"string"!==t&&(p=d,d=null);p&&"function"!=typeof p&&(p=h.parse);for(d=g(d);n<m.length;n++)s=m[n],t=s[0],w=s[1],t!==t?this[w]=c:"string"==typeof t?~(u=c.indexOf(t))&&("number"==typeof s[2]?(this[w]=c.slice(0,u),c=c.slice(u+s[2])):(this[w]=c.slice(u),c=c.slice(0,u))):(u=t.exec(c))&&(this[w]=u[1],c=c.slice(0,c.length-u[0].length)),this[w]=this[w]||(s[3]||"port"===w&&A?d[w]||"":""),s[4]&&(this[w]=this[w].toLowerCase());p&&(this.query=p(this.query));e(this.port,this.protocol)||
(this.host=this.hostname,this.port="");this.username=this.password="";this.auth&&(s=this.auth.split(":"),this.username=s[0]||"",this.password=s[1]||"");this.href=this.toString()}var e=d("requires-port"),g=d("./lolcation"),h=d("querystringify"),l=/^\/(?!\/)/,m=[["#","hash"],["?","query"],["//","protocol",2,1,1],["/","pathname"],["@","auth",1],[0/0,"host",void 0,1,1],[/\:(\d+)$/,"port"],[0/0,"hostname",void 0,1,1]];f.prototype.set=function(c,d,f){return"query"===c?("string"==typeof d&&(d=(f||h.parse)(d)),
this[c]=d):"port"===c?(this[c]=d,e(d,this.protocol)?d&&(this.host=this.hostname+":"+d):(this.host=this.hostname,this[c]="")):"hostname"===c?(this[c]=d,this.port&&(d+=":"+this.port),this.host=d):"host"===c?(this[c]=d,/\:\d+/.test(d)&&(d=d.split(":"),this.hostname=d[0],this.port=d[1])):this[c]=d,this.href=this.toString(),this};f.prototype.toString=function(c){c&&"function"==typeof c||(c=h.stringify);var d,e=this.protocol+"//";return this.username&&(e+=this.username,this.password&&(e+=":"+this.password),
e+="@"),e+=this.hostname,this.port&&(e+=":"+this.port),e+=this.pathname,this.query&&(d="object"==typeof this.query?c(this.query):this.query,e+=("?"===d.charAt(0)?"":"?")+d),this.hash&&(e+=this.hash),e};f.qs=h;f.location=g;c.exports=f},{"./lolcation":57,querystringify:58,"requires-port":59}],57:[function(d,c){(function(f){var e,g={hash:1,query:1};c.exports=function(c){c=c||f.location||{};e=e||d("./");var l,m={},q=typeof c;if("blob:"===c.protocol)m=new e(unescape(c.pathname),{});else if("string"===
q)for(l in m=new e(c,{}),g)delete m[l];else if("object"===q)for(l in c)l in g||(m[l]=c[l]);return m}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./":56}],58:[function(d,c,f){var e=Object.prototype.hasOwnProperty;f.stringify=function(c,d){d=d||"";var f=[];"string"!=typeof d&&(d="?");for(var m in c)e.call(c,m)&&f.push(encodeURIComponent(m)+"="+encodeURIComponent(c[m]));return f.length?d+f.join("&"):""};f.parse=function(c){for(var d,
e=/([^=?&]+)=([^&]*)/g,f={};d=e.exec(c);f[decodeURIComponent(d[1])]=decodeURIComponent(d[2]));return f}},{}],59:[function(d,c){c.exports=function(c,d){if(d=d.split(":")[0],c=+c,!c)return!1;switch(d){case "http":case "ws":return 80!==c;case "https":case "wss":return 443!==c;case "ftp":return 22!==c;case "gopher":return 70!==c;case "file":return!1}return 0!==c}},{}]},{},[1])(1)});/*
 FastClick: polyfill to remove click delays on browsers with touch UIs.

 @version 1.0.3
 @codingstandard ftlabs-jsv2
 @copyright The Financial Times Limited [All Rights Reserved]
 @license MIT License (see LICENSE.txt)
*/
function FastClick(b,d){function c(b,c){return function(){return b.apply(c,arguments)}}var f;d=d||{};this.trackingClick=!1;this.trackingClickStart=0;this.targetElement=null;this.lastTouchIdentifier=this.touchStartY=this.touchStartX=0;this.touchBoundary=d.touchBoundary||10;this.layer=b;this.tapDelay=d.tapDelay||200;if(!FastClick.notNeeded(b)){for(var e="onMouse onClick onTouchStart onTouchMove onTouchEnd onTouchCancel".split(" "),g=0,h=e.length;g<h;g++)this[e[g]]=c(this[e[g]],this);deviceIsAndroid&&
(b.addEventListener("mouseover",this.onMouse,!0),b.addEventListener("mousedown",this.onMouse,!0),b.addEventListener("mouseup",this.onMouse,!0));b.addEventListener("click",this.onClick,!0);b.addEventListener("touchstart",this.onTouchStart,!1);b.addEventListener("touchmove",this.onTouchMove,!1);b.addEventListener("touchend",this.onTouchEnd,!1);b.addEventListener("touchcancel",this.onTouchCancel,!1);Event.prototype.stopImmediatePropagation||(b.removeEventListener=function(c,d,e){var f=Node.prototype.removeEventListener;
"click"===c?f.call(b,c,d.hijacked||d,e):f.call(b,c,d,e)},b.addEventListener=function(c,d,e){var f=Node.prototype.addEventListener;"click"===c?f.call(b,c,d.hijacked||(d.hijacked=function(b){b.propagationStopped||d(b)}),e):f.call(b,c,d,e)});"function"===typeof b.onclick&&(f=b.onclick,b.addEventListener("click",function(b){f(b)},!1),b.onclick=null)}}
var deviceIsAndroid=0<navigator.userAgent.indexOf("Android"),deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent),deviceIsIOS4=deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),deviceIsIOSWithBadTarget=deviceIsIOS&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent),deviceIsBlackBerry10=0<navigator.userAgent.indexOf("BB10");
FastClick.prototype.needsClick=function(b){switch(b.nodeName.toLowerCase()){case "button":case "select":case "textarea":if(b.disabled)return!0;break;case "input":if(deviceIsIOS&&"file"===b.type||b.disabled)return!0;break;case "label":case "video":return!0}return/\bneedsclick\b/.test(b.className)};
FastClick.prototype.needsFocus=function(b){switch(b.nodeName.toLowerCase()){case "textarea":return!0;case "select":return!deviceIsAndroid;case "input":switch(b.type){case "button":case "checkbox":case "file":case "image":case "radio":case "submit":return!1}return!b.disabled&&!b.readOnly;default:return/\bneedsfocus\b/.test(b.className)}};
FastClick.prototype.sendClick=function(b,d){var c,f;document.activeElement&&document.activeElement!==b&&document.activeElement.blur();f=d.changedTouches[0];c=document.createEvent("MouseEvents");c.initMouseEvent(this.determineEventType(b),!0,!0,window,1,f.screenX,f.screenY,f.clientX,f.clientY,!1,!1,!1,!1,0,null);c.forwardedTouchEvent=!0;b.dispatchEvent(c)};FastClick.prototype.determineEventType=function(b){return deviceIsAndroid&&"select"===b.tagName.toLowerCase()?"mousedown":"click"};
FastClick.prototype.focus=function(b){var d;deviceIsIOS&&b.setSelectionRange&&0!==b.type.indexOf("date")&&"time"!==b.type?(d=b.value.length,b.setSelectionRange(d,d)):b.focus()};FastClick.prototype.updateScrollParent=function(b){var d,c;d=b.fastClickScrollParent;if(!d||!d.contains(b)){c=b;do{if(c.scrollHeight>c.offsetHeight){d=c;b.fastClickScrollParent=c;break}c=c.parentElement}while(c)}d&&(d.fastClickLastScrollTop=d.scrollTop)};
FastClick.prototype.getTargetElementFromEventTarget=function(b){return b.nodeType===Node.TEXT_NODE?b.parentNode:b};
FastClick.prototype.onTouchStart=function(b){var d,c,f;if(1<b.targetTouches.length)return!0;d=this.getTargetElementFromEventTarget(b.target);c=b.targetTouches[0];if(deviceIsIOS){f=window.getSelection();if(f.rangeCount&&!f.isCollapsed)return!0;if(!deviceIsIOS4){if(c.identifier&&c.identifier===this.lastTouchIdentifier)return b.preventDefault(),!1;this.lastTouchIdentifier=c.identifier;this.updateScrollParent(d)}}this.trackingClick=!0;this.trackingClickStart=b.timeStamp;this.targetElement=d;this.touchStartX=
c.pageX;this.touchStartY=c.pageY;b.timeStamp-this.lastClickTime<this.tapDelay&&b.preventDefault();return!0};FastClick.prototype.touchHasMoved=function(b){b=b.changedTouches[0];var d=this.touchBoundary;return Math.abs(b.pageX-this.touchStartX)>d||Math.abs(b.pageY-this.touchStartY)>d?!0:!1};
FastClick.prototype.onTouchMove=function(b){if(!this.trackingClick)return!0;if(this.targetElement!==this.getTargetElementFromEventTarget(b.target)||this.touchHasMoved(b))this.trackingClick=!1,this.targetElement=null;return!0};FastClick.prototype.findControl=function(b){return void 0!==b.control?b.control:b.htmlFor?document.getElementById(b.htmlFor):b.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")};
FastClick.prototype.onTouchEnd=function(b){var d,c,f=this.targetElement;if(!this.trackingClick)return!0;if(b.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0;this.cancelNextClick=!1;this.lastClickTime=b.timeStamp;d=this.trackingClickStart;this.trackingClick=!1;this.trackingClickStart=0;deviceIsIOSWithBadTarget&&(c=b.changedTouches[0],f=document.elementFromPoint(c.pageX-window.pageXOffset,c.pageY-window.pageYOffset)||f,f.fastClickScrollParent=this.targetElement.fastClickScrollParent);
c=f.tagName.toLowerCase();if("label"===c){if(d=this.findControl(f)){this.focus(f);if(deviceIsAndroid)return!1;f=d}}else if(this.needsFocus(f)){if(100<b.timeStamp-d||deviceIsIOS&&window.top!==window&&"input"===c)return this.targetElement=null,!1;this.focus(f);this.sendClick(f,b);deviceIsIOS&&"select"===c||(this.targetElement=null,b.preventDefault());return!1}if(deviceIsIOS&&!deviceIsIOS4&&(d=f.fastClickScrollParent)&&d.fastClickLastScrollTop!==d.scrollTop)return!0;this.needsClick(f)||(b.preventDefault(),
this.sendClick(f,b));return!1};FastClick.prototype.onTouchCancel=function(){this.trackingClick=!1;this.targetElement=null};FastClick.prototype.onMouse=function(b){return this.targetElement&&!b.forwardedTouchEvent&&b.cancelable?!this.needsClick(this.targetElement)||this.cancelNextClick?(b.stopImmediatePropagation?b.stopImmediatePropagation():b.propagationStopped=!0,b.stopPropagation(),b.preventDefault(),!1):!0:!0};
FastClick.prototype.onClick=function(b){if(this.trackingClick)return this.targetElement=null,this.trackingClick=!1,!0;if("submit"===b.target.type&&0===b.detail)return!0;b=this.onMouse(b);b||(this.targetElement=null);return b};
FastClick.prototype.destroy=function(){var b=this.layer;deviceIsAndroid&&(b.removeEventListener("mouseover",this.onMouse,!0),b.removeEventListener("mousedown",this.onMouse,!0),b.removeEventListener("mouseup",this.onMouse,!0));b.removeEventListener("click",this.onClick,!0);b.removeEventListener("touchstart",this.onTouchStart,!1);b.removeEventListener("touchmove",this.onTouchMove,!1);b.removeEventListener("touchend",this.onTouchEnd,!1);b.removeEventListener("touchcancel",this.onTouchCancel,!1)};
FastClick.notNeeded=function(b){var d,c;if("undefined"===typeof window.ontouchstart)return!0;if(c=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1])if(deviceIsAndroid){if((d=document.querySelector("meta[name=viewport]"))&&(-1!==d.content.indexOf("user-scalable=no")||31<c&&document.documentElement.scrollWidth<=window.outerWidth))return!0}else return!0;return deviceIsBlackBerry10&&(d=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),10<=d[1]&&3<=d[2]&&(d=document.querySelector("meta[name=viewport]"))&&
(-1!==d.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))?!0:"none"===b.style.msTouchAction?!0:!1};FastClick.attach=function(b,d){return new FastClick(b,d)};"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return FastClick}):"undefined"!==typeof module&&module.exports?(module.exports=FastClick.attach,module.exports.FastClick=FastClick):window.FastClick=FastClick;(function(b){"function"===typeof define&&define.amd?define(["jquery","jquery-ui/ui/widget"],b):"object"===typeof exports?b(require("jquery"),require("./vendor/jquery.ui.widget")):b(window.jQuery)})(function(b){function d(c){var d="dragover"===c;return function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var g=e.dataTransfer;g&&-1!==b.inArray("Files",g.types)&&!1!==this._trigger(c,b.Event(c,{delegatedEvent:e}))&&(e.preventDefault(),d&&(g.dropEffect="copy"))}}b.support.fileInput=
!(/(Android (1\.[0156]|2\.[01]))|(Windows Phone (OS 7|8\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1\.0|2\.[05]|3\.0))/.test(window.navigator.userAgent)||b('<input type="file">').prop("disabled"));b.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader);b.support.xhrFormDataFileUpload=!!window.FormData;b.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);b.widget("blueimp.fileupload",{options:{dropZone:b(document),
pasteZone:void 0,fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},
i18n:function(c,d){c=this.messages[c]||c.toString();d&&b.each(d,function(b,d){c=c.replace("{"+b+"}",d)});return c},formData:function(b){return b.serializeArray()},add:function(c,d){if(c.isDefaultPrevented())return!1;(d.autoUpload||!1!==d.autoUpload&&b(this).fileupload("option","autoUpload"))&&d.process().done(function(){d.submit()})},processData:!1,contentType:!1,cache:!1,timeout:0},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:b.support.blobSlice&&
function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime();this.bitrate=this.loaded=0;this.getBitrate=function(b,d,e){var g=b-this.timestamp;if(!this.bitrate||!e||g>e)this.bitrate=1E3/g*(d-this.loaded)*8,this.loaded=d,this.timestamp=b;return this.bitrate}},_isXHRUpload:function(c){return!c.forceIframeTransport&&(!c.multipart&&b.support.xhrFileUpload||b.support.xhrFormDataFileUpload)},_getFormData:function(c){var d;
return"function"===b.type(c.formData)?c.formData(c.form):b.isArray(c.formData)?c.formData:"object"===b.type(c.formData)?(d=[],b.each(c.formData,function(b,c){d.push({name:b,value:c})}),d):[]},_getTotal:function(c){var d=0;b.each(c,function(b,c){d+=c.size||1});return d},_initProgressObject:function(c){var d={loaded:0,total:0,bitrate:0};c._progress?b.extend(c._progress,d):c._progress=d},_initResponseObject:function(b){var d;if(b._response)for(d in b._response)b._response.hasOwnProperty(d)&&delete b._response[d];
else b._response={}},_onProgress:function(c,d){if(c.lengthComputable){var e=Date.now?Date.now():(new Date).getTime(),g;d._time&&d.progressInterval&&e-d._time<d.progressInterval&&c.loaded!==c.total||(d._time=e,g=Math.floor(c.loaded/c.total*(d.chunkSize||d._progress.total))+(d.uploadedBytes||0),this._progress.loaded+=g-d._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(e,this._progress.loaded,d.bitrateInterval),d._progress.loaded=d.loaded=g,d._progress.bitrate=d.bitrate=d._bitrateTimer.getBitrate(e,
g,d.bitrateInterval),this._trigger("progress",b.Event("progress",{delegatedEvent:c}),d),this._trigger("progressall",b.Event("progressall",{delegatedEvent:c}),this._progress))}},_initProgressListener:function(c){var d=this,e=c.xhr?c.xhr():b.ajaxSettings.xhr();e.upload&&(b(e.upload).bind("progress",function(b){var e=b.originalEvent;b.lengthComputable=e.lengthComputable;b.loaded=e.loaded;b.total=e.total;d._onProgress(b,c)}),c.xhr=function(){return e})},_isInstanceOf:function(b,d){return Object.prototype.toString.call(d)===
"[object "+b+"]"},_initXHRData:function(c){var d=this,e,g=c.files[0],h=c.multipart||!b.support.xhrFileUpload,l="array"===b.type(c.paramName)?c.paramName[0]:c.paramName;c.headers=b.extend({},c.headers);c.contentRange&&(c.headers["Content-Range"]=c.contentRange);h&&!c.blob&&this._isInstanceOf("File",g)||(c.headers["Content-Disposition"]='attachment; filename="'+encodeURI(g.name)+'"');h?b.support.xhrFormDataFileUpload&&(c.postMessage?(e=this._getFormData(c),c.blob?e.push({name:l,value:c.blob}):b.each(c.files,
function(d,f){e.push({name:"array"===b.type(c.paramName)&&c.paramName[d]||l,value:f})})):(d._isInstanceOf("FormData",c.formData)?e=c.formData:(e=new FormData,b.each(this._getFormData(c),function(b,c){e.append(c.name,c.value)})),c.blob?e.append(l,c.blob,g.name):b.each(c.files,function(g,h){(d._isInstanceOf("File",h)||d._isInstanceOf("Blob",h))&&e.append("array"===b.type(c.paramName)&&c.paramName[g]||l,h,h.uploadName||h.name)})),c.data=e):(c.contentType=g.type||"application/octet-stream",c.data=c.blob||
g);c.blob=null},_initIframeSettings:function(c){var d=b("<a></a>").prop("href",c.url).prop("host");c.dataType="iframe "+(c.dataType||"");c.formData=this._getFormData(c);c.redirect&&d&&d!==location.host&&c.formData.push({name:c.redirectParamName||"redirect",value:c.redirect})},_initDataSettings:function(b){this._isXHRUpload(b)?(this._chunkedUpload(b,!0)||(b.data||this._initXHRData(b),this._initProgressListener(b)),b.postMessage&&(b.dataType="postmessage "+(b.dataType||""))):this._initIframeSettings(b)},
_getParamName:function(c){var d=b(c.fileInput),e=c.paramName;e?b.isArray(e)||(e=[e]):(e=[],d.each(function(){for(var c=b(this),d=c.prop("name")||"files[]",c=(c.prop("files")||[1]).length;c;)e.push(d),--c}),e.length||(e=[d.prop("name")||"files[]"]));return e},_initFormSettings:function(c){c.form&&c.form.length||(c.form=b(c.fileInput.prop("form")),c.form.length||(c.form=b(this.options.fileInput.prop("form"))));c.paramName=this._getParamName(c);c.url||(c.url=c.form.prop("action")||location.href);c.type=
(c.type||"string"===b.type(c.form.prop("method"))&&c.form.prop("method")||"").toUpperCase();"POST"!==c.type&&"PUT"!==c.type&&"PATCH"!==c.type&&(c.type="POST");c.formAcceptCharset||(c.formAcceptCharset=c.form.attr("accept-charset"))},_getAJAXSettings:function(c){c=b.extend({},this.options,c);this._initFormSettings(c);this._initDataSettings(c);return c},_getDeferredState:function(b){return b.state?b.state():b.isResolved()?"resolved":b.isRejected()?"rejected":"pending"},_enhancePromise:function(b){b.success=
b.done;b.error=b.fail;b.complete=b.always;return b},_getXHRPromise:function(c,d,e){var g=b.Deferred(),h=g.promise();d=d||this.options.context||h;!0===c?g.resolveWith(d,e):!1===c&&g.rejectWith(d,e);h.abort=g.promise;return this._enhancePromise(h)},_addConvenienceMethods:function(c,d){var e=this,g=function(c){return b.Deferred().resolveWith(e,c).promise()};d.process=function(c,l){if(c||l)d._processQueue=this._processQueue=(this._processQueue||g([this])).then(function(){return d.errorThrown?b.Deferred().rejectWith(e,
[d]).promise():g(arguments)}).then(c,l);return this._processQueue||g([this])};d.submit=function(){"pending"!==this.state()&&(d.jqXHR=this.jqXHR=!1!==e._trigger("submit",b.Event("submit",{delegatedEvent:c}),this)&&e._onSend(c,this));return this.jqXHR||e._getXHRPromise()};d.abort=function(){if(this.jqXHR)return this.jqXHR.abort();this.errorThrown="abort";e._trigger("fail",null,this);return e._getXHRPromise(!1)};d.state=function(){if(this.jqXHR)return e._getDeferredState(this.jqXHR);if(this._processQueue)return e._getDeferredState(this._processQueue)};
d.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===e._getDeferredState(this._processQueue)};d.progress=function(){return this._progress};d.response=function(){return this._response}},_getUploadedBytes:function(b){return(b=(b=(b=b.getResponseHeader("Range"))&&b.split("-"))&&1<b.length&&parseInt(b[1],10))&&b+1},_chunkedUpload:function(c,d){c.uploadedBytes=c.uploadedBytes||0;var e=this,g=c.files[0],h=g.size,l=c.uploadedBytes,m=c.maxChunkSize||h,q=this._blobSlice,r=b.Deferred(),
p=r.promise(),t,s;if(!(this._isXHRUpload(c)&&q&&(l||m<h))||c.data)return!1;if(d)return!0;if(l>=h)return g.error=c.i18n("uploadedBytes"),this._getXHRPromise(!1,c.context,[null,"error",g.error]);s=function(){var d=b.extend({},c),f=d._progress.loaded;d.blob=q.call(g,l,l+m,g.type);d.chunkSize=d.blob.size;d.contentRange="bytes "+l+"-"+(l+d.chunkSize-1)+"/"+h;e._initXHRData(d);e._initProgressListener(d);t=(!1!==e._trigger("chunksend",null,d)&&b.ajax(d)||e._getXHRPromise(!1,d.context)).done(function(g,m,
p){l=e._getUploadedBytes(p)||l+d.chunkSize;f+d.chunkSize-d._progress.loaded&&e._onProgress(b.Event("progress",{lengthComputable:!0,loaded:l-d.uploadedBytes,total:l-d.uploadedBytes}),d);c.uploadedBytes=d.uploadedBytes=l;d.result=g;d.textStatus=m;d.jqXHR=p;e._trigger("chunkdone",null,d);e._trigger("chunkalways",null,d);l<h?s():r.resolveWith(d.context,[g,m,p])}).fail(function(b,c,f){d.jqXHR=b;d.textStatus=c;d.errorThrown=f;e._trigger("chunkfail",null,d);e._trigger("chunkalways",null,d);r.rejectWith(d.context,
[b,c,f])})};this._enhancePromise(p);p.abort=function(){return t.abort()};s();return p},_beforeSend:function(b,d){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0);this._initResponseObject(d);this._initProgressObject(d);d._progress.loaded=d.loaded=d.uploadedBytes||0;d._progress.total=d.total=this._getTotal(d.files)||1;d._progress.bitrate=d.bitrate=0;this._active+=1;this._progress.loaded+=d.loaded;
this._progress.total+=d.total},_onDone:function(c,d,e,g){var h=g._progress.total,l=g._response;g._progress.loaded<h&&this._onProgress(b.Event("progress",{lengthComputable:!0,loaded:h,total:h}),g);l.result=g.result=c;l.textStatus=g.textStatus=d;l.jqXHR=g.jqXHR=e;this._trigger("done",null,g)},_onFail:function(b,d,e,g){var h=g._response;g.recalculateProgress&&(this._progress.loaded-=g._progress.loaded,this._progress.total-=g._progress.total);h.jqXHR=g.jqXHR=b;h.textStatus=g.textStatus=d;h.errorThrown=
g.errorThrown=e;this._trigger("fail",null,g)},_onAlways:function(b,d,e,g){this._trigger("always",null,g)},_onSend:function(c,d){d.submit||this._addConvenienceMethods(c,d);var e=this,g,h,l,m,q=e._getAJAXSettings(d),r=function(){e._sending+=1;q._bitrateTimer=new e._BitrateTimer;return g=g||((h||!1===e._trigger("send",b.Event("send",{delegatedEvent:c}),q))&&e._getXHRPromise(!1,q.context,h)||e._chunkedUpload(q)||b.ajax(q)).done(function(b,c,d){e._onDone(b,c,d,q)}).fail(function(b,c,d){e._onFail(b,c,d,
q)}).always(function(b,c,d){e._onAlways(b,c,d,q);--e._sending;--e._active;if(q.limitConcurrentUploads&&q.limitConcurrentUploads>e._sending)for(b=e._slots.shift();b;){if("pending"===e._getDeferredState(b)){b.resolve();break}b=e._slots.shift()}0===e._active&&e._trigger("stop")})};this._beforeSend(c,q);return this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(1<this.options.limitConcurrentUploads?(l=b.Deferred(),this._slots.push(l),
m=l.then(r)):m=this._sequence=this._sequence.then(r,r),m.abort=function(){h=[void 0,"abort","abort"];return g?g.abort():(l&&l.rejectWith(q.context,h),r())},this._enhancePromise(m)):r()},_onAdd:function(c,d){var e=this,g=!0,h=b.extend({},this.options,d),l=d.files,m=l.length,q=h.limitMultiFileUploads,r=h.limitMultiFileUploadSize,p=h.limitMultiFileUploadSizeOverhead,t=0,s=this._getParamName(h),u,w,A=0;if(!m)return!1;r&&void 0===l[0].size&&(r=void 0);if((h.singleFileUploads||q||r)&&this._isXHRUpload(h))if(h.singleFileUploads||
r||!q)if(!h.singleFileUploads&&r)for(w=[],u=[],h=0;h<m;h+=1){if(t+=l[h].size+p,h+1===m||t+l[h+1].size+p>r||q&&h+1-A>=q)w.push(l.slice(A,h+1)),t=s.slice(A,h+1),t.length||(t=s),u.push(t),A=h+1,t=0}else u=s;else for(w=[],u=[],h=0;h<m;h+=q)w.push(l.slice(h,h+q)),t=s.slice(h,h+q),t.length||(t=s),u.push(t);else w=[l],u=[s];d.originalFiles=l;b.each(w||l,function(h,l){var m=b.extend({},d);m.files=w?l:[l];m.paramName=u[h];e._initResponseObject(m);e._initProgressObject(m);e._addConvenienceMethods(c,m);return g=
e._trigger("add",b.Event("add",{delegatedEvent:c}),m)});return g},_replaceFileInput:function(c){var d=c.fileInput,e=d.clone(!0),g=d.is(document.activeElement);c.fileInputClone=e;b("<form></form>").append(e)[0].reset();d.after(e).detach();g&&e.focus();b.cleanData(d.unbind("remove"));this.options.fileInput=this.options.fileInput.map(function(b,c){return c===d[0]?e[0]:c});d[0]===this.element[0]&&(this.element=e)},_handleFileTreeEntry:function(c,d){var e=this,g=b.Deferred(),h=[],l,m=function(b){b&&!b.entry&&
(b.entry=c);g.resolve([b])},q=function(b){e._handleFileTreeEntries(b,d+c.name+"/").done(function(b){g.resolve(b)}).fail(m)},r=function(){l.readEntries(function(b){b.length?(h=h.concat(b),r()):q(h)},m)};d=d||"";c.isFile?c._file?(c._file.relativePath=d,g.resolve(c._file)):c.file(function(b){b.relativePath=d;g.resolve(b)},m):c.isDirectory?(l=c.createReader(),r()):g.resolve([]);return g.promise()},_handleFileTreeEntries:function(c,d){var e=this;return b.when.apply(b,b.map(c,function(b){return e._handleFileTreeEntry(b,
d)})).then(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(c){c=c||{};var d=c.items;return d&&d.length&&(d[0].webkitGetAsEntry||d[0].getAsEntry)?this._handleFileTreeEntries(b.map(d,function(b){var c;if(b.webkitGetAsEntry){if(c=b.webkitGetAsEntry())c._file=b.getAsFile();return c}return b.getAsEntry()})):b.Deferred().resolve(b.makeArray(c.files)).promise()},_getSingleFileInputFiles:function(c){c=b(c);var d=c.prop("webkitEntries")||c.prop("entries");if(d&&d.length)return this._handleFileTreeEntries(d);
d=b.makeArray(c.prop("files"));if(d.length)void 0===d[0].name&&d[0].fileName&&b.each(d,function(b,c){c.name=c.fileName;c.size=c.fileSize});else{c=c.prop("value");if(!c)return b.Deferred().resolve([]).promise();d=[{name:c.replace(/^.*\\/,"")}]}return b.Deferred().resolve(d).promise()},_getFileInputFiles:function(c){return c instanceof b&&1!==c.length?b.when.apply(b,b.map(c,this._getSingleFileInputFiles)).then(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(c)},
_onChange:function(c){var d=this,e={fileInput:b(c.target),form:b(c.target.form)};this._getFileInputFiles(e.fileInput).always(function(g){e.files=g;d.options.replaceFileInput&&d._replaceFileInput(e);!1!==d._trigger("change",b.Event("change",{delegatedEvent:c}),e)&&d._onAdd(c,e)})},_onPaste:function(c){var d=c.originalEvent&&c.originalEvent.clipboardData&&c.originalEvent.clipboardData.items,e={files:[]};d&&d.length&&(b.each(d,function(b,c){var d=c.getAsFile&&c.getAsFile();d&&e.files.push(d)}),!1!==
this._trigger("paste",b.Event("paste",{delegatedEvent:c}),e)&&this._onAdd(c,e))},_onDrop:function(c){c.dataTransfer=c.originalEvent&&c.originalEvent.dataTransfer;var d=this,e=c.dataTransfer,g={};e&&e.files&&e.files.length&&(c.preventDefault(),this._getDroppedFiles(e).always(function(e){g.files=e;!1!==d._trigger("drop",b.Event("drop",{delegatedEvent:c}),g)&&d._onAdd(c,g)}))},_onDragOver:d("dragover"),_onDragEnter:d("dragenter"),_onDragLeave:d("dragleave"),_initEventHandlers:function(){this._isXHRUpload(this.options)&&
(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave}),this._on(this.options.pasteZone,{paste:this._onPaste}));b.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop");this._off(this.options.pasteZone,"paste");this._off(this.options.fileInput,"change")},_destroy:function(){this._destroyEventHandlers()},
_setOption:function(c,d){var e=-1!==b.inArray(c,this._specialOptions);e&&this._destroyEventHandlers();this._super(c,d);e&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var c=this.options;void 0===c.fileInput?c.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):c.fileInput instanceof b||(c.fileInput=b(c.fileInput));c.dropZone instanceof b||(c.dropZone=b(c.dropZone));c.pasteZone instanceof b||(c.pasteZone=b(c.pasteZone))},
_getRegExp:function(b){b=b.split("/");var d=b.pop();b.shift();return new RegExp(b.join("/"),d)},_isRegExpOption:function(c,d){return"url"!==c&&"string"===b.type(d)&&/^\/.*\/[igm]{0,3}$/.test(d)},_initDataAttributes:function(){var c=this,d=this.options,e=this.element.data();b.each(this.element[0].attributes,function(b,h){var l=h.name.toLowerCase(),m;/^data-/.test(l)&&(l=l.slice(5).replace(/-[a-z]/g,function(b){return b.charAt(1).toUpperCase()}),m=e[l],c._isRegExpOption(l,m)&&(m=c._getRegExp(m)),d[l]=
m)})},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(!0);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(c){var d=this;c&&!this.options.disabled&&(c.fileInput&&!c.files?this._getFileInputFiles(c.fileInput).always(function(b){c.files=b;d._onAdd(null,c)}):(c.files=b.makeArray(c.files),this._onAdd(null,
c)))},send:function(c){if(c&&!this.options.disabled){if(c.fileInput&&!c.files){var d=this,e=b.Deferred(),g=e.promise(),h,l;g.abort=function(){l=!0;if(h)return h.abort();e.reject(null,"abort","abort");return g};this._getFileInputFiles(c.fileInput).always(function(b){l||(b.length?(c.files=b,h=d._onSend(null,c),h.then(function(b,c,d){e.resolve(b,c,d)},function(b,c,d){e.reject(b,c,d)})):e.reject())});return this._enhancePromise(g)}c.files=b.makeArray(c.files);if(c.files.length)return this._onSend(null,
c)}return this._getXHRPromise(!1,c&&c.context)}})});"function"!==typeof Object.create&&(Object.create=function(b){function d(){}d.prototype=b;return new d});
var NotyObject={init:function(b){this.options=$.extend({},$.noty.defaults,b);this.options.layout=this.options.custom?$.noty.layouts.inline:$.noty.layouts[this.options.layout];$.noty.themes[this.options.theme]?this.options.theme=$.noty.themes[this.options.theme]:b.themeClassName=this.options.theme;delete b.layout;delete b.theme;this.options=$.extend({},this.options,this.options.layout.options);this.options.id="noty_"+(new Date).getTime()*Math.floor(1E6*Math.random());this.options=$.extend({},this.options,
b);this._build();return this},_build:function(){var b=$('<div class="noty_bar noty_type_'+this.options.type+'"></div>').attr("id",this.options.id);b.append(this.options.template).find(".noty_text").html(this.options.text);this.$bar=null!==this.options.layout.parent.object?$(this.options.layout.parent.object).css(this.options.layout.parent.css).append(b):b;this.options.themeClassName&&this.$bar.addClass(this.options.themeClassName).addClass("noty_container_type_"+this.options.type);if(this.options.buttons){this.options.closeWith=
[];this.options.timeout=!1;b=$("<div/>").addClass("noty_buttons");null!==this.options.layout.parent.object?this.$bar.find(".noty_bar").append(b):this.$bar.append(b);var d=this;$.each(this.options.buttons,function(b,f){var e=$("<button/>").addClass(f.addClass?f.addClass:"gray").html(f.text).attr("id",f.id?f.id:"button-"+b).appendTo(d.$bar.find(".noty_buttons")).on("click",function(){$.isFunction(f.onClick)&&f.onClick.call(e,d)})})}this.$message=this.$bar.find(".noty_message");this.$closeButton=this.$bar.find(".noty_close");
this.$buttons=this.$bar.find(".noty_buttons");$.noty.store[this.options.id]=this},show:function(){var b=this;b.options.custom?b.options.custom.find(b.options.layout.container.selector).append(b.$bar):$(b.options.layout.container.selector).append(b.$bar);b.options.theme&&b.options.theme.style&&b.options.theme.style.apply(b);"function"===$.type(b.options.layout.css)?this.options.layout.css.apply(b.$bar):b.$bar.css(this.options.layout.css||{});b.$bar.addClass(b.options.layout.addClass);b.options.layout.container.style.apply($(b.options.layout.container.selector));
b.showing=!0;b.options.theme&&b.options.theme.style&&b.options.theme.callback.onShow.apply(this);if(-1<$.inArray("click",b.options.closeWith))b.$bar.css("cursor","pointer").one("click",function(d){b.stopPropagation(d);b.options.callback.onCloseClick&&b.options.callback.onCloseClick.apply(b);b.close()});if(-1<$.inArray("hover",b.options.closeWith))b.$bar.one("mouseenter",function(){b.close()});if(-1<$.inArray("button",b.options.closeWith))b.$closeButton.one("click",function(d){b.stopPropagation(d);
b.close()});-1==$.inArray("button",b.options.closeWith)&&b.$closeButton.remove();b.options.callback.onShow&&b.options.callback.onShow.apply(b);"string"==typeof b.options.animation.open?(b.$bar.css("height",b.$bar.innerHeight()),b.$bar.show().addClass(b.options.animation.open).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){b.options.callback.afterShow&&b.options.callback.afterShow.apply(b);b.showing=!1;b.shown=!0})):b.$bar.animate(b.options.animation.open,
b.options.animation.speed,b.options.animation.easing,function(){b.options.callback.afterShow&&b.options.callback.afterShow.apply(b);b.showing=!1;b.shown=!0});b.options.timeout&&b.$bar.delay(b.options.timeout).promise().done(function(){b.close()});return this},close:function(){if(!(this.closed||this.$bar&&this.$bar.hasClass("i-am-closing-now"))){var b=this;if(this.showing)b.$bar.queue(function(){b.close.apply(b)});else if(this.$bar.dequeue(),this.shown||this.showing)if(b.$bar.addClass("i-am-closing-now"),
b.options.callback.onClose&&b.options.callback.onClose.apply(b),"string"==typeof b.options.animation.close)b.$bar.addClass(b.options.animation.close).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){b.options.callback.afterClose&&b.options.callback.afterClose.apply(b);b.closeCleanUp()});else b.$bar.clearQueue().stop().animate(b.options.animation.close,b.options.animation.speed,b.options.animation.easing,function(){b.options.callback.afterClose&&b.options.callback.afterClose.apply(b)}).promise().done(function(){b.closeCleanUp()});
else{var d=[];$.each($.noty.queue,function(c,f){f.options.id!=b.options.id&&d.push(f)});$.noty.queue=d}}},closeCleanUp:function(){var b=this;b.options.modal&&($.notyRenderer.setModalCount(-1),0==$.notyRenderer.getModalCount()&&$(".noty_modal").fadeOut("fast",function(){$(this).remove()}));$.notyRenderer.setLayoutCountFor(b,-1);0==$.notyRenderer.getLayoutCountFor(b)&&$(b.options.layout.container.selector).remove();"undefined"!==typeof b.$bar&&null!==b.$bar&&("string"==typeof b.options.animation.close?
(b.$bar.css("transition","all 100ms ease").css("border",0).css("margin",0).height(0),b.$bar.one("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){b.$bar.remove();b.$bar=null;b.closed=!0;b.options.theme.callback&&b.options.theme.callback.onClose&&b.options.theme.callback.onClose.apply(b)})):(b.$bar.remove(),b.$bar=null,b.closed=!0));delete $.noty.store[b.options.id];b.options.theme.callback&&b.options.theme.callback.onClose&&b.options.theme.callback.onClose.apply(b);b.options.dismissQueue||
($.noty.ontap=!0,$.notyRenderer.render());0<b.options.maxVisible&&b.options.dismissQueue&&$.notyRenderer.render()},setText:function(b){this.closed||(this.options.text=b,this.$bar.find(".noty_text").html(b));return this},setType:function(b){this.closed||(this.options.type=b,this.options.theme.style.apply(this),this.options.theme.callback.onShow.apply(this));return this},setTimeout:function(b){if(!this.closed){var d=this;this.options.timeout=b;d.$bar.delay(d.options.timeout).promise().done(function(){d.close()})}return this},
stopPropagation:function(b){b=b||window.event;"undefined"!==typeof b.stopPropagation?b.stopPropagation():b.cancelBubble=!0},closed:!1,showing:!1,shown:!1};$.notyRenderer={};$.notyRenderer.init=function(b){b=Object.create(NotyObject).init(b);b.options.killer&&$.noty.closeAll();b.options.force?$.noty.queue.unshift(b):$.noty.queue.push(b);$.notyRenderer.render();return"object"==$.noty.returns?b:b.options.id};
$.notyRenderer.render=function(){var b=$.noty.queue[0];"object"===$.type(b)?b.options.dismissQueue?0<b.options.maxVisible?$(b.options.layout.container.selector+" li").length<b.options.maxVisible&&$.notyRenderer.show($.noty.queue.shift()):$.notyRenderer.show($.noty.queue.shift()):$.noty.ontap&&($.notyRenderer.show($.noty.queue.shift()),$.noty.ontap=!1):$.noty.ontap=!0};
$.notyRenderer.show=function(b){b.options.modal&&($.notyRenderer.createModalFor(b),$.notyRenderer.setModalCount(1));b.options.custom?0==b.options.custom.find(b.options.layout.container.selector).length?b.options.custom.append($(b.options.layout.container.object).addClass("i-am-new")):b.options.custom.find(b.options.layout.container.selector).removeClass("i-am-new"):0==$(b.options.layout.container.selector).length?$("body").append($(b.options.layout.container.object).addClass("i-am-new")):$(b.options.layout.container.selector).removeClass("i-am-new");
$.notyRenderer.setLayoutCountFor(b,1);b.show()};$.notyRenderer.createModalFor=function(b){if(0==$(".noty_modal").length){var d=$("<div/>").addClass("noty_modal").addClass(b.options.theme).data("noty_modal_count",0);b.options.theme.modal&&b.options.theme.modal.css&&d.css(b.options.theme.modal.css);d.prependTo($("body")).fadeIn("fast");if(-1<$.inArray("backdrop",b.options.closeWith))d.on("click",function(b){$.noty.closeAll()})}};
$.notyRenderer.getLayoutCountFor=function(b){return $(b.options.layout.container.selector).data("noty_layout_count")||0};$.notyRenderer.setLayoutCountFor=function(b,d){return $(b.options.layout.container.selector).data("noty_layout_count",$.notyRenderer.getLayoutCountFor(b)+d)};$.notyRenderer.getModalCount=function(){return $(".noty_modal").data("noty_modal_count")||0};$.notyRenderer.setModalCount=function(b){return $(".noty_modal").data("noty_modal_count",$.notyRenderer.getModalCount()+b)};
$.fn.noty=function(b){b.custom=$(this);return $.notyRenderer.init(b)};$.noty={};$.noty.queue=[];$.noty.ontap=!0;$.noty.layouts={};$.noty.themes={};$.noty.returns="object";$.noty.store={};$.noty.get=function(b){return $.noty.store.hasOwnProperty(b)?$.noty.store[b]:!1};$.noty.close=function(b){return $.noty.get(b)?$.noty.get(b).close():!1};$.noty.setText=function(b,d){return $.noty.get(b)?$.noty.get(b).setText(d):!1};$.noty.setType=function(b,d){return $.noty.get(b)?$.noty.get(b).setType(d):!1};
$.noty.clearQueue=function(){$.noty.queue=[]};$.noty.closeAll=function(){$.noty.clearQueue();$.each($.noty.store,function(b,d){d.close()})};var windowAlert=window.alert;$.noty.consumeAlert=function(b){window.alert=function(d){b?b.text=d:b={text:d};$.notyRenderer.init(b)}};$.noty.stopConsumeAlert=function(){window.alert=windowAlert};
$.noty.defaults={layout:"top",theme:"defaultTheme",type:"alert",text:"",dismissQueue:!0,template:'<div class="noty_message"><span class="noty_text"></span><div class="noty_close"></div></div>',animation:{open:{height:"toggle"},close:{height:"toggle"},easing:"swing",speed:500},timeout:!1,force:!1,modal:!1,maxVisible:5,killer:!1,closeWith:["click"],callback:{onShow:function(){},afterShow:function(){},onClose:function(){},afterClose:function(){},onCloseClick:function(){}},buttons:!1};
$(window).on("resize",function(){$.each($.noty.layouts,function(b,d){d.container.style.apply($(d.container.selector))})});window.noty=function(b){return jQuery.notyRenderer.init(b)};$.noty.layouts.top={name:"top",options:{},container:{object:'<ul id="noty_top_layout_container" />',selector:"ul#noty_top_layout_container",style:function(){$(this).css({top:0,left:"5%",position:"fixed",width:"90%",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:9999999})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none"},addClass:""};(function(b){function d(b){this.init(b)}d.prototype={value:0,size:100,startAngle:-Math.PI,thickness:"auto",fill:{gradient:["#3aeabb","#fdd250"]},emptyFill:"rgba(0, 0, 0, .1)",animation:{duration:1200,easing:"circleProgressEasing"},animationStartValue:0,reverse:!1,lineCap:"butt",constructor:d,el:null,canvas:null,ctx:null,radius:0,arcFill:null,lastFrameValue:0,init:function(c){b.extend(this,c);this.radius=this.size/2;this.initWidget();this.initFill();this.draw()},initWidget:function(){var c=this.canvas=
this.canvas||b("<canvas>").prependTo(this.el)[0];c.width=this.size;c.height=this.size;this.ctx=c.getContext("2d")},initFill:function(){function c(){var c=b("<canvas>")[0];c.width=d.size;c.height=d.size;c.getContext("2d").drawImage(p,0,0,h,h);d.arcFill=d.ctx.createPattern(c,"no-repeat");d.drawFrame(d.lastFrameValue)}var d=this,e=this.fill,g=this.ctx,h=this.size;if(!e)throw Error("The fill is not specified!");e.color&&(this.arcFill=e.color);if(e.gradient){var l=e.gradient;if(1==l.length)this.arcFill=
l[0];else if(1<l.length){for(var m=e.gradientAngle||0,m=e.gradientDirection||[h/2*(1-Math.cos(m)),h/2*(1+Math.sin(m)),h/2*(1+Math.cos(m)),h/2*(1-Math.sin(m))],g=g.createLinearGradient.apply(g,m),m=0;m<l.length;m++){var q=l[m],r=m/(l.length-1);b.isArray(q)&&(r=q[1],q=q[0]);g.addColorStop(r,q)}this.arcFill=g}}if(e.image){var p;e.image instanceof Image?p=e.image:(p=new Image,p.src=e.image);p.complete?c():p.onload=c}},draw:function(){this.animation?this.drawAnimated(this.value):this.drawFrame(this.value)},
drawFrame:function(b){this.lastFrameValue=b;this.ctx.clearRect(0,0,this.size,this.size);this.drawEmptyArc(b);this.drawArc(b)},drawArc:function(b){var d=this.ctx,e=this.radius,g=this.getThickness(),h=this.startAngle;d.save();d.beginPath();this.reverse?d.arc(e,e,e-g/2,h-2*Math.PI*b,h):d.arc(e,e,e-g/2,h,h+2*Math.PI*b);d.lineWidth=g;d.lineCap=this.lineCap;d.strokeStyle=this.arcFill;d.stroke();d.restore()},drawEmptyArc:function(b){var d=this.ctx,e=this.radius,g=this.getThickness(),h=this.startAngle;1>
b&&(d.save(),d.beginPath(),0>=b?d.arc(e,e,e-g/2,0,2*Math.PI):this.reverse?d.arc(e,e,e-g/2,h,h-2*Math.PI*b):d.arc(e,e,e-g/2,h+2*Math.PI*b,h),d.lineWidth=g,d.strokeStyle=this.emptyFill,d.stroke(),d.restore())},drawAnimated:function(c){var d=this,e=this.el;e.trigger("circle-animation-start");b(this.canvas).stop(!0,!0).css({animationProgress:0}).animate({animationProgress:1},b.extend({},this.animation,{step:function(b){var h=d.animationStartValue*(1-b)+c*b;d.drawFrame(h);e.trigger("circle-animation-progress",
[b,h])},complete:function(){e.trigger("circle-animation-end")}}))},getThickness:function(){return b.isNumeric(this.thickness)?this.thickness:this.size/14}};b.circleProgress={defaults:d.prototype};b.easing.circleProgressEasing=function(b,d,e,g,h){return 1>(d/=h/2)?g/2*d*d*d+e:g/2*((d-=2)*d*d+2)+e};b.fn.circleProgress=function(c){if("widget"==c){var f=this.data("circle-progress");return f&&f.canvas}return this.each(function(){var e=b(this),f=e.data("circle-progress"),h=b.isPlainObject(c)?c:{};f?f.init(h):
(h.el=e,f=new d(h),e.data("circle-progress",f))})}})(jQuery);window.AP_SESSION_ID=null;
var SocketData=Backbone.Model.extend({connectionView:null,_socket:null,_autoReconnectTrial:0,_nextReconnectAttempt:null,_autoReconnectTimeouts:[1,1,2,3,5,8,13,20,40,100],currentState:0,loggedUser:LOGGED_USER,defaults:{box_reachable:"unreachable",online:!1,printing:!1,paused:!1,camera:!1,printing_progress:{percent:0,time_left:0},temps:{bed:{actual:null,target:null},extruder:{actual:null,target:null}},astroprint:{status:null},printer:{status:null},print_capture:null},initialize:function(){this.set("printing",initial_states.printing||
initial_states.paused);this.set("paused",initial_states.paused);this.set("online",initial_states.online);this.set("print_capture",initial_states.print_capture);initial_states.checkSoftware&&initial_states.online&&$.get(API_BASEURL+"settings/software/check").done(_.bind(function(b){b.update_available&&!b.is_current&&this.trigger("new_sw_release",b)},this))},connect:function(b){this.set("box_reachable","checking");var d={};SOCKJS_DEBUG&&(d.debug=!0);this._socket=new SockJS(SOCKJS_URI+"?token="+b,void 0,
d);this._socket.onopen=_.bind(this._onConnect,this);this._socket.onclose=_.bind(this._onClose,this);this._socket.onmessage=_.bind(this._onMessage,this)},reconnect:function(){this._socket&&(this._socket.close(),delete this._socket);$.getJSON("/wsToken").done(_.bind(function(b){b&&b.ws_token&&this.connect(b.ws_token)},this)).fail(_.bind(function(){this._onClose()},this))},_onConnect:function(){this._nextReconnectAttempt&&(clearTimeout(this._nextReconnectAttempt),this._nextReconnectAttempt=null);this._autoReconnectTrial=
0;this.set("box_reachable","reachable")},_onClose:function(b){b&&1E3==b.code||(this.set("box_reachable","unreachable"),this.connectionView.setPrinterConnection("failed"),this.connectionView.setAstroprintConnection("failed"),this._currentState=0,this._autoReconnectTrial<this._autoReconnectTimeouts.length?(b=this._autoReconnectTimeouts[this._autoReconnectTrial],console.log("Reconnect trial #"+this._autoReconnectTrial+", waiting "+b+"s"),this._nextReconnectAttempt=setTimeout(_.bind(this.reconnect,this),
1E3*b),this._autoReconnectTrial++):this._onReconnectFailed())},_onReconnectFailed:function(){console.error("reconnect failed")},_onMessage:function(b){for(var d in b.data){var c=b.data[d];switch(d){case "connected":UI_API_KEY=c.apikey;AP_SESSION_ID=c.sessionId;$.ajaxSetup({headers:{"X-Api-Key":UI_API_KEY}});this.connectionView.connect();break;case "current":var f=c.state.flags;if(c.temps.length){var e=c.temps[c.temps.length-1];this.set("temps",{bed:e.bed,extruder:e.tool0})}if(c.state&&c.state.text!=
this.currentState){this.currentState=c.state.text;var e="blink-animation",g="connecting";f.closedOrError?g=e="failed":f.operational&&(g=e="connected");this.connectionView.setPrinterConnection(e);this.set("printer",{status:g})}f.paused||this.set("printing",f.printing);this.set("paused",f.paused);this.set("camera",f.camera);if(f.printing||f.paused)e=c.progress,g=c.job,this.set("printing_progress",{filename:g.file.name,printFileName:g.file.printFileName?g.file.printFileName:g.file.name,rendered_image:g.file.rendered_image,
layer_count:g.layerCount,current_layer:e.currentLayer,percent:e.completion?e.completion.toFixed(1):0,time_left:c.progress.printTimeLeft,time_elapsed:e.printTime?e.printTime:0,heating_up:f.heatingUp});break;case "event":f=c.type;c=c.payload;switch(f){case "MetadataAnalysisFinished":app.eventManager.trigger("astrobox:MetadataAnalysisFinished",c);break;case "CloudDownloadEvent":app.eventManager.trigger("astrobox:cloudDownloadEvent",c);break;case "AstroPrintStatus":switch(c){case "connecting":this.connectionView.setAstroprintConnection("blink-animation");
break;case "connected":this.connectionView.setAstroprintConnection("connected");break;case "disconnected":case "error":this.connectionView.setAstroprintConnection("failed");break;default:console.log("astroprintStatus unkonwn event: "+c)}this.set("astroprint",{status:c});break;case "LockStatusChanged":c!=this.loggedUser&&location.reload();break;case "PrintCaptureInfoChanged":this.set("print_capture",c);break;case "NetworkStatus":this.set("online","online"==c);break;case "InternetConnectingStatus":app.eventManager.trigger("astrobox:InternetConnectingStatus",
c);break;case "GstreamerEvent":app.eventManager.trigger("astrobox:videoStreamingEvent",c);break;case "SoftwareUpdateEvent":window.location.reload();break;default:console.warn("Unkonwn event received: "+f)}break;case "commsData":app.eventManager.trigger("astrobox:commsData",{direction:c.direction,data:c.data.trim()})}}}});var PrintFile=Backbone.Model.extend({defaults:{name:"",images:[]}}),PrintFileCollection=Backbone.Collection.extend({model:PrintFile,url:API_BASEURL+"astroprint/print-files",syncCloud:function(b){b||(b={});b.data={forceSyncCloud:!0};return this.fetch(b)}});var PrinterProfile=Backbone.Model.extend({url:API_BASEURL+"printer-profile",defaults:{id:"profile",extruder_count:1,max_nozzle_temp:280,max_bed_temp:140,heated_bed:!0,cancel_gcode:null,invert_z:!1}});var Utils=function(){var b="Jan Feb Mar Apr May Jun Jul Aug Sep Nov Oct Dec".split(" ");return{timeFormat:function(b){if(isNaN(b))return"-- : -- : --";b=parseInt(b,10);var c=Math.floor(b/3600),f=Math.floor((b-3600*c)/60);b=b-3600*c-60*f;10>c&&(c="0"+c);10>f&&(f="0"+f);10>b&&(b="0"+b);return c+":"+f+":"+b},dateFormat:function(d){return b[d.getMonth()]+" "+d.getDate()+", "+d.getFullYear()},sizeFormat:function(b){var c=-1;do b/=1024,c++;while(1024<b);return Math.max(b,.1).toFixed(1)+" kB; MB; GB; TB;PB;EB;ZB;YB".split(";")[c]}}};Janus.sessions={};Janus.extensionId="hapfgfdkleiggjjpfpenajgdnfckjpaj";Janus.isExtensionEnabled=function(){if(window.navigator.userAgent.match("Chrome")){var b=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),d=33;window.navigator.userAgent.match("Linux")&&(d=35);return 26<=b&&b<=d?!0:0<$("#janus-extension-installed").length}return!0};Janus.noop=function(){};
Janus.init=function(b){b=b||{};b.callback="function"==typeof b.callback?b.callback:Janus.noop;if(!0===Janus.initDone)b.callback();else{if("undefined"==typeof console||"undefined"==typeof console.log)console={log:function(){}};Janus.trace=Janus.noop;Janus.debug=Janus.noop;Janus.log=Janus.noop;Janus.warn=Janus.noop;Janus.error=Janus.noop;if(!0===b.debug||"all"===b.debug)Janus.trace=console.trace.bind(console),Janus.debug=console.debug.bind(console),Janus.log=console.log.bind(console),Janus.warn=console.warn.bind(console),
Janus.error=console.error.bind(console);else if($.isArray(b.debug))for(var d in b.debug){var c=b.debug[d];switch(c){case "trace":Janus.trace=console.trace.bind(console);break;case "debug":Janus.debug=console.debug.bind(console);break;case "log":Janus.log=console.log.bind(console);break;case "warn":Janus.warn=console.warn.bind(console);break;case "error":Janus.error=console.error.bind(console);break;default:console.error("Unknown debugging option '"+c+"' (supported: 'trace', 'debug', 'log', warn', 'error')")}}Janus.log("Initializing library");
Janus.initDone=!0;window.onbeforeunload=function(){Janus.log("Closing window");for(var b in Janus.sessions)null!==Janus.sessions[b]&&void 0!==Janus.sessions[b]&&Janus.sessions[b].destroyOnUnload&&(Janus.log("Destroying session "+b),Janus.sessions[b].destroy())}}};Janus.isWebrtcSupported=function(){return null===adapter.RTCPeerConnection||null===adapter.getUserMedia?!1:!0};
function Janus(b){function d(b){charSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var c="",d=0;d<b;d++)var e=Math.floor(Math.random()*charSet.length),c=c+charSet.substring(e,e+1);return c}function c(){if(null!=D)if(Janus.debug("Long poll..."),K){var b=L+"/"+D+"?rid="+(new Date).getTime();void 0!==v&&null!==v&&(b=b+"&maxev="+v);null!==z&&void 0!==z&&(b=b+"&token="+z);null!==M&&void 0!==M&&(b=b+"&apisecret="+M);$.ajax({type:"GET",url:b,cache:!1,timeout:6E4,success:f,error:function(b,
d,e){X++;3<X?K=!1:c()},dataType:"json"})}else Janus.warn("Is the gateway down? (connected=false)")}function f(b){X=0;Y||void 0===D||null===D||setTimeout(c,200);Janus.debug("Got event on session "+D);Janus.debug(b);if(!Y&&$.isArray(b))for(var d=0;d<b.length;d++)f(b[d]);else if("keepalive"!==b.janus)if("ack"===b.janus){if(d=b.transaction,null!==d&&void 0!==d){var e=I[d];null!==e&&void 0!==e&&e(b);delete I[d]}}else"success"===b.janus?(d=b.transaction,null!==d&&void 0!==d&&(e=I[d],null!==e&&void 0!==
e&&e(b),delete I[d])):"webrtcup"!==b.janus&&("hangup"===b.janus?(e=b.sender,void 0===e||null===e?Janus.warn("Missing sender..."):(e=N[e],void 0===e||null===e?Janus.warn("This handle is not attached to this session"):e.hangup())):"detached"===b.janus?(e=b.sender,void 0===e||null===e?Janus.warn("Missing sender..."):(e=N[e],void 0===e||null===e?Janus.warn("This handle is not attached to this session"):(e.ondetached(),e.detach()))):"error"===b.janus?(Janus.error("Ooops: "+b.error.code+" "+b.error.reason),
d=b.transaction,null!==d&&void 0!==d&&(e=I[d],null!==e&&void 0!==e&&e(b),delete I[d])):"event"===b.janus?(e=b.sender,void 0===e||null===e?Janus.warn("Missing sender..."):(d=b.plugindata,void 0===d||null===d?Janus.warn("Missing plugindata..."):(Janus.debug("  -- Event is coming from "+e+" ("+d.plugin+")"),d=d.data,Janus.debug(d),e=N[e],void 0===e||null===e?Janus.warn("This handle is not attached to this session"):(b=b.jsep,void 0!==b&&null!==b&&(Janus.debug("Handling SDP as well..."),Janus.debug(b)),
e=e.onmessage,null!==e&&void 0!==e?(Janus.debug("Notifying application..."),e(d,b)):Janus.debug("No provided notification callback"))))):Janus.warn("Unknown message '"+b.janus+"'"))}function e(){if(null!==L&&Y&&K){ba=setTimeout(e,3E4);var b={janus:"keepalive",session_id:D,transaction:d(12)};null!==z&&void 0!==z&&(b.token=z);null!==M&&void 0!==M&&(b.apisecret=a);O.send(JSON.stringify(b))}}function g(h){var l=d(12),m={janus:"create",transaction:l};null!==z&&void 0!==z&&(m.token=z);null!==M&&void 0!==
M&&(m.apisecret=M);null===L&&$.isArray(S)&&(L=S[P],0===L.indexOf("ws")?(Y=!0,Janus.log("Server #"+(P+1)+": trying WebSockets to contact Janus ("+L+")")):(Y=!1,Janus.log("Server #"+(P+1)+": trying REST API to contact Janus ("+L+")")));if(Y)for(eventName in O=new WebSocket(L,"janus-protocol"),E={error:function(){Janus.error("Error connecting to the Janus WebSockets server... "+L);$.isArray(S)?(P++,P==S.length?h.error("Error connecting to any of the provided Janus servers: Is the gateway down?"):(L=
null,setTimeout(function(){g(h)},200))):h.error("Error connecting to the Janus WebSockets server: Is the gateway down?")},open:function(){I[l]=function(b){Janus.debug(b);"success"!==b.janus?(Janus.error("Ooops: "+b.error.code+" "+b.error.reason),h.error(b.error.reason)):(ba=setTimeout(e,3E4),K=!0,D=b.data.id,Janus.log("Created session: "+D),Janus.sessions[D]=ka,h.success())};O.send(JSON.stringify(m))},message:function(b){f(JSON.parse(b.data))},close:function(){null!==L&&K&&(K=!1,b.error("Lost connection to the gateway (is it down?)"))}},
E)O.addEventListener(eventName,E[eventName]);else $.ajax({type:"POST",url:L,cache:!1,contentType:"application/json",data:JSON.stringify(m),success:function(b){Janus.debug(b);"success"!==b.janus?(Janus.error("Ooops: "+b.error.code+" "+b.error.reason),h.error(b.error.reason)):(K=!0,D=b.data.id,Janus.log("Created session: "+D),Janus.sessions[D]=ka,c(),h.success())},error:function(b,c,d){Janus.error(c+": "+d);$.isArray(S)?(P++,P==S.length?h.error("Error connecting to any of the provided Janus servers: Is the gateway down?"):
(L=null,setTimeout(function(){g(h)},200))):""===d?h.error(c+": Is the gateway down?"):h.error(c+": "+d)},dataType:"json"})}function h(c,e){e=!0===e;Janus.log("Destroying session "+D+" (sync="+e+")");c=c||{};c.success="function"==typeof c.success?c.success:jQuery.noop;if(K)if(void 0===D||null===D)Janus.warn("No session to destroy"),c.success(),b.destroyed();else{delete Janus.sessions[D];for(ph in N){var f=N[ph];Janus.log("Destroying handle "+f.id+" ("+f.plugin+")");t(f.id,null,e)}var g={janus:"destroy",
transaction:d(12)};null!==z&&void 0!==z&&(g.token=z);null!==M&&void 0!==M&&(g.apisecret=M);if(Y){g.session_id=D;var h=function(){for(eventName in E)O.removeEventListener(eventName,E[eventName]);O.removeEventListener("message",l);O.removeEventListener("error",m);ba&&clearTimeout(ba)},l=function(d){d=JSON.parse(d.data);d.session_id==g.session_id&&d.transaction==g.transaction&&(h(),c.success(),b.destroyed())},m=function(d){h();c.error("Failed to destroy the gateway: Is the gateway down?");b.destroyed()};
O.addEventListener("message",l);O.addEventListener("error",m);O.send(JSON.stringify(g))}else $.ajax({type:"POST",url:L+"/"+D,async:e,cache:!1,contentType:"application/json",data:JSON.stringify(g),success:function(d){Janus.log("Destroyed session:");Janus.debug(d);D=null;K=!1;"success"!==d.janus&&Janus.error("Ooops: "+d.error.code+" "+d.error.reason);c.success();b.destroyed()},error:function(d,e,f){Janus.error(e+": "+f);D=null;K=!1;c.success();b.destroyed()},dataType:"json"})}else Janus.warn("Is the gateway down? (connected=false)"),
c.success()}function l(b){b=b||{};b.success="function"==typeof b.success?b.success:jQuery.noop;b.error="function"==typeof b.error?b.error:jQuery.noop;b.consentDialog="function"==typeof b.consentDialog?b.consentDialog:jQuery.noop;b.onmessage="function"==typeof b.onmessage?b.onmessage:jQuery.noop;b.onlocalstream="function"==typeof b.onlocalstream?b.onlocalstream:jQuery.noop;b.onremotestream="function"==typeof b.onremotestream?b.onremotestream:jQuery.noop;b.ondata="function"==typeof b.ondata?b.ondata:
jQuery.noop;b.ondataopen="function"==typeof b.ondataopen?b.ondataopen:jQuery.noop;b.oncleanup="function"==typeof b.oncleanup?b.oncleanup:jQuery.noop;b.ondetached="function"==typeof b.ondetached?b.ondetached:jQuery.noop;if(K){var c=b.plugin;if(void 0===c||null===c)Janus.error("Invalid plugin"),b.error("Invalid plugin");else{var e=d(12),f={janus:"attach",plugin:c,transaction:e};null!==z&&void 0!==z&&(f.token=z);null!==M&&void 0!==M&&(f.apisecret=M);Y?(I[e]=function(d){Janus.debug(d);if("success"!==
d.janus)Janus.error("Ooops: "+d.error.code+" "+d.error.reason),b.error("Ooops: "+d.error.code+" "+d.error.reason);else{var e=d.data.id;Janus.log("Created handle: "+e);d={session:ka,plugin:c,id:e,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,pc:null,dataChannel:null,dtmfSender:null,trickle:!0,iceDone:!1,sdpSent:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return e},getPlugin:function(){return c},
getVolume:function(){return H(e)},isAudioMuted:function(){return y(e,!1)},muteAudio:function(){return F(e,!1,!0)},unmuteAudio:function(){return F(e,!1,!1)},isVideoMuted:function(){return y(e,!0)},muteVideo:function(){return F(e,!0,!0)},unmuteVideo:function(){return F(e,!0,!1)},getBitrate:function(){return W(e)},send:function(b){m(e,b)},data:function(b){r(e,b)},dtmf:function(b){p(e,b)},consentDialog:b.consentDialog,onmessage:b.onmessage,createOffer:function(b){u(e,b)},createAnswer:function(b){u(e,
b)},handleRemoteJsep:function(b){w(e,b)},onlocalstream:b.onlocalstream,onremotestream:b.onremotestream,ondata:b.ondata,ondataopen:b.ondataopen,oncleanup:b.oncleanup,ondetached:b.ondetached,hangup:function(){T(e)},detach:function(b){t(e,b)}};N[e]=d;b.success(d)}},f.session_id=D,O.send(JSON.stringify(f))):$.ajax({type:"POST",url:L+"/"+D,cache:!1,contentType:"application/json",data:JSON.stringify(f),success:function(d){Janus.debug(d);if("success"!==d.janus)Janus.error("Ooops: "+d.error.code+" "+d.error.reason),
b.error("Ooops: "+d.error.code+" "+d.error.reason);else{var e=d.data.id;Janus.log("Created handle: "+e);d={session:ka,plugin:c,id:e,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,pc:null,dataChannel:null,dtmfSender:null,trickle:!0,iceDone:!1,sdpSent:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return e},getPlugin:function(){return c},getVolume:function(){return H(e)},isAudioMuted:function(){return y(e,
!1)},muteAudio:function(){return F(e,!1,!0)},unmuteAudio:function(){return F(e,!1,!1)},isVideoMuted:function(){return y(e,!0)},muteVideo:function(){return F(e,!0,!0)},unmuteVideo:function(){return F(e,!0,!1)},getBitrate:function(){return W(e)},send:function(b){m(e,b)},data:function(b){r(e,b)},dtmf:function(b){p(e,b)},consentDialog:b.consentDialog,onmessage:b.onmessage,createOffer:function(b){u(e,b)},createAnswer:function(b){u(e,b)},handleRemoteJsep:function(b){w(e,b)},onlocalstream:b.onlocalstream,
onremotestream:b.onremotestream,ondata:b.ondata,ondataopen:b.ondataopen,oncleanup:b.oncleanup,ondetached:b.ondetached,hangup:function(){T(e)},detach:function(b){t(e,b)}};N[e]=d;b.success(d)}},error:function(b,c,d){Janus.error(c+": "+d)},dataType:"json"})}}else Janus.warn("Is the gateway down? (connected=false)"),b.error("Is the gateway down? (connected=false)")}function m(b,c){c=c||{};c.success="function"==typeof c.success?c.success:jQuery.noop;c.error="function"==typeof c.error?c.error:jQuery.noop;
if(K){var e=c.message,f=c.jsep,g=d(12),e={janus:"message",body:e,transaction:g};null!==z&&void 0!==z&&(e.token=z);null!==M&&void 0!==M&&(e.apisecret=M);null!==f&&void 0!==f&&(e.jsep=f);Janus.debug("Sending message to plugin (handle="+b+"):");Janus.debug(e);Y?(e.session_id=D,e.handle_id=b,I[g]=function(b){Janus.debug("Message sent!");Janus.debug(b);"success"===b.janus?(b=b.plugindata,void 0===b||null===b?(Janus.warn("Request succeeded, but missing plugindata..."),c.success()):(Janus.log("Synchronous transaction successful ("+
b.plugin+")"),b=b.data,Janus.debug(b),c.success(b))):"ack"!==b.janus?void 0!==b.error&&null!==b.error?(Janus.error("Ooops: "+b.error.code+" "+b.error.reason),c.error(b.error.code+" "+b.error.reason)):(Janus.error("Unknown error"),c.error("Unknown error")):c.success()},O.send(JSON.stringify(e))):$.ajax({type:"POST",url:L+"/"+D+"/"+b,cache:!1,contentType:"application/json",data:JSON.stringify(e),success:function(b){Janus.debug("Message sent!");Janus.debug(b);"success"===b.janus?(b=b.plugindata,void 0===
b||null===b?(Janus.warn("Request succeeded, but missing plugindata..."),c.success()):(Janus.log("Synchronous transaction successful ("+b.plugin+")"),b=b.data,Janus.debug(b),c.success(b))):"ack"!==b.janus?void 0!==b.error&&null!==b.error?(Janus.error("Ooops: "+b.error.code+" "+b.error.reason),c.error(b.error.code+" "+b.error.reason)):(Janus.error("Unknown error"),c.error("Unknown error")):c.success()},error:function(b,d,e){Janus.error(d+": "+e);c.error(d+": "+e)},dataType:"json"})}else Janus.warn("Is the gateway down? (connected=false)"),
c.error("Is the gateway down? (connected=false)")}function q(b,c){if(K){var e={janus:"trickle",candidate:c,transaction:d(12)};null!==z&&void 0!==z&&(e.token=z);null!==M&&void 0!==M&&(e.apisecret=M);Janus.debug("Sending trickle candidate (handle="+b+"):");Janus.debug(e);Y?(e.session_id=D,e.handle_id=b,O.send(JSON.stringify(e))):$.ajax({type:"POST",url:L+"/"+D+"/"+b,cache:!1,contentType:"application/json",data:JSON.stringify(e),success:function(b){Janus.debug("Candidate sent!");Janus.debug(b);"ack"!==
b.janus&&Janus.error("Ooops: "+b.error.code+" "+b.error.reason)},error:function(b,c,d){Janus.error(c+": "+d)},dataType:"json"})}else Janus.warn("Is the gateway down? (connected=false)")}function r(b,c){c=c||{};c.success="function"==typeof c.success?c.success:jQuery.noop;c.error="function"==typeof c.error?c.error:jQuery.noop;var d=N[b];if(null===d||void 0===d||null===d.webrtcStuff||void 0===d.webrtcStuff)Janus.warn("Invalid handle"),c.error("Invalid handle");else{var d=d.webrtcStuff,e=c.text;null===
e||void 0===e?(Janus.warn("Invalid text"),c.error("Invalid text")):(Janus.log("Sending string on data channel: "+e),d.dataChannel.send(e),c.success())}}function p(b,c){c=c||{};c.success="function"==typeof c.success?c.success:jQuery.noop;c.error="function"==typeof c.error?c.error:jQuery.noop;var d=N[b];if(null===d||void 0===d||null===d.webrtcStuff||void 0===d.webrtcStuff)Janus.warn("Invalid handle"),c.error("Invalid handle");else{d=d.webrtcStuff;if(null===d.dtmfSender||void 0===d.dtmfSender){if(void 0!==
d.myStream&&null!==d.myStream){var e=d.myStream.getAudioTracks();null!==e&&void 0!==e&&0<e.length&&(d.dtmfSender=d.pc.createDTMFSender(e[0]),Janus.log("Created DTMF Sender"),d.dtmfSender.ontonechange=function(b){Janus.debug("Sent DTMF tone: "+b.tone)})}if(null===d.dtmfSender||void 0===d.dtmfSender){Janus.warn("Invalid DTMF configuration");c.error("Invalid DTMF configuration");return}}var f=c.dtmf;if(null===f||void 0===f)Janus.warn("Invalid DTMF parameters"),c.error("Invalid DTMF parameters");else if(e=
f.tones,null===e||void 0===e)Janus.warn("Invalid DTMF string"),c.error("Invalid DTMF string");else{var g=f.duration;if(null===g||void 0===g)g=500;f=f.gap;if(null===f||void 0===f)f=50;Janus.debug("Sending DTMF string "+e+" (duration "+g+"ms, gap "+f+"ms");d.dtmfSender.insertDTMF(e,g,f)}}}function t(b,c,e){e=!0===e;Janus.log("Destroying handle "+b+" (sync="+e+")");c=c||{};c.success="function"==typeof c.success?c.success:jQuery.noop;c.error="function"==typeof c.error?c.error:jQuery.noop;T(b);if(K){var f=
{janus:"detach",transaction:d(12)};null!==z&&void 0!==z&&(f.token=z);null!==M&&void 0!==M&&(f.apisecret=M);Y?(f.session_id=D,f.handle_id=b,O.send(JSON.stringify(f)),delete N[b],c.success()):$.ajax({type:"POST",url:L+"/"+D+"/"+b,async:e,cache:!1,contentType:"application/json",data:JSON.stringify(f),success:function(d){Janus.log("Destroyed handle:");Janus.debug(d);"success"!==d.janus&&Janus.error("Ooops: "+d.error.code+" "+d.error.reason);delete N[b];c.success()},error:function(d,e,f){Janus.error(e+
": "+f);delete N[b];c.success()},dataType:"json"})}else Janus.warn("Is the gateway down? (connected=false)"),c.error("Is the gateway down? (connected=false)")}function s(b,c,d,e,f){var g=N[b];if(null===g||void 0===g||null===g.webrtcStuff||void 0===g.webrtcStuff)Janus.warn("Invalid handle"),e.error("Invalid handle");else{var h=g.webrtcStuff;Janus.debug("streamsDone:",f);h.myStream=f;var l={iceServers:ga},m={optional:[{DtlsSrtpKeyAgreement:!0}]};!0===B&&m.optional.push({googIPv6:!0});Janus.log("Creating PeerConnection");
Janus.debug(m);h.pc=new RTCPeerConnection(_.extend(l,{rtcpMuxPolicy:"negotiate"}),m);Janus.debug(h.pc);h.pc.getStats&&(h.volume.value=0,h.bitrate.value="0 kbits/sec");Janus.log("Preparing local SDP and gathering candidates (trickle="+h.trickle+")");h.pc.onicecandidate=function(c){if(null==c.candidate||"edge"===adapter.webrtcDetectedBrowser&&0<c.candidate.candidate.indexOf("endOfCandidates"))if(Janus.log("End of candidates."),h.iceDone=!0,!0===h.trickle)q(b,{completed:!0});else{c=(c=e)||{};c.success=
"function"==typeof c.success?c.success:jQuery.noop;c.error="function"==typeof c.error?c.error:jQuery.noop;var d=N[b];null===d||void 0===d||null===d.webrtcStuff||void 0===d.webrtcStuff?Janus.warn("Invalid handle, not sending anything"):(d=d.webrtcStuff,Janus.log("Sending offer/answer SDP..."),null===d.mySdp||void 0===d.mySdp?Janus.warn("Local SDP instance is invalid, not sending anything..."):(d.mySdp=d.pc.localDescription,d.sdpSent?Janus.log("Offer/Answer SDP already sent, not sending it again"):
(Janus.debug(c),d.sdpSent=!0,c.success(d.mySdp))))}else c={candidate:c.candidate.candidate,sdpMid:c.candidate.sdpMid,sdpMLineIndex:c.candidate.sdpMLineIndex},Janus.debug("candidates: "+JSON.stringify(c)),!0===h.trickle&&q(b,c)};null!==f&&void 0!==f&&(Janus.log("Adding local stream"),h.pc.addStream(f),g.onlocalstream(f));h.pc.onaddstream=function(b){Janus.log("Handling Remote Stream");Janus.debug(b);h.remoteStream=b;g.onremotestream(b.stream)};R(d)&&(Janus.log("Creating data channel"),f=function(){var b=
null!==h.dataChannel?h.dataChannel.readyState:"null";Janus.log("State change on data channel: "+b);if("open"===b)g.ondataopen()},h.dataChannel=h.pc.createDataChannel("JanusDataChannel",{ordered:!1}),h.dataChannel.onmessage=function(b){Janus.log("Received message on data channel: "+b.data);g.ondata(b.data)},h.dataChannel.onopen=f,h.dataChannel.onclose=f,h.dataChannel.onerror=function(b){Janus.error("Got error on data channel:",b)});null===c||void 0===c?A(b,d,e):h.pc.setRemoteDescription(new RTCSessionDescription(c),
function(){Janus.log("Remote description accepted!");n(b,d,e)},e.error)}}function u(b,c){c=c||{};c.success="function"==typeof c.success?c.success:jQuery.noop;c.error="function"==typeof c.error?c.error:ca;var d=c.jsep,e=c.media,f=N[b];if(null===f||void 0===f||null===f.webrtcStuff||void 0===f.webrtcStuff)Janus.warn("Invalid handle"),c.error("Invalid handle");else{var g=f.webrtcStuff;if(void 0!==g.pc&&null!==g.pc)Janus.log("Updating existing media session"),null===d||void 0===d?A(b,e,c):g.pc.setRemoteDescription(new RTCSessionDescription(d),
function(){Janus.log("Remote description accepted!");n(b,e,c)},c.error);else if(null!==c.stream&&void 0!==c.stream){var h=c.stream;Janus.log("MediaStream provided by the application");Janus.debug(h);g.streamExternal=!0;s(b,d,e,c,h)}else if(g.trickle=U(c.trickle),Q(e)||V(e)){var l={mandatory:{},optional:[]};f.consentDialog(!0);var m=V(e);if(!0===m&&void 0!=e&&null!=e)if(e.video&&"screen"!=e.video){var p=h=g=0;if("lowres"===e.video)p=h=240,g=320;else if("lowres-16:9"===e.video)p=h=180,g=320;else if("hires"===
e.video||"hires-16:9"===e.video){if(p=h=720,g=1280,navigator.mozGetUserMedia){var q=parseInt(window.navigator.userAgent.match(/Firefox\/(.*)/)[1],10);38>q&&(Janus.warn(e.video+" unsupported, falling back to stdres (old Firefox)"),p=h=480,g=640)}}else"stdres"===e.video?p=h=480:"stdres-16:9"===e.video?p=h=360:(Janus.log("Default video setting ("+e.video+") is stdres 4:3"),p=h=480),g=640;Janus.log("Adding media constraint "+e.video);navigator.mozGetUserMedia?(q=parseInt(window.navigator.userAgent.match(/Firefox\/(.*)/)[1],
10),m=38>q?{require:["height","width"],height:{max:p,min:h},width:{max:g,min:g}}:{height:{ideal:h},width:{ideal:g}}):m={mandatory:{maxHeight:p,minHeight:h,maxWidth:g,minWidth:g},optional:[]};Janus.debug(m)}else if("screen"===e.video){var r=function(b,c){Janus.log("Adding media constraint (screen capture)");Janus.debug(b);adapter.getUserMedia(b,function(b){c(null,b)},function(b){f.consentDialog(!1);c(b)})},t=function(g,h){f.consentDialog(!1);g?c.error(g):s(b,d,e,c,h)};if("https:"!==window.location.protocol){Janus.warn("Screen sharing only works on HTTPS, try the https:// version of this page");
f.consentDialog(!1);c.error("Screen sharing only works on HTTPS, try the https:// version of this page");return}var u={};if(window.navigator.userAgent.match("Chrome"))g=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),h=33,window.navigator.userAgent.match("Linux")&&(h=35),26<=g&&g<=h?(l={video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3,chromeMediaSource:"screen"}},audio:Q(e)},r(l,t)):(g=window.setTimeout(function(){w=
Error("NavigatorUserMediaError");w.name='The required Chrome extension is not installed: click <a href="#">here</a> to install it. (NOTE: this will need you to refresh the page)';f.consentDialog(!1);return c.error(w)},1E3),u[g]=[t,null],window.postMessage({type:"janusGetScreen",id:g},"*"));else if(window.navigator.userAgent.match("Firefox"))if(33<=parseInt(window.navigator.userAgent.match(/Firefox\/(.*)/)[1],10))l={video:{mozMediaSource:"window",mediaSource:"window"},audio:Q(e)},r(l,function(b,c){t(b,
c);if(!b)var d=c.currentTime,e=window.setInterval(function(){c||window.clearInterval(e);if(c.currentTime==d&&(window.clearInterval(e),c.onended))c.onended();d=c.currentTime},500)});else{var w=Error("NavigatorUserMediaError");w.name="Your version of Firefox does not support screen sharing, please install Firefox 33 (or more recent versions)";f.consentDialog(!1);c.error(w);return}window.addEventListener("message",function(b){if(b.origin==window.location.origin)if("janusGotScreen"==b.data.type&&u[b.data.id]){var d=
u[b.data.id][0];delete u[b.data.id];""===b.data.sourceId?(b=Error("NavigatorUserMediaError"),b.name="You cancelled the request for permission, giving up...",f.consentDialog(!1),c.error(b)):(l={audio:Q(e),video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},l.video.mandatory.chromeMediaSourceId=b.data.sourceId,r(l,d))}else"janusGetScreenPending"==b.data.type&&window.clearTimeout(b.data.id)})}null!==
e&&void 0!==e&&"screen"===e.video||MediaStreamTrack.getSources(function(g){var h=g.some(function(b){return"audio"===b.kind});g=g.some(function(b){return"video"===b.kind});if(!h&&!g)return f.consentDialog(!1),c.error("No capture device found"),!1;adapter.getUserMedia({audio:h&&Q(e),video:g?m:!1},function(g){f.consentDialog(!1);s(b,d,e,c,g)},function(b){f.consentDialog(!1);c.error(b)})})}else s(b,d,e,c)}}function w(b,c){c=c||{};c.success="function"==typeof c.success?c.success:jQuery.noop;c.error="function"==
typeof c.error?c.error:ca;var d=c.jsep,e=N[b];null===e||void 0===e||null===e.webrtcStuff||void 0===e.webrtcStuff?(Janus.warn("Invalid handle"),c.error("Invalid handle")):(e=e.webrtcStuff,void 0!==d&&null!==d?null===e.pc?(Janus.warn("Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep"),c.error("No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep")):e.pc.setRemoteDescription(new RTCSessionDescription(d),function(){Janus.log("Remote description accepted!");
c.success()},c.error):c.error("Invalid JSEP"))}function A(b,c,d){d=d||{};d.success="function"==typeof d.success?d.success:jQuery.noop;d.error="function"==typeof d.error?d.error:jQuery.noop;b=N[b];if(null===b||void 0===b||null===b.webrtcStuff||void 0===b.webrtcStuff)Janus.warn("Invalid handle"),d.error("Invalid handle");else{var e=b.webrtcStuff;Janus.log("Creating offer (iceDone="+e.iceDone+")");b=null;b="firefox"==adapter.webrtcDetectedBrowser||"edge"==adapter.webrtcDetectedBrowser?{offerToReceiveAudio:G(c),
offerToReceiveVideo:C(c)}:{mandatory:{OfferToReceiveAudio:G(c),OfferToReceiveVideo:C(c)}};Janus.debug(b);e.pc.createOffer(function(b){Janus.debug(b);if(null===e.mySdp||void 0===e.mySdp)Janus.log("Setting local description"),e.mySdp=b.sdp,e.pc.setLocalDescription(b);e.iceDone||e.trickle?e.sdpSent?Janus.log("Offer already sent, not sending it again"):(Janus.log("Offer ready"),Janus.debug(d),e.sdpSent=!0,d.success({type:b.type,sdp:b.sdp})):Janus.log("Waiting for all candidates...")},d.error,b)}}function n(b,
c,d){d=d||{};d.success="function"==typeof d.success?d.success:jQuery.noop;d.error="function"==typeof d.error?d.error:jQuery.noop;b=N[b];if(null===b||void 0===b||null===b.webrtcStuff||void 0===b.webrtcStuff)Janus.warn("Invalid handle"),d.error("Invalid handle");else{var e=b.webrtcStuff;Janus.log("Creating answer (iceDone="+e.iceDone+")");b=null;b="firefox"==adapter.webrtcDetectedBrowser||"edge"==adapter.webrtcDetectedBrowser?{offerToReceiveAudio:G(c),offerToReceiveVideo:C(c)}:{mandatory:{OfferToReceiveAudio:G(c),
OfferToReceiveVideo:C(c)}};Janus.debug(b);e.pc.createAnswer(function(b){Janus.debug(b);if(null===e.mySdp||void 0===e.mySdp)Janus.log("Setting local description"),e.mySdp=b.sdp,e.pc.setLocalDescription(b);e.iceDone||e.trickle?e.sdpSent?Janus.log("Answer already sent, not sending it again"):(e.sdpSent=!0,d.success({type:b.type,sdp:b.sdp})):Janus.log("Waiting for all candidates...")},d.error,b)}}function H(b){b=N[b];if(null===b||void 0===b||null===b.webrtcStuff||void 0===b.webrtcStuff)return Janus.warn("Invalid handle"),
0;var c=b.webrtcStuff;if(c.pc.getStats&&"chrome"==adapter.webrtcDetectedBrowser)return null===c.remoteStream||void 0===c.remoteStream?(Janus.warn("Remote stream unavailable"),0):null===c.volume.timer||void 0===c.volume.timer?(Janus.log("Starting volume monitor"),c.volume.timer=setInterval(function(){c.pc.getStats(function(b){b=b.result();for(var d=0;d<b.length;d++){var e=b[d];"ssrc"==e.type&&e.stat("audioOutputLevel")&&(c.volume.value=e.stat("audioOutputLevel"))}})},200),0):c.volume.value;Janus.log("Getting the remote volume unsupported by browser");
return 0}function y(b,c){var d=N[b];if(null===d||void 0===d||null===d.webrtcStuff||void 0===d.webrtcStuff)return Janus.warn("Invalid handle"),!0;d=d.webrtcStuff;return null===d.pc||void 0===d.pc?(Janus.warn("Invalid PeerConnection"),!0):void 0===d.myStream||null===d.myStream?(Janus.warn("Invalid local MediaStream"),!0):c?null===d.myStream.getVideoTracks()||void 0===d.myStream.getVideoTracks()||0===d.myStream.getVideoTracks().length?(Janus.warn("No video track"),!0):!d.myStream.getVideoTracks()[0].enabled:
null===d.myStream.getAudioTracks()||void 0===d.myStream.getAudioTracks()||0===d.myStream.getAudioTracks().length?(Janus.warn("No audio track"),!0):!d.myStream.getAudioTracks()[0].enabled}function F(b,c,d){b=N[b];if(null===b||void 0===b||null===b.webrtcStuff||void 0===b.webrtcStuff)return Janus.warn("Invalid handle"),!1;b=b.webrtcStuff;if(null===b.pc||void 0===b.pc)return Janus.warn("Invalid PeerConnection"),!1;if(void 0===b.myStream||null===b.myStream)return Janus.warn("Invalid local MediaStream"),
!1;if(c){if(null===b.myStream.getVideoTracks()||void 0===b.myStream.getVideoTracks()||0===b.myStream.getVideoTracks().length)return Janus.warn("No video track"),!1;b.myStream.getVideoTracks()[0].enabled=d?!1:!0}else{if(null===b.myStream.getAudioTracks()||void 0===b.myStream.getAudioTracks()||0===b.myStream.getAudioTracks().length)return Janus.warn("No audio track"),!1;b.myStream.getAudioTracks()[0].enabled=d?!1:!0}return!0}function W(b){b=N[b];if(null===b||void 0===b||null===b.webrtcStuff||void 0===
b.webrtcStuff)return Janus.warn("Invalid handle"),"Invalid handle";var c=b.webrtcStuff;if(null===c.pc||void 0===c.pc)return"Invalid PeerConnection";if(c.pc.getStats&&"chrome"==adapter.webrtcDetectedBrowser)return null===c.remoteStream||void 0===c.remoteStream?(Janus.warn("Remote stream unavailable"),"Remote stream unavailable"):null===c.bitrate.timer||void 0===c.bitrate.timer?(Janus.log("Starting bitrate timer (Chrome)"),c.bitrate.timer=setInterval(function(){c.pc.getStats(function(b){b=b.result();
for(var d=0;d<b.length;d++){var e=b[d];"ssrc"==e.type&&e.stat("googFrameHeightReceived")&&(c.bitrate.bsnow=e.stat("bytesReceived"),c.bitrate.tsnow=e.timestamp,null!==c.bitrate.bsbefore&&null!==c.bitrate.tsbefore&&(e=Math.round(8*(c.bitrate.bsnow-c.bitrate.bsbefore)/(c.bitrate.tsnow-c.bitrate.tsbefore)),c.bitrate.value=e+" kbits/sec"),c.bitrate.bsbefore=c.bitrate.bsnow,c.bitrate.tsbefore=c.bitrate.tsnow)}})},1E3),"0 kbits/sec"):c.bitrate.value;if(c.pc.getStats&&"firefox"==adapter.webrtcDetectedBrowser){if(null===
c.remoteStream||void 0===c.remoteStream||null===c.remoteStream.stream||void 0===c.remoteStream.stream)return Janus.warn("Remote stream unavailable"),"Remote stream unavailable";var d=c.remoteStream.stream.getVideoTracks();return null===d||void 0===d||1>d.length?(Janus.warn("No video track"),"No video track"):null===c.bitrate.timer||void 0===c.bitrate.timer?(Janus.log("Starting bitrate timer (Firefox)"),c.bitrate.timer=setInterval(function(){var b=function(b){null===b||void 0===b||null==b.inbound_rtp_video_1||
null==b.inbound_rtp_video_1?c.bitrate.value="Missing inbound_rtp_video_1":(c.bitrate.bsnow=b.inbound_rtp_video_1.bytesReceived,c.bitrate.tsnow=b.inbound_rtp_video_1.timestamp,null!==c.bitrate.bsbefore&&null!==c.bitrate.tsbefore&&(b=Math.round(8*(c.bitrate.bsnow-c.bitrate.bsbefore)/(c.bitrate.tsnow-c.bitrate.tsbefore)),c.bitrate.value=b+" kbits/sec"),c.bitrate.bsbefore=c.bitrate.bsnow,c.bitrate.tsbefore=c.bitrate.tsnow)};c.pc.getStats(d[0],function(c){b(c)},b)},1E3),"0 kbits/sec"):c.bitrate.value}Janus.warn("Getting the video bitrate unsupported by browser");
return"Feature unsupported by browser"}function ca(b){Janus.error("WebRTC error:",b)}function T(b){Janus.log("Cleaning WebRTC stuff");b=N[b];if(null!==b&&void 0!==b){var c=b.webrtcStuff;if(null!==c&&void 0!==c){c.remoteStream=null;c.volume.timer&&clearInterval(c.volume.timer);c.volume.value=null;c.bitrate.timer&&clearInterval(c.bitrate.timer);c.bitrate.timer=null;c.bitrate.bsnow=null;c.bitrate.bsbefore=null;c.bitrate.tsnow=null;c.bitrate.tsbefore=null;c.bitrate.value=null;try{c.streamExternal||null===
c.myStream||void 0===c.myStream||(Janus.log("Stopping local stream"),c.myStream.stop())}catch(d){}try{if(!c.streamExternal&&null!==c.myStream&&void 0!==c.myStream){Janus.log("Stopping local stream tracks");var e=c.myStream.getTracks(),f;for(f in e){var g=e[f];Janus.log(g);null!==g&&void 0!==g&&g.stop()}}}catch(h){}c.streamExternal=!1;c.myStream=null;try{c.pc.close()}catch(l){}c.pc=null;c.mySdp=null;c.iceDone=!1;c.sdpSent=!1;c.dataChannel=null;c.dtmfSender=null}b.oncleanup()}}function Q(b){Janus.debug("isAudioSendEnabled:",
b);return void 0===b||null===b?!0:!1===b.audio?!1:void 0===b.audioSend||null===b.audioSend?!0:!0===b.audioSend}function G(b){Janus.debug("isAudioRecvEnabled:",b);return void 0===b||null===b?!0:!1===b.audio?!1:void 0===b.audioRecv||null===b.audioRecv?!0:!0===b.audioRecv}function V(b){Janus.debug("isVideoSendEnabled:",b);return"edge"==adapter.webrtcDetectedBrowser?(Janus.warn("Edge doesn't support compatible video yet"),!1):void 0===b||null===b?!0:!1===b.video?!1:void 0===b.videoSend||null===b.videoSend?
!0:!0===b.videoSend}function C(b){Janus.debug("isVideoRecvEnabled:",b);return"edge"==adapter.webrtcDetectedBrowser?(Janus.warn("Edge doesn't support compatible video yet"),!1):void 0===b||null===b?!0:!1===b.video?!1:void 0===b.videoRecv||null===b.videoRecv?!0:!0===b.videoRecv}function R(b){Janus.debug("isDataEnabled:",b);return"edge"==adapter.webrtcDetectedBrowser?(Janus.warn("Edge doesn't support data channels yet"),!1):void 0===b||null===b?!1:!0===b.data}function U(b){Janus.debug("isTrickleEnabled:",
b);return void 0===b||null===b?!0:!0===b}if(void 0===Janus.initDone)return b.error("Library not initialized"),{};if(!Janus.isWebrtcSupported())return b.error("WebRTC not supported by this browser"),{};Janus.log("Library initialized: "+Janus.initDone);b=b||{};b.success="function"==typeof b.success?b.success:jQuery.noop;b.error="function"==typeof b.error?b.error:jQuery.noop;b.destroyed="function"==typeof b.destroyed?b.destroyed:jQuery.noop;if(null===b.server||void 0===b.server)return b.error("Invalid gateway url"),
{};var Y=!1,O=null,E={},ba=null,S=null,P=0,L=b.server;$.isArray(L)?(Janus.log("Multiple servers provided ("+L.length+"), will use the first that works"),L=null,S=b.server,Janus.debug(S)):0===L.indexOf("ws")?(Y=!0,Janus.log("Using WebSockets to contact Janus: "+L)):(Y=!1,Janus.log("Using REST API to contact Janus: "+L));var ga=b.iceServers;if(void 0===ga||null===ga)ga=[{url:"stun:stun.l.google.com:19302"}];var B=b.ipv6;if(void 0===B||null===B)B=!1;var v=null;void 0!==b.max_poll_events&&null!==b.max_poll_events&&
(v=b.max_poll_events);1>v&&(v=1);var z=null;void 0!==b.token&&null!==b.token&&(z=b.token);var M=null;void 0!==b.apisecret&&null!==b.apisecret&&(M=b.apisecret);this.destroyOnUnload=!0;void 0!==b.destroyOnUnload&&null!==b.destroyOnUnload&&(this.destroyOnUnload=!0===b.destroyOnUnload);var K=!1,D=null,N={},ka=this,X=0,I={};g(b);this.getServer=function(){return L};this.isConnected=function(){return K};this.getSessionId=function(){return D};this.destroy=function(b){h(b)};this.attach=function(b){l(b)}};(function(b){"object"===typeof exports&&"undefined"!==typeof module?module.exports=b():"function"===typeof define&&define.amd?define([],b):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).adapter=b()})(function(){return function d(c,f,e){function g(l,q){if(!f[l]){if(!c[l]){var r="function"==typeof require&&require;if(!q&&r)return r(l,!0);if(h)return h(l,!0);r=Error("Cannot find module '"+l+"'");throw r.code="MODULE_NOT_FOUND",r;}r=f[l]={exports:{}};
c[l][0].call(r.exports,function(d){var e=c[l][1][d];return g(e?e:d)},r,r.exports,d,c,f,e)}return f[l].exports}for(var h="function"==typeof require&&require,l=0;l<e.length;l++)g(e[l]);return g}({1:[function(d,c,f){var e={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};e.localCName=e.generateIdentifier();e.splitLines=function(c){return c.trim().split("\n").map(function(c){return c.trim()})};e.splitSections=function(c){return c.split("\nm=").map(function(c,d){return(0<
d?"m="+c:c).trim()+"\r\n"})};e.matchPrefix=function(c,d){return e.splitLines(c).filter(function(c){return 0===c.indexOf(d)})};e.parseCandidate=function(c){c=0===c.indexOf("a=candidate:")?c.substring(12).split(" "):c.substring(10).split(" ");for(var d={foundation:c[0],component:c[1],protocol:c[2].toLowerCase(),priority:parseInt(c[3],10),ip:c[4],port:parseInt(c[5],10),type:c[7]},e=8;e<c.length;e+=2)switch(c[e]){case "raddr":d.relatedAddress=c[e+1];break;case "rport":d.relatedPort=parseInt(c[e+1],10);
break;case "tcptype":d.tcpType=c[e+1]}return d};e.writeCandidate=function(c){var d=[];d.push(c.foundation);d.push(c.component);d.push(c.protocol.toUpperCase());d.push(c.priority);d.push(c.ip);d.push(c.port);var e=c.type;d.push("typ");d.push(e);"host"!==e&&c.relatedAddress&&c.relatedPort&&(d.push("raddr"),d.push(c.relatedAddress),d.push("rport"),d.push(c.relatedPort));c.tcpType&&"tcp"===c.protocol.toLowerCase()&&(d.push("tcptype"),d.push(c.tcpType));return"candidate:"+d.join(" ")};e.parseRtpMap=function(c){c=
c.substr(9).split(" ");var d={payloadType:parseInt(c.shift(),10)};c=c[0].split("/");d.name=c[0];d.clockRate=parseInt(c[1],10);d.numChannels=3===c.length?parseInt(c[2],10):1;return d};e.writeRtpMap=function(c){var d=c.payloadType;void 0!==c.preferredPayloadType&&(d=c.preferredPayloadType);return"a=rtpmap:"+d+" "+c.name+"/"+c.clockRate+(1!==c.numChannels?"/"+c.numChannels:"")+"\r\n"};e.parseExtmap=function(c){c=c.substr(9).split(" ");return{id:parseInt(c[0],10),uri:c[1]}};e.writeExtmap=function(c){return"a=extmap:"+
(c.id||c.preferredId)+" "+c.uri+"\r\n"};e.parseFmtp=function(c){for(var d={},e=c.substr(c.indexOf(" ")+1).split(";"),f=0;f<e.length;f++)c=e[f].trim().split("="),d[c[0].trim()]=c[1];return d};e.writeFmtp=function(c){var d="",e=c.payloadType;void 0!==c.preferredPayloadType&&(e=c.preferredPayloadType);if(c.parameters&&Object.keys(c.parameters).length){var f=[];Object.keys(c.parameters).forEach(function(d){f.push(d+"="+c.parameters[d])});d+="a=fmtp:"+e+" "+f.join(";")+"\r\n"}return d};e.parseRtcpFb=function(c){c=
c.substr(c.indexOf(" ")+1).split(" ");return{type:c.shift(),parameter:c.join(" ")}};e.writeRtcpFb=function(c){var d="",e=c.payloadType;void 0!==c.preferredPayloadType&&(e=c.preferredPayloadType);c.rtcpFeedback&&c.rtcpFeedback.length&&c.rtcpFeedback.forEach(function(c){d+="a=rtcp-fb:"+e+" "+c.type+(c.parameter&&c.parameter.length?" "+c.parameter:"")+"\r\n"});return d};e.parseSsrcMedia=function(c){var d=c.indexOf(" "),e={ssrc:parseInt(c.substr(7,d-7),10)},f=c.indexOf(":",d);-1<f?(e.attribute=c.substr(d+
1,f-d-1),e.value=c.substr(f+1)):e.attribute=c.substr(d+1);return e};e.getDtlsParameters=function(c,d){var f=e.splitLines(c),f=f.concat(e.splitLines(d)),f=f.filter(function(c){return 0===c.indexOf("a=fingerprint:")})[0].substr(14);return{role:"auto",fingerprints:[{algorithm:f.split(" ")[0],value:f.split(" ")[1]}]}};e.writeDtlsParameters=function(c,d){var e="a=setup:"+d+"\r\n";c.fingerprints.forEach(function(c){e+="a=fingerprint:"+c.algorithm+" "+c.value+"\r\n"});return e};e.getIceParameters=function(c,
d){var f=e.splitLines(c),f=f.concat(e.splitLines(d));return{usernameFragment:f.filter(function(c){return 0===c.indexOf("a=ice-ufrag:")})[0].substr(12),password:f.filter(function(c){return 0===c.indexOf("a=ice-pwd:")})[0].substr(10)}};e.writeIceParameters=function(c){return"a=ice-ufrag:"+c.usernameFragment+"\r\na=ice-pwd:"+c.password+"\r\n"};e.parseRtpParameters=function(c){for(var d={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},f=e.splitLines(c)[0].split(" "),m=3;m<f.length;m++){var q=
f[m],r=e.matchPrefix(c,"a=rtpmap:"+q+" ")[0];if(r){var r=e.parseRtpMap(r),p=e.matchPrefix(c,"a=fmtp:"+q+" ");r.parameters=p.length?e.parseFmtp(p[0]):{};r.rtcpFeedback=e.matchPrefix(c,"a=rtcp-fb:"+q+" ").map(e.parseRtcpFb);d.codecs.push(r);switch(r.name.toUpperCase()){case "RED":case "ULPFEC":d.fecMechanisms.push(r.name.toUpperCase())}}}e.matchPrefix(c,"a=extmap:").forEach(function(c){d.headerExtensions.push(e.parseExtmap(c))});return d};e.writeRtpDescription=function(c,d){var f="",f=f+("m="+c+" "),
f=f+(0<d.codecs.length?"9":"0"),f=f+" UDP/TLS/RTP/SAVPF ",f=f+(d.codecs.map(function(c){return void 0!==c.preferredPayloadType?c.preferredPayloadType:c.payloadType}).join(" ")+"\r\n"),f=f+"c=IN IP4 0.0.0.0\r\n",f=f+"a=rtcp:9 IN IP4 0.0.0.0\r\n";d.codecs.forEach(function(c){f+=e.writeRtpMap(c);f+=e.writeFmtp(c);f+=e.writeRtcpFb(c)});f+="a=rtcp-mux\r\n";d.headerExtensions.forEach(function(c){f+=e.writeExtmap(c)});return f};e.parseRtpEncodingParameters=function(c){var d=[],f=e.parseRtpParameters(c),
m=-1!==f.fecMechanisms.indexOf("RED"),q=-1!==f.fecMechanisms.indexOf("ULPFEC"),r=e.matchPrefix(c,"a=ssrc:").map(function(c){return e.parseSsrcMedia(c)}).filter(function(c){return"cname"===c.attribute}),p=0<r.length&&r[0].ssrc,t,r=e.matchPrefix(c,"a=ssrc-group:FID").map(function(c){c=c.split(" ");c.shift();return c.map(function(c){return parseInt(c,10)})});0<r.length&&1<r[0].length&&r[0][0]===p&&(t=r[0][1]);f.codecs.forEach(function(c){"RTX"===c.name.toUpperCase()&&c.parameters.apt&&(c={ssrc:p,codecPayloadType:parseInt(c.parameters.apt,
10),rtx:{payloadType:c.payloadType,ssrc:t}},d.push(c),m&&(c=JSON.parse(JSON.stringify(c)),c.fec={ssrc:t,mechanism:q?"red+ulpfec":"red"},d.push(c)))});0===d.length&&p&&d.push({ssrc:p});var s=e.matchPrefix(c,"b=");s.length&&(0===s[0].indexOf("b=TIAS:")?s=parseInt(s[0].substr(7),10):0===s[0].indexOf("b=AS:")&&(s=parseInt(s[0].substr(5),10)),d.forEach(function(c){c.maxBitrate=s}));return d};e.writeSessionBoilerplate=function(){return"v=0\r\no=thisisadapterortc 8169639915646943137 2 IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"};
e.writeMediaSection=function(c,d,f,m){d=e.writeRtpDescription(c.kind,d);d+=e.writeIceParameters(c.iceGatherer.getLocalParameters());d+=e.writeDtlsParameters(c.dtlsTransport.getLocalParameters(),"offer"===f?"actpass":"active");d+="a=mid:"+c.mid+"\r\n";d=c.rtpSender&&c.rtpReceiver?d+"a=sendrecv\r\n":c.rtpSender?d+"a=sendonly\r\n":c.rtpReceiver?d+"a=recvonly\r\n":d+"a=inactive\r\n";c.rtpSender&&(f="msid:"+m.id+" "+c.rtpSender.track.id+"\r\n",d=d+("a="+f)+("a=ssrc:"+c.sendEncodingParameters[0].ssrc+" "+
f));return d+="a=ssrc:"+c.sendEncodingParameters[0].ssrc+" cname:"+e.localCName+"\r\n"};e.getDirection=function(c,d){for(var f=e.splitLines(c),m=0;m<f.length;m++)switch(f[m]){case "a=sendrecv":case "a=sendonly":case "a=recvonly":case "a=inactive":return f[m].substr(2)}return d?e.getDirection(d):"sendrecv"};c.exports=e},{}],2:[function(d,c,f){f=d("./utils");var e=f.log,g=f.browserDetails;c.exports.browserDetails=g;c.exports.extractVersion=f.extractVersion;c.exports.disableLog=f.disableLog;var h=d("./chrome/chrome_shim")||
null,l=d("./edge/edge_shim")||null,m=d("./firefox/firefox_shim")||null;d=d("./safari/safari_shim")||null;switch(g.browser){case "chrome":if(!h||!h.shimPeerConnection){e("Chrome shim is not included in this adapter release.");break}e("adapter.js shimming chrome.");c.exports.browserShim=h;h.shimGetUserMedia();h.shimMediaStream();f.shimCreateObjectURL();h.shimSourceObject();h.shimPeerConnection();h.shimOnTrack();break;case "firefox":if(!m||!m.shimPeerConnection){e("Firefox shim is not included in this adapter release.");
break}e("adapter.js shimming firefox.");c.exports.browserShim=m;m.shimGetUserMedia();f.shimCreateObjectURL();m.shimSourceObject();m.shimPeerConnection();m.shimOnTrack();break;case "edge":if(!l||!l.shimPeerConnection){e("MS edge shim is not included in this adapter release.");break}e("adapter.js shimming edge.");c.exports.browserShim=l;l.shimGetUserMedia();f.shimCreateObjectURL();l.shimPeerConnection();break;case "safari":if(!d){e("Safari shim is not included in this adapter release.");break}e("adapter.js shimming safari.");
c.exports.browserShim=d;d.shimGetUserMedia();break;default:e("Unsupported browser!")}},{"./chrome/chrome_shim":3,"./edge/edge_shim":5,"./firefox/firefox_shim":7,"./safari/safari_shim":9,"./utils":10}],3:[function(d,c,f){var e=d("../utils.js").log,g=d("../utils.js").browserDetails;c.exports={shimMediaStream:function(){window.MediaStream=window.MediaStream||window.webkitMediaStream},shimOnTrack:function(){"object"!==typeof window||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||
Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(c){var d=this;this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly));this.addEventListener("track",this._ontrack=c);this.addEventListener("addstream",this._ontrackpoly=function(c){c.stream.addEventListener("addtrack",function(e){var f=new Event("track");f.track=e.track;f.receiver={track:e.track};f.streams=[c.stream];
d.dispatchEvent(f)});c.stream.getTracks().forEach(function(d){var e=new Event("track");e.track=d;e.receiver={track:d};e.streams=[c.stream];this.dispatchEvent(e)}.bind(this))}.bind(this))}})},shimSourceObject:function(){"object"===typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(c){var d=this;this._srcObject=c;this.src&&URL.revokeObjectURL(this.src);
c?(this.src=URL.createObjectURL(c),c.addEventListener("addtrack",function(){d.src&&URL.revokeObjectURL(d.src);d.src=URL.createObjectURL(c)}),c.addEventListener("removetrack",function(){d.src&&URL.revokeObjectURL(d.src);d.src=URL.createObjectURL(c)})):this.src=""}}))},shimPeerConnection:function(){window.RTCPeerConnection||(window.RTCPeerConnection=function(c,d){e("PeerConnection");c&&c.iceTransportPolicy&&(c.iceTransports=c.iceTransportPolicy);return new webkitRTCPeerConnection(c,d)},window.RTCPeerConnection.prototype=
webkitRTCPeerConnection.prototype,webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return webkitRTCPeerConnection.generateCertificate}}));var c=RTCPeerConnection.prototype.getStats;RTCPeerConnection.prototype.getStats=function(d,e,f){var g=this,l=arguments;if(0<arguments.length&&"function"===typeof d)return c.apply(this,arguments);if(0===c.length&&(0===arguments.length||"function"!==typeof arguments[0]))return c.apply(this,
[]);var s=function(c){var d={};c.result().forEach(function(c){var e={id:c.id,timestamp:c.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[c.type]||c.type};c.names().forEach(function(d){e[d]=c.stat(d)});d[e.id]=e});return d},u=function(c){return new Map(Object.keys(c).map(function(d){return[d,c[d]]}))};return 2<=arguments.length?c.apply(this,[function(c){l[1](u(s(c)))},arguments[0]]):(new Promise(function(d,e){c.apply(g,[function(c){d(u(s(c)))},e])})).then(e,f)};
51>g.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(c){var d=RTCPeerConnection.prototype[c];RTCPeerConnection.prototype[c]=function(){var c=arguments,e=this,f=new Promise(function(f,g){d.apply(e,[c[0],f,g])});return 2>c.length?f:f.then(function(){c[1].apply(null,[])},function(d){3<=c.length&&c[2].apply(null,[d])})}});52>g.version&&["createOffer","createAnswer"].forEach(function(c){var d=RTCPeerConnection.prototype[c];RTCPeerConnection.prototype[c]=function(){var c=
this;if(1>arguments.length||1===arguments.length&&"object"===typeof arguments[0]){var e=1===arguments.length?arguments[0]:void 0;return new Promise(function(f,g){d.apply(c,[f,g,e])})}return d.apply(this,arguments)}});["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(c){var d=RTCPeerConnection.prototype[c];RTCPeerConnection.prototype[c]=function(){arguments[0]=new ("addIceCandidate"===c?RTCIceCandidate:RTCSessionDescription)(arguments[0]);return d.apply(this,arguments)}});
var d=RTCPeerConnection.prototype.addIceCandidate;RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?d.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}},shimGetUserMedia:d("./getusermedia")}},{"../utils.js":10,"./getusermedia":4}],4:[function(d,c,f){var e=d("../utils.js").log;c.exports=function(){var c=function(c){if("object"!==typeof c||c.mandatory||c.optional)return c;var d={};Object.keys(c).forEach(function(e){if("require"!==e&&"advanced"!==
e&&"mediaSource"!==e){var f="object"===typeof c[e]?c[e]:{ideal:c[e]};void 0!==f.exact&&"number"===typeof f.exact&&(f.min=f.max=f.exact);var g=function(c,d){return c?c+d.charAt(0).toUpperCase()+d.slice(1):"deviceId"===d?"sourceId":d};if(void 0!==f.ideal){d.optional=d.optional||[];var h={};"number"===typeof f.ideal?(h[g("min",e)]=f.ideal,d.optional.push(h),h={},h[g("max",e)]=f.ideal):h[g("",e)]=f.ideal;d.optional.push(h)}void 0!==f.exact&&"number"!==typeof f.exact?(d.mandatory=d.mandatory||{},d.mandatory[g("",
e)]=f.exact):["min","max"].forEach(function(c){void 0!==f[c]&&(d.mandatory=d.mandatory||{},d.mandatory[g(c,e)]=f[c])})}});c.advanced&&(d.optional=(d.optional||[]).concat(c.advanced));return d},d=function(d,f){(d=JSON.parse(JSON.stringify(d)))&&d.audio&&(d.audio=c(d.audio));if(d&&"object"===typeof d.video){var h=d.video.facingMode,h=h&&("object"===typeof h?h:{ideal:h});if(!(!h||"user"!==h.exact&&"environment"!==h.exact&&"user"!==h.ideal&&"environment"!==h.ideal||navigator.mediaDevices.getSupportedConstraints&&
navigator.mediaDevices.getSupportedConstraints().facingMode)&&(delete d.video.facingMode,"environment"===h.exact||"environment"===h.ideal))return navigator.mediaDevices.enumerateDevices().then(function(l){l=l.filter(function(c){return"videoinput"===c.kind});if(l=l.find(function(c){return-1!==c.label.toLowerCase().indexOf("back")})||l.length&&l[l.length-1])d.video.deviceId=h.exact?{exact:l.deviceId}:{ideal:l.deviceId};d.video=c(d.video);e("chrome: "+JSON.stringify(d));return f(d)});d.video=c(d.video)}e("chrome: "+
JSON.stringify(d));return f(d)},f=function(c){return{name:{PermissionDeniedError:"NotAllowedError",ConstraintNotSatisfiedError:"OverconstrainedError"}[c.name]||c.name,message:c.message,constraint:c.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};navigator.getUserMedia=function(c,e,g){d(c,function(c){navigator.webkitGetUserMedia(c,e,function(c){g(f(c))})})};var m=function(c){return new Promise(function(d,e){navigator.getUserMedia(c,d,e)})};navigator.mediaDevices||
(navigator.mediaDevices={getUserMedia:m,enumerateDevices:function(){return new Promise(function(c){var d={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(e){c(e.map(function(c){return{label:c.label,kind:d[c.kind],deviceId:c.id,groupId:""}}))})})}});if(navigator.mediaDevices.getUserMedia){var q=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(c){return d(c,function(c){return q(c).then(function(d){if(c.audio&&
!d.getAudioTracks().length||c.video&&!d.getVideoTracks().length)throw d.getTracks().forEach(function(c){c.stop()}),new DOMException("","NotFoundError");return d},function(c){return Promise.reject(f(c))})})}}else navigator.mediaDevices.getUserMedia=function(c){return m(c)};"undefined"===typeof navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){e("Dummy mediaDevices.addEventListener called.")});"undefined"===typeof navigator.mediaDevices.removeEventListener&&
(navigator.mediaDevices.removeEventListener=function(){e("Dummy mediaDevices.removeEventListener called.")})}},{"../utils.js":10}],5:[function(d,c,f){var e=d("sdp"),g=d("../utils").browserDetails;c.exports={shimPeerConnection:function(){if(window.RTCIceGatherer&&(window.RTCIceCandidate||(window.RTCIceCandidate=function(c){return c}),window.RTCSessionDescription||(window.RTCSessionDescription=function(c){return c}),15025>g.version)){var c=Object.getOwnPropertyDescriptor(MediaStreamTrack.prototype,
"enabled");Object.defineProperty(MediaStreamTrack.prototype,"enabled",{set:function(d){c.set.call(this,d);var e=new Event("enabled");e.enabled=d;this.dispatchEvent(e)}})}window.RTCPeerConnection=function(c){var d=this,e=document.createDocumentFragment();["addEventListener","removeEventListener","dispatchEvent"].forEach(function(c){d[c]=e[c].bind(e)});this.ondatachannel=this.onnegotiationneeded=this.onicegatheringstatechange=this.oniceconnectionstatechange=this.onsignalingstatechange=this.onremovestream=
this.ontrack=this.onaddstream=this.onicecandidate=null;this.localStreams=[];this.remoteStreams=[];this.getLocalStreams=function(){return d.localStreams};this.getRemoteStreams=function(){return d.remoteStreams};this.localDescription=new RTCSessionDescription({type:"",sdp:""});this.remoteDescription=new RTCSessionDescription({type:"",sdp:""});this.signalingState="stable";this.iceGatheringState=this.iceConnectionState="new";this.iceOptions={gatherPolicy:"all",iceServers:[]};if(c&&c.iceTransportPolicy)switch(c.iceTransportPolicy){case "all":case "relay":this.iceOptions.gatherPolicy=
c.iceTransportPolicy;break;case "none":throw new TypeError('iceTransportPolicy "none" not supported');}this.usingBundle=c&&"max-bundle"===c.bundlePolicy;if(c&&c.iceServers){var f=JSON.parse(JSON.stringify(c.iceServers));this.iceOptions.iceServers=f.filter(function(c){return c&&c.urls?(c=c.urls,"string"===typeof c&&(c=[c]),c=c.filter(function(c){return 0===c.indexOf("turn:")&&-1!==c.indexOf("transport=udp")&&-1===c.indexOf("turn:[")||0===c.indexOf("stun:")&&14393<=g.version})[0],!!c):!1})}this._config=
c;this.transceivers=[];this._localIceCandidatesBuffer=[]};window.RTCPeerConnection.prototype._emitGatheringStateChange=function(){var c=new Event("icegatheringstatechange");this.dispatchEvent(c);if(null!==this.onicegatheringstatechange)this.onicegatheringstatechange(c)};window.RTCPeerConnection.prototype._emitBufferedCandidates=function(){var c=this,d=e.splitSections(c.localDescription.sdp);this._localIceCandidatesBuffer.forEach(function(e){if(e.candidate&&0!==Object.keys(e.candidate).length)d[e.candidate.sdpMLineIndex+
1]+="a="+e.candidate.candidate+"\r\n";else for(var f=1;f<d.length;f++)-1===d[f].indexOf("\r\na=end-of-candidates\r\n")&&(d[f]+="a=end-of-candidates\r\n");c.localDescription.sdp=d.join("");c.dispatchEvent(e);if(null!==c.onicecandidate)c.onicecandidate(e);!e.candidate&&"complete"!==c.iceGatheringState&&c.transceivers.every(function(c){return c.iceGatherer&&"completed"===c.iceGatherer.state})&&"complete"!==c.iceGatheringStateChange&&(c.iceGatheringState="complete",c._emitGatheringStateChange())});this._localIceCandidatesBuffer=
[]};window.RTCPeerConnection.prototype.getConfiguration=function(){return this._config};window.RTCPeerConnection.prototype.addStream=function(c){if(15025<=g.version)this.localStreams.push(c);else{var d=c.clone();c.getTracks().forEach(function(c,e){var f=d.getTracks()[e];c.addEventListener("enabled",function(c){f.enabled=c.enabled})});this.localStreams.push(d)}this._maybeFireNegotiationNeeded()};window.RTCPeerConnection.prototype.removeStream=function(c){c=this.localStreams.indexOf(c);-1<c&&(this.localStreams.splice(c,
1),this._maybeFireNegotiationNeeded())};window.RTCPeerConnection.prototype.getSenders=function(){return this.transceivers.filter(function(c){return!!c.rtpSender}).map(function(c){return c.rtpSender})};window.RTCPeerConnection.prototype.getReceivers=function(){return this.transceivers.filter(function(c){return!!c.rtpReceiver}).map(function(c){return c.rtpReceiver})};window.RTCPeerConnection.prototype._getCommonCapabilities=function(c,d){var e={codecs:[],headerExtensions:[],fecMechanisms:[]};c.codecs.forEach(function(c){for(var f=
0;f<d.codecs.length;f++){var g=d.codecs[f];if(c.name.toLowerCase()===g.name.toLowerCase()&&c.clockRate===g.clockRate){g.numChannels=Math.min(c.numChannels,g.numChannels);e.codecs.push(g);g.rtcpFeedback=g.rtcpFeedback.filter(function(d){for(var e=0;e<c.rtcpFeedback.length;e++)if(c.rtcpFeedback[e].type===d.type&&c.rtcpFeedback[e].parameter===d.parameter)return!0;return!1});break}}});c.headerExtensions.forEach(function(c){for(var f=0;f<d.headerExtensions.length;f++){var g=d.headerExtensions[f];if(c.uri===
g.uri){e.headerExtensions.push(g);break}}});return e};window.RTCPeerConnection.prototype._createIceAndDtlsTransports=function(c,d){var f=this,g=new RTCIceGatherer(f.iceOptions),h=new RTCIceTransport(g);g.onlocalcandidate=function(s){var t=new Event("icecandidate");t.candidate={sdpMid:c,sdpMLineIndex:d};var w=s.candidate;(s=!w||0===Object.keys(w).length)?void 0===g.state&&(g.state="completed"):(w.component="RTCP"===h.component?2:1,t.candidate.candidate=e.writeCandidate(w));w=e.splitSections(f.localDescription.sdp);
w[t.candidate.sdpMLineIndex+1]=s?w[t.candidate.sdpMLineIndex+1]+"a=end-of-candidates\r\n":w[t.candidate.sdpMLineIndex+1]+("a="+t.candidate.candidate+"\r\n");f.localDescription.sdp=w.join("");w=(f._pendingOffer?f._pendingOffer:f.transceivers).every(function(c){return c.iceGatherer&&"completed"===c.iceGatherer.state});switch(f.iceGatheringState){case "new":s||f._localIceCandidatesBuffer.push(t);s&&w&&f._localIceCandidatesBuffer.push(new Event("icecandidate"));break;case "gathering":f._emitBufferedCandidates();
if(!s&&(f.dispatchEvent(t),null!==f.onicecandidate))f.onicecandidate(t);if(w){f.dispatchEvent(new Event("icecandidate"));if(null!==f.onicecandidate)f.onicecandidate(new Event("icecandidate"));f.iceGatheringState="complete";f._emitGatheringStateChange()}}};h.onicestatechange=function(){f._updateConnectionState()};var t=new RTCDtlsTransport(h);t.ondtlsstatechange=function(){f._updateConnectionState()};t.onerror=function(){t.state="failed";f._updateConnectionState()};return{iceGatherer:g,iceTransport:h,
dtlsTransport:t}};window.RTCPeerConnection.prototype._transceive=function(c,d,f){var g=this._getCommonCapabilities(c.localCapabilities,c.remoteCapabilities);d&&c.rtpSender&&(g.encodings=c.sendEncodingParameters,g.rtcp={cname:e.localCName},c.recvEncodingParameters.length&&(g.rtcp.ssrc=c.recvEncodingParameters[0].ssrc),c.rtpSender.send(g));f&&c.rtpReceiver&&("video"===c.kind&&c.recvEncodingParameters&&c.recvEncodingParameters.forEach(function(c){delete c.rtx}),g.encodings=c.recvEncodingParameters,g.rtcp=
{cname:c.cname},c.sendEncodingParameters.length&&(g.rtcp.ssrc=c.sendEncodingParameters[0].ssrc),c.rtpReceiver.receive(g))};window.RTCPeerConnection.prototype.setLocalDescription=function(c){var d=this,f,g;if("offer"===c.type)this._pendingOffer&&(f=e.splitSections(c.sdp),g=f.shift(),f.forEach(function(c,f){var g=e.parseRtpParameters(c);d._pendingOffer[f].localCapabilities=g}),this.transceivers=this._pendingOffer,delete this._pendingOffer);else if("answer"===c.type){f=e.splitSections(d.remoteDescription.sdp);
g=f.shift();var h=0<e.matchPrefix(g,"a=ice-lite").length;f.forEach(function(c,f){var l=d.transceivers[f],n=l.iceGatherer,q=l.iceTransport,s=l.dtlsTransport,t=l.localCapabilities,W=l.remoteCapabilities;if("0"!==c.split("\n",1)[0].split(" ",2)[1]&&!l.isDatachannel){var ca=e.getIceParameters(c,g),T=e.getDtlsParameters(c,g);h&&(T.role="server");d.usingBundle&&0!==f||(q.start(n,ca,h?"controlling":"controlled"),s.start(T));n=d._getCommonCapabilities(t,W);d._transceive(l,0<n.codecs.length,!1)}})}this.localDescription=
{type:c.type,sdp:c.sdp};switch(c.type){case "offer":this._updateSignalingState("have-local-offer");break;case "answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+c.type+'"');}var t=1<arguments.length&&"function"===typeof arguments[1];if(t){var s=arguments[1];window.setTimeout(function(){s();"new"===d.iceGatheringState&&(d.iceGatheringState="gathering");d._emitBufferedCandidates()},0)}f=Promise.resolve();f.then(function(){t||("new"===d.iceGatheringState&&
(d.iceGatheringState="gathering"),window.setTimeout(d._emitBufferedCandidates.bind(d),500))});return f};window.RTCPeerConnection.prototype.setRemoteDescription=function(c){var d=this,f=new MediaStream,g=[],h=e.splitSections(c.sdp),t=h.shift(),s=0<e.matchPrefix(t,"a=ice-lite").length;this.usingBundle=0<e.matchPrefix(t,"a=group:BUNDLE ").length;h.forEach(function(h,p){var A=e.splitLines(h)[0].substr(2).split(" "),n=A[0],H="0"===A[1],y=e.getDirection(h,t),F=e.matchPrefix(h,"a=mid:"),F=F.length?F[0].substr(6):
e.generateIdentifier();if("application"===n&&"DTLS/SCTP"===A[2])d.transceivers[p]={mid:F,isDatachannel:!0};else{var W,ca,T,Q,G,V,C=e.parseRtpParameters(h),R;H||(R=e.getIceParameters(h,t),V=e.getDtlsParameters(h,t),V.role="client");var A=e.parseRtpEncodingParameters(h),U;if(Q=e.matchPrefix(h,"a=ssrc:").map(function(c){return e.parseSsrcMedia(c)}).filter(function(c){return"cname"===c.attribute})[0])U=Q.value;var Y=0<e.matchPrefix(h,"a=end-of-candidates",t).length,O=e.matchPrefix(h,"a=candidate:").map(function(c){return e.parseCandidate(c)}).filter(function(c){return"1"===
c.component});"offer"!==c.type||H?"answer"!==c.type||H||(n=d.transceivers[p],F=n.iceGatherer,W=n.iceTransport,ca=n.dtlsTransport,T=n.rtpSender,H=n.rtpReceiver,Q=n.sendEncodingParameters,G=n.localCapabilities,d.transceivers[p].recvEncodingParameters=A,d.transceivers[p].remoteCapabilities=C,d.transceivers[p].cname=U,(s||Y)&&O.length&&W.setRemoteCandidates(O),d.usingBundle&&0!==p||(W.start(F,R,"controlling"),ca.start(V)),d._transceive(n,"sendrecv"===y||"recvonly"===y,"sendrecv"===y||"sendonly"===y),
!H||"sendrecv"!==y&&"sendonly"!==y?delete n.rtpReceiver:(V=H.track,g.push([V,H]),f.addTrack(V))):(R=d.usingBundle&&0<p?{iceGatherer:d.transceivers[0].iceGatherer,iceTransport:d.transceivers[0].iceTransport,dtlsTransport:d.transceivers[0].dtlsTransport}:d._createIceAndDtlsTransports(F,p),!Y||d.usingBundle&&0!==p||R.iceTransport.setRemoteCandidates(O),G=RTCRtpReceiver.getCapabilities(n),G.codecs=G.codecs.filter(function(c){return"rtx"!==c.name}),Q=[{ssrc:1001*(2*p+2)}],H=new RTCRtpReceiver(R.dtlsTransport,
n),V=H.track,g.push([V,H]),f.addTrack(V),0<d.localStreams.length&&d.localStreams[0].getTracks().length>=p&&("audio"===n?W=d.localStreams[0].getAudioTracks()[0]:"video"===n&&(W=d.localStreams[0].getVideoTracks()[0]),W&&(T=new RTCRtpSender(W,R.dtlsTransport))),d.transceivers[p]={iceGatherer:R.iceGatherer,iceTransport:R.iceTransport,dtlsTransport:R.dtlsTransport,localCapabilities:G,remoteCapabilities:C,rtpSender:T,rtpReceiver:H,kind:n,mid:F,cname:U,sendEncodingParameters:Q,recvEncodingParameters:A},
d._transceive(d.transceivers[p],!1,"sendrecv"===y||"sendonly"===y))}});this.remoteDescription={type:c.type,sdp:c.sdp};switch(c.type){case "offer":this._updateSignalingState("have-remote-offer");break;case "answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+c.type+'"');}f.getTracks().length&&(d.remoteStreams.push(f),window.setTimeout(function(){var c=new Event("addstream");c.stream=f;d.dispatchEvent(c);null!==d.onaddstream&&window.setTimeout(function(){d.onaddstream(c)},
0);g.forEach(function(c){var e=c[0];c=c[1];var g=new Event("track");g.track=e;g.receiver=c;g.streams=[f];d.dispatchEvent(g);null!==d.ontrack&&window.setTimeout(function(){d.ontrack(g)},0)})},0));1<arguments.length&&"function"===typeof arguments[1]&&window.setTimeout(arguments[1],0);return Promise.resolve()};window.RTCPeerConnection.prototype.close=function(){this.transceivers.forEach(function(c){c.iceTransport&&c.iceTransport.stop();c.dtlsTransport&&c.dtlsTransport.stop();c.rtpSender&&c.rtpSender.stop();
c.rtpReceiver&&c.rtpReceiver.stop()});this._updateSignalingState("closed")};window.RTCPeerConnection.prototype._updateSignalingState=function(c){this.signalingState=c;c=new Event("signalingstatechange");this.dispatchEvent(c);if(null!==this.onsignalingstatechange)this.onsignalingstatechange(c)};window.RTCPeerConnection.prototype._maybeFireNegotiationNeeded=function(){var c=new Event("negotiationneeded");this.dispatchEvent(c);if(null!==this.onnegotiationneeded)this.onnegotiationneeded(c)};window.RTCPeerConnection.prototype._updateConnectionState=
function(){var c,d={"new":0,closed:0,connecting:0,checking:0,connected:0,completed:0,failed:0};this.transceivers.forEach(function(c){d[c.iceTransport.state]++;d[c.dtlsTransport.state]++});d.connected+=d.completed;c="new";if(0<d.failed)c="failed";else if(0<d.connecting||0<d.checking)c="connecting";else if(0<d.disconnected)c="disconnected";else if(0<d.new)c="new";else if(0<d.connected||0<d.completed)c="connected";if(c!==this.iceConnectionState&&(this.iceConnectionState=c,c=new Event("iceconnectionstatechange"),
this.dispatchEvent(c),null!==this.oniceconnectionstatechange))this.oniceconnectionstatechange(c)};window.RTCPeerConnection.prototype.createOffer=function(){var c=this;if(this._pendingOffer)throw Error("createOffer called while there is a pending offer.");var d;1===arguments.length&&"function"!==typeof arguments[0]?d=arguments[0]:3===arguments.length&&(d=arguments[2]);var f=[],g=0,h=0;this.localStreams.length&&(g=this.localStreams[0].getAudioTracks().length,h=this.localStreams[0].getVideoTracks().length);
if(d){if(d.mandatory||d.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==d.offerToReceiveAudio&&(g=d.offerToReceiveAudio);void 0!==d.offerToReceiveVideo&&(h=d.offerToReceiveVideo)}for(this.localStreams.length&&this.localStreams[0].getTracks().forEach(function(c){f.push({kind:c.kind,track:c,wantReceive:"audio"===c.kind?0<g:0<h});"audio"===c.kind?g--:"video"===c.kind&&h--});0<g||0<h;)0<g&&(f.push({kind:"audio",wantReceive:!0}),g--),0<h&&(f.push({kind:"video",
wantReceive:!0}),h--);var t=e.writeSessionBoilerplate(),s=[];f.forEach(function(d,f){var g=d.track,h=d.kind,m=e.generateIdentifier(),p=c.usingBundle&&0<f?{iceGatherer:s[0].iceGatherer,iceTransport:s[0].iceTransport,dtlsTransport:s[0].dtlsTransport}:c._createIceAndDtlsTransports(m,f),q=RTCRtpSender.getCapabilities(h);q.codecs=q.codecs.filter(function(c){return"rtx"!==c.name});q.codecs.forEach(function(c){"H264"===c.name&&void 0===c.parameters["level-asymmetry-allowed"]&&(c.parameters["level-asymmetry-allowed"]=
"1")});var r,t,T=[{ssrc:1001*(2*f+1)}];g&&(r=new RTCRtpSender(g,p.dtlsTransport));d.wantReceive&&(t=new RTCRtpReceiver(p.dtlsTransport,h));s[f]={iceGatherer:p.iceGatherer,iceTransport:p.iceTransport,dtlsTransport:p.dtlsTransport,localCapabilities:q,remoteCapabilities:null,rtpSender:r,rtpReceiver:t,kind:h,mid:m,sendEncodingParameters:T,recvEncodingParameters:null}});this.usingBundle&&(t+="a=group:BUNDLE "+s.map(function(c){return c.mid}).join(" ")+"\r\n");f.forEach(function(d,f){var g=s[f];t+=e.writeMediaSection(g,
g.localCapabilities,"offer",c.localStreams[0])});this._pendingOffer=s;d=new RTCSessionDescription({type:"offer",sdp:t});arguments.length&&"function"===typeof arguments[0]&&window.setTimeout(arguments[0],0,d);return Promise.resolve(d)};window.RTCPeerConnection.prototype.createAnswer=function(){var c=this,d=e.writeSessionBoilerplate();this.usingBundle&&(d+="a=group:BUNDLE "+this.transceivers.map(function(c){return c.mid}).join(" ")+"\r\n");this.transceivers.forEach(function(f){if(f.isDatachannel)d+=
"m=application 0 DTLS/SCTP 5000\r\nc=IN IP4 0.0.0.0\r\na=mid:"+f.mid+"\r\n";else{var g=c._getCommonCapabilities(f.localCapabilities,f.remoteCapabilities);d+=e.writeMediaSection(f,g,"answer",c.localStreams[0])}});var f=new RTCSessionDescription({type:"answer",sdp:d});arguments.length&&"function"===typeof arguments[0]&&window.setTimeout(arguments[0],0,f);return Promise.resolve(f)};window.RTCPeerConnection.prototype.addIceCandidate=function(c){if(c){var d=c.sdpMLineIndex;if(c.sdpMid)for(var f=0;f<this.transceivers.length;f++)if(this.transceivers[f].mid===
c.sdpMid){d=f;break}var g=this.transceivers[d];if(g){f=0<Object.keys(c.candidate).length?e.parseCandidate(c.candidate):{};if("tcp"===f.protocol&&(0===f.port||9===f.port)||"1"!==f.component)return Promise.resolve();g.iceTransport.addRemoteCandidate(f);g=e.splitSections(this.remoteDescription.sdp);g[d+1]+=(f.type?c.candidate.trim():"a=end-of-candidates")+"\r\n";this.remoteDescription.sdp=g.join("")}}else for(d=0;d<this.transceivers.length;d++)if(this.transceivers[d].iceTransport.addRemoteCandidate({}),
this.usingBundle)return Promise.resolve();1<arguments.length&&"function"===typeof arguments[1]&&window.setTimeout(arguments[1],0);return Promise.resolve()};window.RTCPeerConnection.prototype.getStats=function(){var c=[];this.transceivers.forEach(function(d){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(e){d[e]&&c.push(d[e].getStats())})});var d=1<arguments.length&&"function"===typeof arguments[1]&&arguments[1];return new Promise(function(e){var f=new Map;
Promise.all(c).then(function(c){c.forEach(function(c){Object.keys(c).forEach(function(d){var e=c[d],g=c[d];g.type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[g.type]||g.type;e.type=g;f.set(d,c[d])})});d&&window.setTimeout(d,0,f);e(f)})})}},shimGetUserMedia:d("./getusermedia")}},{"../utils":10,"./getusermedia":6,sdp:1}],6:[function(d,c,f){c.exports=function(){var c=function(c){return{name:{PermissionDeniedError:"NotAllowedError"}[c.name]||
c.name,message:c.message,constraint:c.constraint,toString:function(){return this.name}}},d=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(f){return d(f).catch(function(d){return Promise.reject(c(d))})}}},{}],7:[function(d,c,f){var e=d("../utils").browserDetails;c.exports={shimOnTrack:function(){"object"!==typeof window||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,
"ontrack",{get:function(){return this._ontrack},set:function(c){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly));this.addEventListener("track",this._ontrack=c);this.addEventListener("addstream",this._ontrackpoly=function(c){c.stream.getTracks().forEach(function(d){var e=new Event("track");e.track=d;e.receiver={track:d};e.streams=[c.stream];this.dispatchEvent(e)}.bind(this))}.bind(this))}})},shimSourceObject:function(){"object"===
typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(c){this.mozSrcObject=c}}))},shimPeerConnection:function(){if("object"===typeof window&&(window.RTCPeerConnection||window.mozRTCPeerConnection)){window.RTCPeerConnection||(window.RTCPeerConnection=function(c,d){if(38>e.version&&c&&c.iceServers){for(var f=[],g=0;g<c.iceServers.length;g++){var h=
c.iceServers[g];if(h.hasOwnProperty("urls"))for(var l=0;l<h.urls.length;l++){var m={url:h.urls[l]};0===h.urls[l].indexOf("turn")&&(m.username=h.username,m.credential=h.credential);f.push(m)}else f.push(c.iceServers[g])}c.iceServers=f}return new mozRTCPeerConnection(c,d)},window.RTCPeerConnection.prototype=mozRTCPeerConnection.prototype,mozRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return mozRTCPeerConnection.generateCertificate}}),
window.RTCSessionDescription=mozRTCSessionDescription,window.RTCIceCandidate=mozRTCIceCandidate);["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(c){var d=RTCPeerConnection.prototype[c];RTCPeerConnection.prototype[c]=function(){arguments[0]=new ("addIceCandidate"===c?RTCIceCandidate:RTCSessionDescription)(arguments[0]);return d.apply(this,arguments)}});var c=RTCPeerConnection.prototype.addIceCandidate;RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?
c.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var d=function(c){var d=new Map;Object.keys(c).forEach(function(e){d.set(e,c[e]);d[e]=c[e]});return d},f={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},m=RTCPeerConnection.prototype.getStats;RTCPeerConnection.prototype.getStats=function(c,g,p){return m.apply(this,[c||null]).then(function(c){48>e.version&&(c=d(c));
if(53>e.version&&!g)try{c.forEach(function(c){c.type=f[c.type]||c.type})}catch(m){if("TypeError"!==m.name)throw m;c.forEach(function(d,e){c.set(e,Object.assign({},d,{type:f[d.type]||d.type}))})}return c}).then(g,p)}}},shimGetUserMedia:d("./getusermedia")}},{"../utils":10,"./getusermedia":8}],8:[function(d,c,f){var e=d("../utils").log,g=d("../utils").browserDetails;c.exports=function(){var c=function(c){return{name:{SecurityError:"NotAllowedError",PermissionDeniedError:"NotAllowedError"}[c.name]||
c.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[c.message]||c.message,constraint:c.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},d=function(d,f,l){var m=function(c){if("object"!==typeof c||c.require)return c;var d=[];Object.keys(c).forEach(function(e){if("require"!==e&&"advanced"!==e&&"mediaSource"!==e){var f=c[e]="object"===typeof c[e]?c[e]:{ideal:c[e]};void 0===f.min&&void 0===
f.max&&void 0===f.exact||d.push(e);void 0!==f.exact&&("number"===typeof f.exact?f.min=f.max=f.exact:c[e]=f.exact,delete f.exact);if(void 0!==f.ideal){c.advanced=c.advanced||[];var g={};g[e]="number"===typeof f.ideal?{min:f.ideal,max:f.ideal}:f.ideal;c.advanced.push(g);delete f.ideal;Object.keys(f).length||delete c[e]}}});d.length&&(c.require=d);return c};d=JSON.parse(JSON.stringify(d));38>g.version&&(e("spec: "+JSON.stringify(d)),d.audio&&(d.audio=m(d.audio)),d.video&&(d.video=m(d.video)),e("ff37: "+
JSON.stringify(d)));return navigator.mozGetUserMedia(d,f,function(d){l(c(d))})},f=function(c){return new Promise(function(e,f){d(c,e,f)})};navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:f,addEventListener:function(){},removeEventListener:function(){}});navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(c){c([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])})};
if(41>g.version){var q=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return q().then(void 0,function(c){if("NotFoundError"===c.name)return[];throw c;})}}if(49>g.version){var r=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(d){return r(d).then(function(c){if(d.audio&&!c.getAudioTracks().length||d.video&&!c.getVideoTracks().length)throw c.getTracks().forEach(function(c){c.stop()}),
new DOMException("The object can not be found here.","NotFoundError");return c},function(d){return Promise.reject(c(d))})}}navigator.getUserMedia=function(c,e,f){if(44>g.version)return d(c,e,f);console.warn("navigator.getUserMedia has been replaced by navigator.mediaDevices.getUserMedia");navigator.mediaDevices.getUserMedia(c).then(e,f)}}},{"../utils":10}],9:[function(d,c,f){c.exports={shimGetUserMedia:function(){navigator.getUserMedia=navigator.webkitGetUserMedia}}},{}],10:[function(d,c,f){var e=
!0;d={disableLog:function(c){return"boolean"!==typeof c?Error("Argument type: "+typeof c+". Please use a boolean."):(e=c)?"adapter.js logging disabled":"adapter.js logging enabled"},log:function(){"object"!==typeof window||e||"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)},extractVersion:function(c,d,e){return(c=c.match(d))&&c.length>=e&&parseInt(c[e],10)},detectBrowser:function(){var c={browser:null,version:null};if("undefined"===typeof window||
!window.navigator)return c.browser="Not a browser.",c;navigator.mozGetUserMedia?(c.browser="firefox",c.version=this.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1)):navigator.webkitGetUserMedia?window.webkitRTCPeerConnection?(c.browser="chrome",c.version=this.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2)):navigator.userAgent.match(/Version\/(\d+).(\d+)/)?(c.browser="safari",c.version=this.extractVersion(navigator.userAgent,/AppleWebKit\/([0-9]+)\./,1)):c.browser="Unsupported webkit-based browser with GUM support but no WebRTC support.":
navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)?(c.browser="edge",c.version=this.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2)):c.browser="Not a supported browser.";return c},shimCreateObjectURL:function(){if("object"===typeof window&&window.HTMLMediaElement&&"srcObject"in window.HTMLMediaElement.prototype){var c=URL.createObjectURL.bind(URL),d=URL.revokeObjectURL.bind(URL),e=new Map,f=0;URL.createObjectURL=function(d){if("getTracks"in d){var h="polyblob:"+ ++f;
e.set(h,d);console.log("URL.createObjectURL(stream) is deprecated! Use elem.srcObject = stream instead!");return h}return c(d)};URL.revokeObjectURL=function(c){d(c);e.delete(c)};var q=Object.getOwnPropertyDescriptor(window.HTMLMediaElement.prototype,"src");Object.defineProperty(window.HTMLMediaElement.prototype,"src",{get:function(){return q.get.apply(this)},set:function(c){this.srcObject=e.get(c)||null;return q.set.apply(this,[c])}})}}};c.exports={log:d.log,disableLog:d.disableLog,browserDetails:d.detectBrowser(),
extractVersion:d.extractVersion,shimCreateObjectURL:d.shimCreateObjectURL}},{}]},{},[2])(2)});(function(b){b.localtime=function(){var d={localtime:"yyyy-MM-dd HH:mm:ss"},c="January February March April May June July August September October November December".split(" "),f="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),e=["th","st","nd","rd"];return{setFormat:function(b){d="object"==typeof b?b:{localtime:b}},getFormat:function(){return d},parseISOTimeString:function(c){c=b.trim(""+c);var d=/^(\d{4})-([01]\d)-([0-3]\d)[T| ]([0-2]\d):([0-5]\d)(?::([0-5]\d)(?:\.(\d{3}))?)?Z$/.exec(c);
if(d){c=parseInt(d[1],10);var e=parseInt(d[2],10)-1,f=parseInt(d[3],10),q=parseInt(d[4],10),r=parseInt(d[5],10),p=d[6]?parseInt(d[6],10):0,t=d[7]?parseInt(d[7],10):0,r=new Date(Date.UTC(c,e,f,q,r,p,t));if(r.getUTCFullYear()!==c||r.getUTCMonth()!==e||r.getUTCDate()!==f)throw Error(d[1]+"-"+d[2]+"-"+d[3]+" is not a valid date");if(r.getUTCHours()!==q)throw Error(d[4]+":"+d[5]+" is not a valid time");return r}throw Error(c+" is not a supported date/time string");},toLocalTime:function(g,h){"[object Date]"!==
Object.prototype.toString.call(g)&&(g=b.localtime.parseISOTimeString(g));""===h&&(h=void 0);var l;a:{var m=g;l=h;var q=""+m.getFullYear(),r=""+(m.getMonth()+1),p=""+m.getDate(),t=m.getDay(),s=""+m.getHours(),u=""+m.getMinutes(),w=""+m.getSeconds(),A=""+m.getMilliseconds(),n=m.getTimezoneOffset(),H=0<n?"-":"+";if(n=Math.abs(n),void 0===l){for(var y in d)if(d.hasOwnProperty(y)){l=d[y];break}if(void 0===l){l=""+m;break a}}var F=m="";for(y=0;l.length>y;y++)if(F+=l.charAt(y),"'"===F)for(y++;l.length>y;y++){var W=
l.charAt(y);if("'"===W){F="";break}m+=W}else if("\\"===F&&l.length-1>y&&"'"===l.charAt(y+1))y++,m+="'",F="";else if(y===l.length-1||l.charAt(y)!==l.charAt(y+1)){switch(F){case "d":m+=p;break;case "dd":m+=("0"+p).slice(-2);break;case "ddd":m+=f[t].substr(0,3);break;case "ddddd":m+=f[t];break;case "M":m+=r;break;case "MM":m+=("0"+r).slice(-2);break;case "MMM":m+=c[r-1].substr(0,3);break;case "MMMMM":m+=c[r-1];break;case "yy":m+=q.slice(-2);break;case "yyyy":m+=q;break;case "H":m+=s;break;case "HH":m+=
("0"+s).slice(-2);break;case "h":m+=13<=s?s-12:"0"===s?12:s;break;case "hh":m+=("0"+(13<=s?s-12:"0"===s?12:s)).slice(-2);break;case "m":m+=u;break;case "mm":m+=("0"+u).slice(-2);break;case "s":m+=w;break;case "ss":m+=("0"+w).slice(-2);break;case "S":m+=A;break;case "SS":m+=("0"+A).slice(-2);break;case "SSS":m+=("00"+A).slice(-3);break;case "o":switch(p){case "11":case "12":case "13":m+=e[0];break;default:F=p%10,3<F&&(F=0),m+=e[F]}break;case "a":case "TT":m+=12<=s?"PM":"AM";break;case "tt":m+=12<=
s?"pm":"am";break;case "T":m+=12<=s?"P":"A";break;case "t":m+=12<=s?"p":"a";break;case "z":m+=H+parseInt(n/60,10);break;case "zz":m+=H+("0"+parseInt(n/60,10)).slice(-2);break;case "zzz":m+=H+("0"+parseInt(n/60,10)).slice(-2)+":"+("0"+n%60).slice(-2);break;default:m+=F}F=""}l=m}return l},formatObject:function(c,d){c.is(":input")?c.val(b.localtime.toLocalTime(c.val(),d)):c.is("time")?c.text(b.localtime.toLocalTime(c.attr("datetime"),d)):c.text(b.localtime.toLocalTime(c.text(),d))},formatPage:function(){b.localtime.format()},
format:function(c){var d,e,f=function(){b.localtime.formatObject(b(this),d)},q=b.localtime.getFormat();for(e in q)q.hasOwnProperty(e)&&(d=q[e],b("."+e,c).each(f));b("[data-localtime-format]",c).each(function(){b.localtime.formatObject(b(this),b(this).attr("data-localtime-format"))})}}}()})(jQuery);jQuery(document).ready(function(b){b.localtime.format()});var TempBarView=Backbone.View.extend({containerDimensions:null,scale:null,type:null,dragging:!1,lastSent:null,lastSentTimestamp:null,waitAfterSent:2E3,target:0,actual:0,events:{"touchstart .temp-target span.target-value":"onTouchStart","mousedown .temp-target span.target-value":"onTouchStart",touchmove:"onTouchMove",mousemove:"onTouchMove","touchend .temp-target":"onTouchEnd","mouseup .temp-target":"onTouchEnd","mouseout .temp-target":"onTouchEnd","click .temp-target a.temp-edit":"onEditClicked",
"change .temp-target input":"onTempFieldChanged","blur .temp-target input":"onTempFieldBlur"},initialize:function(b){this.scale=b.scale;this.type=b.type;$(window).bind("resize.app",_.bind(this.onResize,this))},remove:function(){$(window).unbind("resize.app");Backbone.View.prototype.remove.call(this)},turnOff:function(b){this._sendToolCommand("target",this.type,0);this.setHandle(0)},setMax:function(b){if(this.scale[1]!=b){this.scale[1]=b;this.onResize();var d=parseInt(this.$el.find(".temp-target span.target-value").text());
isNaN(d)||this.setHandle(Math.min(d,b))}},onTouchStart:function(b){b.preventDefault();b.stopPropagation();this.dragging=!0;$(b.currentTarget).closest(".temp-target").addClass("moving")},onTouchEnd:function(b){b.preventDefault();$(b.currentTarget).removeClass("moving");this._sendToolCommand("target",this.type,this.$el.find(".temp-target span.target-value").text());this.dragging=!1},onEditClicked:function(b){b.preventDefault();b.stopPropagation();b=$(b.currentTarget).closest(".temp-target");var d=b.find("span.target-value"),
c=b.find("input");d.addClass("hide");c.removeClass("hide");c.val(d.text());setTimeout(function(){c.focus().select()},100)},onTempFieldChanged:function(b){b=$(b.target);var d=b.val();d==this.lastSent||isNaN(d)||(d=Math.min(Math.max(d,this.scale[0]),this.scale[1]),this._sendToolCommand("target",this.type,d),b.blur(),this.setHandle(d))},onTempFieldBlur:function(b){b=$(b.target);b.addClass("hide");b.closest(".temp-target").find("span.target-value").removeClass("hide")},_sendToolCommand:function(b,d,c,
f,e){if(c!=this.lastSent){var g={command:b};if("bed"==d){if("target"==b)g.target=parseInt(c);else if("offset"==b)g.offset=parseInt(c);else return;d="bed"}else{if("target"==b)b="targets";else if("offset"==b)b="offsets";else return;g[b]={};g[b][d]=parseInt(c);d="tool"}$.ajax({url:API_BASEURL+"printer/"+d,type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8",data:JSON.stringify(g),success:function(){void 0!==f&&f()},error:function(){void 0!==e&&e()}});this.lastSentTimestamp=(new Date).getTime();
this.lastSent=c}},setTemps:function(b,d){var c=(new Date).getTime();null!==this.lastSent&&this.lastSentTimestamp>c-this.waitAfterSent&&(d=this.lastSent);isNaN(b)&&(b=null);isNaN(d)&&(d=null);this.target=d;this.actual=b;this.renderTemps(b,d)},setHandle:function(b){},onTouchMove:function(b){},onClicked:function(b){},onResize:function(){},renderTemps:function(b,d){},_temp2px:function(b){},_px2temp:function(b){}});var FileUploadBase=Backbone.View.extend({events:{fileuploadadd:"onFileAdded",fileuploadsubmit:"onFileSubmit",fileuploadprogress:"onUploadProgress",fileuploadfail:"onUploadFail",fileuploadalways:"onUploadAlways",fileuploaddone:"onUploadDone"},acceptFileTypes:null,signatureUrl:null,signatureData:{},uploadUrl:null,uploadData:{},initialize:function(b){this.$el.fileupload({dropZone:b.dropZone?b.dropZone:this.$el})},beforeSubmit:function(b,d){if(this.signatureUrl){this.progress(1);var c=this.signatureData;
_.extend(c,{file:d.files[0].name});var f=[];_.each(c,function(b,c){f.push(c+"="+encodeURIComponent(b))});$.getJSON(this.signatureUrl+"?"+f.join("&"),_.bind(function(c){c.url&&c.params?(d.formData=c.params,d.url=c.url,d.redirect=c.redirect,this.progress(2),$(b.currentTarget).fileupload("send",d)):(this.failed(c.error),this.always())},this)).fail(_.bind(function(b){this.failed("http_error_"+b.status);this.always()},this))}else this.progress(1),$(b.currentTarget).fileupload("send",d);return!1},onFileAdded:function(b,
d){if(this.acceptFileTypes){var c=[],f=this.acceptFileTypes;d.originalFiles[0].name.length&&!f.test(d.originalFiles[0].name)&&c.push("Not a valid file");return 0<c.length?(this.failed("There was an error uploading: "+c.join("<br/>")),this.always(),!1):!0}console.error("acceptFileTypes not set")},onFileSubmit:function(b,d){d.files.length&&(this.started(d),this.progress(0),this.signatureUrl||(d.url=this.uploadUrl,d.formData=this.uploadData),this.beforeSubmit(b,d)&&$(b.currentTarget).fileupload("send",
d));return!1},onUploadProgress:function(b,d){this.progress(Math.max(d.loaded/d.total*95,2))},onUploadFail:function(b,d){this.failed(d.jqXHR.responseText?d.jqXHR.responseText:null)},onUploadAlways:function(b,d){this.always()},onUploadDone:function(b,d){this.success(d)},started:function(b){},progress:function(b){},failed:function(b){},success:function(b){},always:function(){}}),FileUploadCombined=FileUploadBase.extend({fileTypes:{design:["stl"],print:["x3g","gcode","gco"]},currentFileType:null,initialize:function(b){FileUploadBase.prototype.initialize.call(this,
b);this.refreshAccept()},refreshAccept:function(){"s3g"==app.printerProfile.get("driver")?(this.$el.attr("accept",".stl, .x3g"),this.acceptFileTypes=/(\.|\/)(stl|x3g)$/i):(this.$el.attr("accept",".stl, .gcode, .gco"),this.acceptFileTypes=/(\.|\/)(stl|gcode|gco)$/i)},started:function(b){if(b.files&&0<b.files.length){b=b.files[0].name;var d=b.substr(b.lastIndexOf(".")+1).toLowerCase();this.currentFileType=_.findKey(this.fileTypes,function(b,f){return void 0!=_.find(b,function(b){return b==d})});if(void 0==
this.currentFileType)this.currentFileType=null,this.failed("File Type ["+d+"] not supported");else switch(this.currentFileType){case "design":this.uploadUrl=null;this.signatureUrl="/api/astroprint/upload-data";this.signatureData={file:b};break;case "print":this.signatureUrl=null,this.signatureData={},this.uploadUrl="/api/files/local"}}},success:function(b){switch(this.currentFileType){case "design":this.progress(98);b.redirect?window.location.href=b.redirect:this.failed("Missing redirect url");break;
case "print":this.progress(98);var d=app.router.loadFilesView(!1);(!0===d?app.router.filesView.refreshPrintFiles():d).done(_.bind(function(){noty({text:"File uploaded successfully :)",type:"success",timeout:3E3});this.progress(100);app.router.filesView.printFilesListView.storage_control_view.selectStorage("local");app.router.filesView.fileInfoByName(b.result.files.local.name);this.onPrintFileUploaded()},this)).fail(_.bind(function(b){this.failed(b)},this))}},failed:function(b){this.onError(this.currentFileType,
b)},onPrintFileUploaded:function(){},onError:function(b,d){}});var CameraControlView=Backbone.View.extend({cameraMode:"video",state:null,canStream:!1,cameraAvailable:!1,cameraNotSupported:!1,browserNotVisibleManager:null,browserVisibilityState:null,initCamera:function(b){this.videoStreamingError=null;$.getJSON(API_BASEURL+"camera/connected").done(_.bind(function(d){d.isCameraConnected?$.getJSON(API_BASEURL+"camera/is-camera-supported").done(_.bind(function(c){c.isCameraSupported?(this.cameraNotSupported=!1,$.getJSON(API_BASEURL+"camera/has-properties").done(_.bind(function(c){c.hasCameraProperties?
(this.cameraAvailable=!0,b?(this.settings=b,this.cameraInitialized()):$.getJSON(API_BASEURL+"settings/camera").done(_.bind(function(b){this.settings=b;this.cameraInitialized()},this))):(this.cameraAvailable=!1,this.videoStreamingError="Camera error: Unable to read the camera capabilities. Reconnect the camera and try again...");this.render()},this)).fail(_.bind(function(b){this.cameraAvailable=!1;noty({text:"Unable to communicate with the camera.",timeout:3E3});this.stopStreaming();this.setState("error")},
this))):(this.cameraNotSupported=this.cameraAvailable=!0,this.render())},this)).fail(_.bind(function(b){this.cameraAvailable=!1;noty({text:"Unable to communicate with the camera.",timeout:3E3});this.stopStreaming();this.setState("error")},this)):(this.cameraAvailable=!1,this.render())},this))},buttonEvent:function(){return"video"==this.cameraMode?"streaming"==this.state?(this.deactivateWindowHideListener(),this.stopStreaming()):this.startStreaming():this.takePhoto()},render:function(){this.$el.html(this.template())},
cameraModeChanged:function(b){b.preventDefault();"video"==this.cameraMode&&(this.stopStreaming(),this.$el.removeClass("nowebrtc error"));this.cameraMode=this.cameraModeByValue($(b.currentTarget).is(":checked"));this.render()},cameraModeByValue:function(b){return b?"video":"photo"},onShow:function(){this.initCamera();this.$el.removeClass("nowebrtc error")},onHide:function(){"video"==this.cameraMode?"streaming"==this.state&&this.stopStreaming():this.$(".camera-image").removeAttr("src");this.setState("ready")},
setState:function(b){this.state=b;this.$el.removeClass("preparing error nowebrtc streaming ready").addClass(b)},takePhoto:function(){var b=$.Deferred();photoCont=this.getPhotoContainer();photoCont.attr("src","/camera/snapshot?apikey="+UI_API_KEY+"&timestamp="+Date.now()/1E3);photoCont.on("load",function(){photoCont.off("load");b.resolve()});photoCont.on("error",function(){photoCont.removeAttr("src");photoCont.off("error");b.reject()});return b},activateWindowHideListener:function(){var b=_.bind(function(){document.hidden||
"visible"!=document.visibilityState?setTimeout(_.bind(function(){if(document.hidden||"visible"!=document.visibilityState)this.stopStreaming(),this.browserNotVisibleManager="waiting"},this),15E3):"waiting"==this.browserNotVisibleManager&&(this.browserNotVisibleManager=null,this.startStreaming())},this);$(document).on("visibilitychange",b)},deactivateWindowHideListener:function(){$(document).off("visibilitychange")},cameraInitialized:function(){},startStreaming:function(){},stopStreaming:function(){},
getPhotoContainer:function(){},getVideoContainer:function(){}}),CameraControlViewMJPEG=CameraControlView.extend({managerName:"mjpeg",canStream:!0,startStreaming:function(){var b=$.Deferred();this.setState("preparing");$.ajax({url:API_BASEURL+"camera/peer-session",method:"POST",data:JSON.stringify({sessionId:AP_SESSION_ID}),contentType:"application/json",type:"json"}).done(_.bind(function(d){this.streaming=!0;var c=this.getVideoContainer();c.attr("src","/webcam/?action=stream&time="+(new Date).getTime());
c.on("load",_.bind(function(){this.setState("streaming");this.activateWindowHideListener();c.off("load");b.resolve()},this));c.on("error",_.bind(function(d){c.off("error");this.videoStreamingError="Error while playing video";this.render();b.reject()},this))},this)).fail(_.bind(function(d){this.videoStreamingError="Unable to start video session. ("+d.status+")";this.render();b.reject()},this));return b},stopStreaming:function(){var b=$.Deferred();$.ajax({url:API_BASEURL+"camera/peer-session",method:"DELETE",
type:"json",contentType:"application/json",data:JSON.stringify({sessionId:AP_SESSION_ID})}).done(_.bind(function(){this.setState("ready");b.resolve()},this)).fail(function(){b.reject()});return b}}),CameraControlViewWebRTC=CameraControlView.extend({el:null,serverUrl:null,streamingPlugIn:null,streaming:!1,managerName:"webrtc",stoppingPromise:null,events:{hide:"onHide"},settings:null,print_capture:null,photoSeq:0,_socket:null,videoStreamingEvent:null,videoStreamingError:null,videoStreamingErrorTitle:null,
originalFunctions:null,timeoutPlayingManager:null,manageVideoStreamingEvent:function(b){this.videoStreamingError=b.message;-1<"camera settings have been changed".indexOf(b.message)?this.videoStreamingErrorTitle="Camera settings changed":this.videoStreamingErrorTitle=null;console.error(b.message)},_onVideoStreamingError:function(b){b.data&&b.data.event&&(b=b.data.event,"GstreamerFatalErrorManage"==b.type&&this.manageVideoStreaming(b.message))},cameraInitialized:function(){if(Janus.isWebrtcSupported())if(navigator.mozGetUserMedia||
"vp8"==this.settings.encoding)this.setState("ready"),this.canStream=!0;else{var b=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);b[2]&&52<=parseInt(b[2])?(this.setState("ready"),this.canStream=!0):(this.$("#camera-mode-slider").hide(),this.canStream=!1)}else this.setState("nowebrtc"),this.canStream=!1;this.canStream=!0,this.originalFunctions&&(this.startStreaming=this.originalFunctions.startStreaming,this.stopStreaming=this.originalFunctions.stopStreaming,this.onHide=this.originalFunctions.onHide,
this.initJanus=this.originalFunctions.initJanus),this.serverUrl="http://"+window.location.hostname+":8088/janus",this.initJanus(),Janus.init({debug:null,callback:function(){console.log("Janus Initialized")}});this.render()},initJanus:function(){this.streaming=!1;this.streamingPlugIn=null},startStreaming:function(){var b=$.Deferred(),d=this.getVideoContainer();this.setState("preparing");$.ajax({url:API_BASEURL+"camera/init-janus",type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8",
data:""}).done(_.bind(function(c){if(!d.is(":visible"))var f=new Janus({server:this.serverUrl,apisecret:"d5faa25fe8e3438d826efb1cd3369a50",iceServers:[{url:"stun:turn.astroprint.com:80"}],success:_.bind(function(){$.ajax({url:API_BASEURL+"camera/peer-session",type:"POST",data:JSON.stringify({sessionId:AP_SESSION_ID}),dataType:"json",contentType:"application/json; charset=UTF-8"}).fail(_.bind(function(){noty({text:"Unable to start WebRTC session.",timeout:3E3});this.setState("error")},this)).done(_.bind(function(c){this.streaming=
!0;var g="h264"==this.settings.encoding?1:2;f.attach({plugin:"janus.plugin.streaming",success:_.bind(function(b){this.streamingPlugIn=b;this.streamingPlugIn.oncleanup=_.bind(function(){this.streamingPlugIn.send({message:{request:"destroy",id:b.session.getSessionId()},success:_.bind(function(){$.ajax({url:API_BASEURL+"camera/peer-session",type:"DELETE",dataType:"json",contentType:"application/json; charset=UTF-8",data:JSON.stringify({sessionId:AP_SESSION_ID})}).done(_.bind(function(){f.sessionId=null;
this.setState("ready");this.stoppingPromise&&(this.stoppingPromise.resolve(),this.stoppingPromise=null)},this)).always(_.bind(function(){this.initJanus()},this)).fail(_.bind(function(){this.setState("error");this.stoppingPromise&&(this.stoppingPromise.reject(),this.stoppingPromise=null)},this))},this),error:function(){this.initJanus();this.setState("error");this.stoppingPromise&&(this.stoppingPromise.reject(),this.stoppingPromise=null)}})},this);this.streamingPlugIn.send({message:{request:"watch",
id:g}})},this),error:function(b){console.error(b);noty({text:"Error communicating with the WebRTC system.",timeout:3E3})},onmessage:_.bind(function(b,c){var d=b.result;if(null!==d&&void 0!==d)void 0!==d.status&&null!==d.status&&"stopped"===d.status&&this.stopStreaming();else if(void 0!==b.error&&null!==b.error){console.error(b.error);noty({text:"Unable to communicate with the camera.",timeout:3E3});this.stopStreaming();return}void 0!==c&&null!==c&&this.streamingPlugIn.createAnswer({jsep:c,media:{audioSend:!1,
videoSend:!1},success:_.bind(function(b){this.streamingPlugIn.send({message:{request:"start"},jsep:b})},this),error:_.bind(function(b){console.error(b);this.setState("error")},this)})},this),onremotestream:_.bind(function(c){$.ajax({url:API_BASEURL+"camera/start-streaming",type:"POST"}).fail(_.bind(function(){this.setState("error")},this));this.timeoutPlayingManager=window.setTimeout(_.bind(function(){e||(this.stopStreaming(),this.setState("error"),b.reject(),clearTimeout(this.timeoutPlayingManager))},
this),4E4);var e=!1;onPlaying=_.bind(function(){this.setState("streaming");e=!0;this.activateWindowHideListener();d.off("playing",onPlaying);b.resolve()},this);d.on("playing",onPlaying);d.get(0).srcObject=c;app.eventManager.on("astrobox:videoStreamingEvent",this.manageVideoStreamingEvent,this)},this),oncleanup:function(){Janus.log(" ::: Got a cleanup notification :::")}})},this))},this),error:_.bind(function(c){this.$el.hasClass("ready")||this.videoStreamingError||(console.error(c),noty({text:"Unable to start the WebRTC session.",
timeout:3E3}),streamingState="stopped",this.setState("error"));b.resolve()},this),destroyed:_.bind(this.initJanus,this)});b.resolve()},this)).fail(_.bind(function(c){noty({text:"Unable to start the WebRTC system.",timeout:3E3});this.initJanus();b.resolve()},this));return b},stopStreaming:function(){var b=$.Deferred();clearTimeout(this.timeoutPlayingManager);this.streaming&&this.streamingPlugIn?(this.stoppingPromise=null,this.streamingPlugIn.send({message:{request:"stop"},success:_.bind(function(){this.stoppingPromise=
b},this),error:function(d){b.reject(d)}})):b.resolve();return b}}),CameraControlViewMac=CameraControlView.extend({canStream:!0,startStreaming:function(){var b=$.Deferred();this.setState("preparing");setTimeout(_.bind(function(){this.setState("streaming");b.resolve()},this),1E3);return b},stopStreaming:function(){this.setState("ready");return $.Deferred().resolve()}}),CameraViewBase={mjpeg:CameraControlViewMJPEG,gstreamer:CameraControlViewWebRTC,mac:CameraControlViewMac}[CAMERA_MANAGER];var FileUploadDashboard=FileUploadCombined.extend({container:null,circleProgress:null,initialize:function(b){FileUploadCombined.prototype.initialize.call(this,b);this.container=this.$el.closest(".upload-btn")},render:function(){this.refreshAccept()},started:function(b){if(b.files&&0<b.files.length&&(this.container.addClass("uploading"),FileUploadCombined.prototype.started.call(this,b),null===this.circleProgress)){var d=this.container.find(".app-image");this.circleProgress=this.container.find(".progress").circleProgress({value:0,
animation:!1,size:d.innerWidth()-12,fill:{color:"white"}});$(window).bind("resize",_.bind(function(){this.container.hasClass("uploading")&&this.circleProgress.circleProgress({size:d.innerWidth()-12})},this))}},progress:function(b){this.container.find(".progress span").html(Math.round(b)+"<i>%</i>");this.circleProgress.circleProgress({value:b/100})},onError:function(b,d){this.container.addClass("failed").removeClass("uploading");setTimeout(_.bind(function(){this.container.removeClass("failed")},this),
3E3);var c=d;switch(d){case "http_error_401":c="An AstroPrint account is needed to upload designs";$("#login-modal").foundation("reveal","open");break;case null:c="There was an error uploading your file"}noty({text:c,timeout:3E3});console.error(d)},onPrintFileUploaded:function(){this.container.removeClass("uploading")}}),HomeView=Backbone.View.extend({el:"#home-view",uploadBtn:null,events:{show:"onShow","click .new-release a.check":"onReleaseInfoClicked","click .new-release a.close":"onCloseReleaseInfoClicked"},
initialize:function(){this.uploadBtn=new FileUploadDashboard({el:"#home-view #app-container .upload-btn .file-upload",dropZone:this.$el});this.listenTo(app.printerProfile,"change:driver",this.onDriverChanged);this.onDriverChanged(app.printerProfile,app.printerProfile.get("driver"));this.listenTo(app.socketData,"new_sw_release",_.bind(function(b){this.$(".new-release .version-label").text(b.release.major+"."+b.release.minor+"("+b.release.build+")");this.$(".new-release").removeClass("hide")},this))},
onShow:function(){this.uploadBtn.refreshAccept()},onDriverChanged:function(b,d){"marlin"==d?this.$("#app-container ul li.gcode-terminal-app-icon").removeClass("hide"):this.$("#app-container ul li.gcode-terminal-app-icon").addClass("hide")},onReleaseInfoClicked:function(b){b.preventDefault();app.router.settingsView||(app.router.settingsView=new SettingsView);app.router.settingsView.subviews["software-update"].onCheckClicked(b)},onCloseReleaseInfoClicked:function(b){b.preventDefault();this.$(".new-release").remove()}});var PrintFileInfoDialog=Backbone.View.extend({el:"#print-file-info",file_list_view:null,template:_.template($("#printfile-info-template").html()),print_file_view:null,events:{"click .actions a.remove":"onDeleteClicked","click .actions a.print":"onPrintClicked","click .actions a.download":"onDownloadClicked"},initialize:function(b){this.file_list_view=b.file_list_view},render:function(){this.$el.find(".dlg-content").html(this.template({p:this.print_file_view.print_file.toJSON(),time_format:app.utils.timeFormat}))},
open:function(b){this.print_file_view=b;this.render();this.$el.foundation("reveal","open")},onDeleteClicked:function(b){b.preventDefault();var d=this.print_file_view.print_file;if(d){var c=d.get("local_filename");d.get("id");var f=$(b.currentTarget).closest(".loading-button");f.addClass("loading");$.ajax({url:"/api/files/local/"+c,type:"DELETE",success:_.bind(function(){d.get("local_only")?this.file_list_view.file_list.remove(d):(d.set("local_filename",!1),d.set("uploaded_on",null));noty({text:c+
" deleted from your "+PRODUCT_NAME,type:"success",timeout:3E3});this.print_file_view.render();this.$el.foundation("reveal","close")},this),error:function(){noty({text:"Error deleting "+c,timeout:3E3})},always:function(){f.removeClass("loading")}})}},onPrintClicked:function(b){this.print_file_view.printClicked(b);this.$el.foundation("reveal","close")},onDownloadClicked:function(b){this.print_file_view.downloadClicked(b);this.$el.foundation("reveal","close")}}),FileUploadFiles=FileUploadCombined.extend({progressBar:null,
buttonContainer:null,initialize:function(b){this.progressBar=b.progressBar;this.buttonContainer=b.buttonContainer;FileUploadCombined.prototype.initialize.call(this,b)},started:function(b){b.files&&0<b.files.length&&(this.buttonContainer.hide(),this.progressBar.show(),FileUploadCombined.prototype.started.call(this,b))},progress:function(b,d){var c=Math.round(b);this.progressBar.find(".meter").css("width",c+"%");d||(d="Uploading ("+c+"%)");this.progressBar.find(".progress-message span").text(d)},onError:function(b,
d){var c=d;switch(d){case "http_error_401":c="An AstroPrint account is needed to upload designs";$("#login-modal").foundation("reveal","open");break;case null:c="There was an error uploading your file"}noty({text:c,timeout:3E3});this.resetUploadArea();console.error(d)},onPrintFileUploaded:function(){this.resetUploadArea()},resetUploadArea:function(){this.progressBar.hide();this.buttonContainer.show();this.progress(0)}}),UploadView=Backbone.View.extend({uploadBtn:null,progressBar:null,buttonContainer:null,
initialize:function(b){this.progressBar=this.$(".upload-progress");this.buttonContainer=this.$(".upload-buttons");this.uploadBtn=new FileUploadFiles({el:"#files-view .file-upload-view .file-upload",progressBar:this.$(".upload-progress"),buttonContainer:this.$(".file-upload-button"),dropZone:b.dropZone});this.render()},render:function(){var b=this.$(".file-upload-button");"s3g"==app.printerProfile.get("driver")?(b.find(".extensions").text("stl, x3g"),b.find("input").attr("accept",".stl, .x3g")):(b.find(".extensions").text("stl, gcode"),
b.find("input").attr("accept",".stl, .gcode, .gco"));this.uploadBtn.refreshAccept()}}),PrintFileView=Backbone.View.extend({template:_.template($("#print-file-template").html()),print_file:null,list:null,printWhenDownloaded:!1,downloadProgress:null,initialize:function(b){this.list=b.list;this.print_file=b.print_file},render:function(){var b=this.print_file.toJSON();b.local_filename?this.$el.removeClass("remote"):this.$el.addClass("remote");b.printFileName&&(b.name=b.printFileName);this.$el.empty();
this.downloadProgress=null;this.$el.html(this.template({p:b,time_format:app.utils.timeFormat,size_format:app.utils.sizeFormat}));this.delegateEvents({"click .left-section, .middle-section":"infoClicked","click a.print":"printClicked","click a.download":"downloadClicked","click a.dw-cancel":"cancelDownloadClicked"})},infoClicked:function(b){b&&b.preventDefault();this.list.info_dialog.open(this)},downloadClicked:function(b){b&&b.preventDefault();$.getJSON("/api/astroprint/print-files/"+this.print_file.get("id")+
"/download").fail(function(){noty({text:"There was an error starting the download.",timeout:3E3})})},cancelDownloadClicked:function(b){b.preventDefault();$.ajax({url:"/api/astroprint/print-files/"+this.print_file.get("id")+"/download",method:"DELETE"}).fail(function(){noty({text:"Unable to cancel download.",timeout:3E3})})},printClicked:function(b){b&&b.preventDefault();if(b=this.print_file.get("local_filename")){var d=this.$(".loading-button.print");d.addClass("loading");$.ajax({url:"/api/files/local/"+
b,type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8",data:JSON.stringify({command:"select",print:!0})}).done(_.bind(function(){setTimeout(function(){d.removeClass("loading")},2E3)},this)).fail(function(b){var f=null;409==b.status&&(f=b.responseText);noty({text:f?f:"There was an error starting the print",timeout:3E3});d.removeClass("loading")})}else this.printWhenDownloaded=!0,this.downloadClicked()}}),StorageControlView=Backbone.View.extend({print_file_view:null,events:{"click a.local":"localClicked",
"click a.cloud":"cloudClicked"},selected:null,initialize:function(b){this.print_file_view=b.print_file_view},selectStorage:function(b){this.$("a.active").removeClass("active");this.$("a."+b).addClass("active");this.selected=b;this.print_file_view.render()},localClicked:function(b){b.preventDefault();this.selectStorage("local")},cloudClicked:function(b){b.preventDefault();LOGGED_USER?this.selectStorage("cloud"):$("#login-modal").foundation("reveal","open")}}),PrintFilesListView=Backbone.View.extend({info_dialog:null,
print_file_views:[],storage_control_view:null,file_list:null,refresh_threshold:1E3,last_refresh:0,refreshing:!1,events:{"click .list-header button.sync":"forceSync"},initialize:function(b){this.file_list=new PrintFileCollection;this.info_dialog=new PrintFileInfoDialog({file_list_view:this});this.storage_control_view=new StorageControlView({el:this.$(".list-header ul.storage"),print_file_view:this});app.eventManager.on("astrobox:cloudDownloadEvent",this.downloadProgress,this);app.eventManager.on("astrobox:MetadataAnalysisFinished",
_.bind(this.onMetadataAnalysisFinished,this));this.listenTo(this.file_list,"remove",this.onFileRemoved);this.refresh(b.forceSync,b.syncCompleted)},render:function(){var b=this.$(".design-list-container"),d=this.storage_control_view.selected;b.children().detach();var c=d?_.filter(this.print_file_views,function(b){if("local"==d){if(b.print_file.get("local_filename"))return!0}else if(!b.print_file.get("local_only"))return!0;return!1}):this.print_file_views;c.length?_.each(c,function(c){b.append(c.$el)}):
b.html('<div class="empty panel radius" align="center"> <i class="icon-inbox empty-icon"></i> <h3>Nothing here yet.</h3></div>')},refresh:function(b,d){var c=(new Date).getTime();if(0==this.last_refresh||this.last_refresh<c-this.refresh_threshold)if(this.last_refresh=c,!this.refreshing){this.refreshing=!0;if(b)var f=this.$(".loading-button.sync"),c=this.file_list.syncCloud();else f=this.$(".local-loading"),c=this.file_list.fetch();f.addClass("loading");c.done(_.bind(function(){this.print_file_views=
[];this.file_list.each(_.bind(function(b,c){var d=new PrintFileView({list:this,print_file:b,attributes:{"class":"row"+(c%2?" dark":"")}});d.render();this.print_file_views.push(d)},this));this.$(".design-list-container").empty();this.render();_.isFunction(d)&&d(!0);$.localtime.format(this.$el);f.removeClass("loading");this.refreshing=!1},this)).fail(_.bind(function(){noty({text:"There was an error retrieving print files",timeout:3E3});_.isFunction(d)&&d(!1);f.removeClass("loading");this.refreshing=
!1},this))}},downloadProgress:function(b){var d=_.find(this.print_file_views,function(c){return c.print_file.get("id")==b.id});if(d){var c=d.$(".print-file-options");switch(b.type){case "progress":c.hasClass("downloading")||c.addClass("downloading");if(d.downloadProgress)d.downloadProgress.circleProgress({value:b.progress/100});else{var f=c.find(".download-progress");d.downloadProgress=f.circleProgress({value:0,animation:!1,size:c.innerWidth()-25,fill:{color:"black"}})}d.$(".download-progress span").html(Math.floor(b.progress)+
"<i>%</i>");break;case "success":if(f=d.print_file)f.set("local_filename",b.filename),f.set("print_time",b.print_time),f.set("layer_count",b.layer_count),f.set("uploaded_on",Date.now()/1E3),d.render(),$.localtime.format(d.$el),d.printWhenDownloaded&&(d.printWhenDownloaded=!1,d.printClicked());break;case "error":c.removeClass("downloading").addClass("failed");console.error("Error downloading file: "+b.reason);setTimeout(function(){c.removeClass("failed")},3E3);break;case "cancelled":c.removeClass("downloading")}}},
forceSync:function(){this.refresh(!0)},onFileRemoved:function(b){var d=_.find(this.print_file_views,function(c){return c.print_file==b});d&&(d.remove(),this.print_file_views.splice(this.print_file_views.indexOf(d),1))},onMetadataAnalysisFinished:function(b){var d=_.find(this.print_file_views,function(c){return c.print_file.get("name")==b.file});d&&(d.print_file.set("info",b.result),d.render())}}),FilesView=Backbone.View.extend({el:"#files-view",uploadView:null,printFilesListView:null,events:{show:"onShow"},
initialize:function(b){this.uploadView=new UploadView({el:this.$el.find(".file-upload-view"),dropZone:this.$el});this.printFilesListView=new PrintFilesListView({el:this.$el.find(".design-list"),forceSync:b.forceSync,syncCompleted:b.syncCompleted});this.listenTo(app.printerProfile,"change:driver",this.onDriverChanged)},refreshPrintFiles:function(){var b=$.Deferred();this.printFilesListView.refresh(!0,function(d){d?b.resolve():b.reject("unable_to_refresh")});return b},fileInfo:function(b){var d=_.find(this.printFilesListView.print_file_views,
function(c){return c.print_file.get("id")==b});this.printFilesListView.storage_control_view.selectStorage("cloud");this.showFileInfoView(d)},fileInfoByName:function(b){var d=_.find(this.printFilesListView.print_file_views,function(c){return c.print_file.get("name")==b});this.showFileInfoView(d)},showFileInfoView:function(b){b&&b.infoClicked()},onShow:function(){this.printFilesListView.refresh(!1)},onDriverChanged:function(){this.uploadView.render();this.printFilesListView.refresh(!0)}});var TempBarVerticalView=TempBarView.extend({containerDimensions:null,scale:null,type:null,dragging:!1,events:_.extend(TempBarView.prototype.events,{"click .temp-bar":"onClicked","click button.temp-off":"turnOff"}),setHandle:function(b){if(!this.dragging){var d=this._temp2px(b),c=this.$el.find(".temp-target");c.css({transition:"top 0.5s"});c.css({top:d+"px"});c.find("span.target-value").text(b);setTimeout(function(){c.css({transition:""})},800)}},onTouchMove:function(b){if(this.dragging){b.preventDefault();
b.stopPropagation();var d=this.$(".temp-target");b=("mousemove"==b.type?b.originalEvent.pageY:b.originalEvent.changedTouches[0].clientY+$(document).scrollTop())-this.containerDimensions.top-d.innerHeight()/2;b=Math.min(Math.max(b,0),this.containerDimensions.maxTop);d.css({top:b+"px"});d.find("span.target-value").text(this._px2temp(b))}},onClicked:function(b){b.preventDefault();var d=this.$el.find(".temp-target");b=b.pageY-this.containerDimensions.top-d.innerHeight()/2;b=Math.min(Math.max(b,0),this.containerDimensions.maxTop);
b=this._px2temp(b);this.setHandle(b);this._sendToolCommand("target",this.type,b)},onResize:function(){var b=this.$el.find(".temp-bar"),d=b.find(".temp-target"),c=b.find("label"),f=b.height(),d=f-d.innerHeight()-c.innerHeight();this.containerDimensions={top:b.offset().top,height:f,maxTop:d,px4degree:d/(this.scale[1]-this.scale[0])}},renderTemps:function(b,d){var c=this.$el.find(".temp-target").innerHeight();null!==b&&(this.$el.find(".current-temp-top").html(Math.round(b)+"&deg;"),this.$el.find(".current-temp").css({top:this._temp2px(b)+
c/2+"px"}));null!==d&&this.setHandle(Math.min(Math.round(d),this.scale[1]))},_temp2px:function(b){return this.containerDimensions.maxTop-b*this.containerDimensions.px4degree},_px2temp:function(b){return Math.round((this.containerDimensions.maxTop-b)/this.containerDimensions.px4degree)}}),TempView=Backbone.View.extend({el:"#temp-control",nozzleTempBar:null,bedTempBar:null,initialize:function(){this.nozzleTempBar=new TempBarVerticalView({scale:[0,app.printerProfile.get("max_nozzle_temp")],el:this.$el.find(".temp-control-cont.nozzle"),
type:"tool0"});this.bedTempBar=new TempBarVerticalView({scale:[0,app.printerProfile.get("max_bed_temp")],el:this.$el.find(".temp-control-cont.bed"),type:"bed"})},render:function(){var b=app.printerProfile.toJSON();this.nozzleTempBar.setMax(b.max_nozzle_temp);b.heated_bed?(this.bedTempBar.setMax(b.max_bed_temp),this.bedTempBar.$el.removeClass("disabled")):this.bedTempBar.$el.addClass("disabled")},resetBars:function(){this.nozzleTempBar.onResize();this.bedTempBar.onResize()},updateBars:function(b){b.extruder&&
this.nozzleTempBar.setTemps(b.extruder.actual,b.extruder.target);b.bed&&this.bedTempBar.setTemps(b.bed.actual,b.bed.target)}}),DistanceControl=Backbone.View.extend({el:"#distance-control",selected:10,events:{"click button":"selectDistance"},selectDistance:function(b){b=$(b.currentTarget);this.$el.find(".success").removeClass("success").addClass("secondary");b.addClass("success").removeClass("secondary");this.selected=b.attr("data-value")}}),MovementControlView=Backbone.View.extend({distanceControl:null,
printerProfile:null,initialize:function(b){this.distanceControl=b.distanceControl},sendJogCommand:function(b,d,c){"undefined"===typeof c&&(c=10);var f={command:"jog"};f[b]=c*d;$.ajax({url:API_BASEURL+"printer/printhead",type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8",data:JSON.stringify(f)})},sendHomeCommand:function(b){$.ajax({url:API_BASEURL+"printer/printhead",type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8",data:JSON.stringify({command:"home",
axes:b})})}}),XYControlView=MovementControlView.extend({el:"#xy-controls",events:{"click .control_btn_x_plus":"xPlusTapped","click .control_btn_x_minus":"xMinusTapped","click .control_btn_y_plus":"yPlusTapped","click .control_btn_y_minus":"yMinusTapped","click .home_z":"homeTapped"},xPlusTapped:function(){this.sendJogCommand("x",1,this.distanceControl.selected)},xMinusTapped:function(){this.sendJogCommand("x",-1,this.distanceControl.selected)},yPlusTapped:function(){this.sendJogCommand("y",1,this.distanceControl.selected)},
yMinusTapped:function(){this.sendJogCommand("y",-1,this.distanceControl.selected)},homeTapped:function(){app.socketData.get("paused")||this.sendHomeCommand(["x","y"])}}),ZControlView=MovementControlView.extend({el:"#z-controls",events:{"click .control_btn_z_plus":"zPlusTapped","click .control_btn_z_minus":"zMinusTapped","click .home_z":"homeTapped"},zPlusTapped:function(){this.sendJogCommand("z",1,this.distanceControl.selected)},zMinusTapped:function(){this.sendJogCommand("z",-1,this.distanceControl.selected)},
homeTapped:function(){app.socketData.get("paused")||this.sendHomeCommand("z")}}),ExtrusionControlView=Backbone.View.extend({el:"#extrusion-control",template:null,events:{"click .extrude":"extrudeTapped","click .retract":"retractTapped","change .extrusion-length":"lengthChanged","change .extrusion-speed":"speedChanged","keydown input.back-to-select":"onKeyDownBackToSelect"},initialize:function(){this.template=_.template(this.$("#extruder-switch-template").html())},render:function(){var b=app.printerProfile.toJSON();
this.$(".row.extruder-switch").html(this.template({profile:b}));1<b.extruder_count&&(this.events["change .extruder-number"]="extruderChanged");this.delegateEvents(this.events)},extrudeTapped:function(){this._checkAmount()&&this._sendExtrusionCommand(1)},retractTapped:function(){this._checkAmount()&&this._sendExtrusionCommand(-1)},lengthChanged:function(b){b=$(b.target);"other"==b.val()?(b.addClass("hide"),this.$(".other-length").removeClass("hide").find("input").focus().select()):this.$('input[name="extrusion-length"]').val(b.val())},
speedChanged:function(b){b=$(b.target);"other"==b.val()?(b.addClass("hide"),this.$(".other-speed").removeClass("hide").find("input").focus().select()):this.$('input[name="extrusion-speed"]').val(b.val())},extruderChanged:function(b){this._sendChangeToolCommand($(b.target).val())},onKeyDownBackToSelect:function(b){if(27==b.keyCode){b=$(b.currentTarget);var d=b.closest("div.select-with-text").find("select"),c=d.find("option[default]").val();b.closest(".row").addClass("hide");b.val(c);d.removeClass("hide").val(c)}},
_sendChangeToolCommand:function(b){$.ajax({url:API_BASEURL+"printer/tool",type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8",data:JSON.stringify({command:"select",tool:"tool"+b})})},_checkAmount:function(){return!isNaN(this.$el.find('input[name="extrusion-length"]').val())},_sendExtrusionCommand:function(b){b={command:"extrude",amount:parseFloat(this.$('input[name="extrusion-length"]').val()*b),speed:parseFloat(this.$('input[name="extrusion-speed"]').val())};var d=this.$("select.extruder-number").val();
d&&(b.tool="tool"+d);$.ajax({url:API_BASEURL+"printer/tool",type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8",data:JSON.stringify(b)})}}),FanControlView=Backbone.View.extend({el:"#temp-control .fan-control",events:{"click button.fan-on":"fanOn","click button.fan-off":"fanOff"},fanOn:function(){this._setFanSpeed(255);this.$(".fan_icon").addClass("animate-spin")},fanOff:function(){this._setFanSpeed(0);this.$(".fan_icon").removeClass("animate-spin")},_setFanSpeed:function(b){$.ajax({url:API_BASEURL+
"printer/fan",type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8",data:JSON.stringify({command:"set",tool:0,speed:b})})}}),ControlView=Backbone.View.extend({el:"#control-view",events:{"click .back-to-print button":"resumePrinting",show:"render"},tempView:null,distanceControl:null,xyControlView:null,zControlView:null,extrusionView:null,fanView:null,initialize:function(){this.tempView=new TempView;this.distanceControl=new DistanceControl;this.xyControlView=new XYControlView({distanceControl:this.distanceControl});
this.zControlView=new ZControlView({distanceControl:this.distanceControl});this.extrusionView=new ExtrusionControlView;this.fanView=new FanControlView;this.listenTo(app.socketData,"change:temps",this.updateTemps);this.listenTo(app.socketData,"change:paused",this.onPausedChanged)},updateTemps:function(b,d){this.$el.hasClass("hide")||this.tempView.updateBars(d)},render:function(){this.onPausedChanged(app.socketData,app.socketData.get("paused"));this.extrusionView.render();this.tempView.render()},resumePrinting:function(b){app.setPrinting();
app.router.navigate("printing",{replace:!0,trigger:!0});app.router.printingView.togglePausePrint(b);this.$el.addClass("hide")},onPrintingProgressChanged:function(b,d){var c=this.$(".back-to-print .filename");d&&d.printFileName&&d.printFileName!=c.text()&&c.text(d.printFileName)},onPausedChanged:function(b,d){d?(this.listenTo(app.socketData,"change:printing_progress",this.onPrintingProgressChanged),this.$el.addClass("print-paused")):(this.stopListening(app.socketData,"change:printing_progress"),app.socketData.get("printing")?
app.router.navigate("printing",{replace:!0,trigger:!0}):this.$el.removeClass("print-paused"))}});var SettingsPage=Backbone.View.extend({parent:null,initialize:function(b){this.parent=b.parent},show:function(){this.parent.$el.find(".settings-page").addClass("hide");this.$el.removeClass("hide")}}),PrinterConnectionView=SettingsPage.extend({el:"#printer-connection",template:_.template($("#printer-connection-settings-page-template").html()),settings:null,initialize:function(b){this.listenTo(app.socketData,"change:printer",this.printerStatusChanged);SettingsPage.prototype.initialize.call(this,b)},
show:function(){SettingsPage.prototype.show.apply(this);this.settings?this.render():this.getInfo()},getInfo:function(){this.$("a.retry-ports i").addClass("animate-spin");$.getJSON(API_BASEURL+"settings/printer",null,_.bind(function(b){b.serial?(this.settings=b,this.render()):noty({text:"No serial settings found.",timeout:3E3})},this)).fail(function(){noty({text:"There was an error getting serial settings.",timeout:3E3});this.$("a.retry-ports i").removeClass("animate-spin")})},render:function(){this.$("form").html(this.template({settings:this.settings}));
this.printerStatusChanged(app.socketData,app.socketData.get("printer"));this.delegateEvents({"change #settings-baudrate":"saveConnectionSettings","change #settings-serial-port":"saveConnectionSettings","click a.retry-ports":"retryPortsClicked","click .loading-button.test-connection button":"testConnection"})},retryPortsClicked:function(b){b.preventDefault();this.getInfo()},saveConnectionSettings:function(b){var d={};_.each(this.$("form").serializeArray(),function(b){d[b.name]=b.value});d.port&&(this.$(".loading-button.test-connection").addClass("loading"),
this.$(".connection-status").removeClass("failed connected").addClass("connecting"),$.ajax({url:API_BASEURL+"connection",type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8",data:JSON.stringify({command:"connect",driver:d.driver,port:d.port,baudrate:d.baudrate?parseInt(d.baudrate):null,autoconnect:!0,save:!0})}).fail(function(){noty({text:"There was an error testing connection settings.",timeout:3E3})}))},printerStatusChanged:function(b,d){this.$(".connection-status").removeClass("connecting failed connected").addClass(d.status);
"connecting"!=d.status&&this.$(".loading-button.test-connection").removeClass("loading")},testConnection:function(b){b.preventDefault();this.saveConnectionSettings()}}),PrinterProfileView=SettingsPage.extend({el:"#printer-profile",template:_.template($("#printer-profile-settings-page-template").html()),settings:null,initialize:function(b){SettingsPage.prototype.initialize.call(this,b);this.settings=app.printerProfile},show:function(){SettingsPage.prototype.show.apply(this);this.render()},render:function(){this.$el.html(this.template({settings:this.settings.toJSON()}));
this.$el.foundation();this.$("#extruder-count").val(this.settings.get("extruder_count"));this.delegateEvents({"invalid.fndtn.abide form":"invalidForm","valid.fndtn.abide form":"validForm","change input[name='heated_bed']":"heatedBedChanged","change select[name='driver']":"driverChanged"})},heatedBedChanged:function(b){b=$(b.currentTarget);var d=this.$(".input-wrapper.max_bed_temp");b.is(":checked")?d.removeClass("hide"):d.addClass("hide")},driverChanged:function(b){b=$(b.currentTarget);var d=this.$(".input-wrapper.cancel-gcode");
"s3g"==b.val()?d.addClass("hide"):d.removeClass("hide")},invalidForm:function(b){"abide.fndtn"===b.namespace&&noty({text:"Please check your errors",timeout:3E3})},validForm:function(b){if("abide.fndtn"===b.namespace){b=this.$("form");var d=b.find(".loading-button"),c={};d.addClass("loading");b.find("input, select, textarea").each(function(b,d){var g=null;d=$(d);g=d.is('input[type="radio"], input[type="checkbox"]')?d.is(":checked"):d.val();c[d.attr("name")]=g});c.cancel_gcode=c.cancel_gcode.trim().split("\n");
this.settings.save(c,{patch:!0,success:_.bind(function(){noty({text:"Profile changes saved",timeout:3E3,type:"success"});d.removeClass("loading");this.parent.subviews["printer-connection"].settings=null},this),error:function(){noty({text:"Failed to save printer profile changes",timeout:3E3});d.removeClass("loading")}})}}}),NetworkNameView=SettingsPage.extend({el:"#network-name",template:_.template($("#network-name-settings-page-template").html()),events:{"invalid.fndtn.abide form":"invalidForm","valid.fndtn.abide form":"validForm",
"keyup #network-name":"nameChanged"},show:function(){SettingsPage.prototype.show.apply(this);this.settings||$.getJSON(API_BASEURL+"settings/network/name",null,_.bind(function(b){this.settings=b;this.render()},this)).fail(function(){noty({text:"There was an error getting current network name.",timeout:3E3})})},render:function(){this.$el.html(this.template({settings:this.settings}));this.$el.foundation();this.delegateEvents(this.events)},nameChanged:function(b){b=$(b.currentTarget);this.$("span.network-name").text(b.val())},
invalidForm:function(b){"abide.fndtn"===b.namespace&&noty({text:"Please check your errors",timeout:3E3})},validForm:function(b){if("abide.fndtn"===b.namespace){b=this.$("form");var d=b.find(".loading-button"),c={};d.addClass("loading");b.find("input").each(function(b,d){d=$(d);c[d.attr("name")]=d.val()});$.ajax({url:API_BASEURL+"settings/network/name",type:"POST",contentType:"application/json",dataType:"json",data:JSON.stringify(c)}).done(_.bind(function(b){noty({text:"Network name changed. Use it next time you reboot",
timeout:3E3,type:"success"});this.settings=b;this.render();this.parent.subviews["network-name"].settings=null},this)).fail(function(){noty({text:"Failed to save network name",timeout:3E3})}).always(function(){d.removeClass("loading")})}}}),CameraVideoStreamView=SettingsPage.extend({el:"#video-stream",template:_.template($("#video-stream-settings-page-template").html()),settings:null,settingsSizeDefault:"640x480",cameraName:"No camera plugged",events:{"submit form":"onFormSubmit","click #buttonRefresh":"refreshPluggedCamera",
"change #video-stream-encoding":"changeEncoding","change #video-stream-source":"changeSource"},show:function(b){var d=this.$("form").find(".loading-button");SettingsPage.prototype.show.apply(this);this.settings?this.render():$.getJSON(API_BASEURL+"camera/connected").done(_.bind(function(b){b.isCameraConnected?(this.cameraName!=b.cameraName&&(this.cameraName=b.cameraName),$.getJSON(API_BASEURL+"settings/camera",null,_.bind(function(b){b.structure?(this.settings=b,$.getJSON(API_BASEURL+"camera/has-properties").done(_.bind(function(c){c.hasCameraProperties?
$.getJSON(API_BASEURL+"camera/is-resolution-supported",{size:b.size}).done(_.bind(function(b){b.isResolutionSupported?this.videoSettingsError=null:(this.settings.size=this.settingsSizeDefault,$.ajax({url:API_BASEURL+"settings/camera",type:"POST",contentType:"application/json",dataType:"json",data:JSON.stringify(this.settings)}),noty({text:"Lowering your camera input resolution",type:"warning",timeout:3E3}),this.videoSettingsError=null,this.saveData());this.render()},this)).fail(function(){noty({text:"There was an error reading your camera settings.",
timeout:3E3})}).always(_.bind(function(){d.removeClass("loading")},this)):(this.videoSettingsError="Unable to communicate with your camera. Please, re-connect the camera and try again...",this.render())},this)).fail(_.bind(function(){this.videoSettingsError="Unable to communicate with your camera. Please, re-connect the camera and try again...";this.render()},this))):(this.videoSettingsError="The camera connected is not supported.<br>The minimal resolution is less than 640x480 (minimal resolution supported).",
this.render())},this)).fail(function(){noty({text:"There was an error getting Camera settings.",timeout:3E3})})):(this.cameraName=this.videoSettingsError=null,this.render())},this))},changeSource:function(b){"raspicam"==this.$("#video-stream-source option:selected").val()?(this.$("#video-stream-encoding").prop("value","h264"),this.$("#video-stream-encoding").prop("disabled","disabled"),this.onFormSubmit()):this.$("#video-stream-encoding").prop("disabled","")},changeEncoding:function(b){this.settings||
(b=$("#video-stream-format option:selected").val(),$.ajax({url:API_BASEURL+"settings/camera",type:"POST",contentType:"application/json",dataType:"json",data:JSON.stringify({format:b})}).done(_.bind(function(b){this.settings=b},this)))},refreshPluggedCamera:function(){var b=this.$("#buttonRefresh").addClass("loading");$.post(API_BASEURL+"camera/refresh-plugged").done(_.bind(function(b){b.isCameraPlugged?(this.settings=null,this.cameraName="",this.show()):(this.cameraName=!1,this.render())},this)).always(function(){b.removeClass("loading")})},
render:function(){this.$el.html(this.template({settings:this.settings}));this.$el.foundation();this.delegateEvents(this.events);"raspicam"==this.$("#video-stream-source option:selected").val()?(this.$("#video-stream-encoding").prop("value","h264"),this.$("#video-stream-encoding").prop("disabled","disabled")):this.$("#video-stream-encoding").prop("disabled","")},onFormSubmit:function(b){b.preventDefault();this.saveData();return!1},saveData:function(){var b=this.$("form"),d=b.find(".loading-button"),
c={};d.addClass("loading");b.find("input, select, textarea").each(function(b,d){var g=null;d=$(d);g=d.is('input[type="radio"], input[type="checkbox"]')?d.is(":checked"):d.val();c[d.attr("name")]=g});$.getJSON(API_BASEURL+"camera/is-resolution-supported",{size:c.size}).done(_.bind(function(b){b.isResolutionSupported?$.ajax({url:API_BASEURL+"settings/camera",type:"POST",contentType:"application/json",dataType:"json",data:JSON.stringify(c)}).done(_.bind(function(b){this.settings=b;noty({text:"Camera changes saved",
timeout:3E3,type:"success"});this.parent.subviews["video-stream"].settings=null},this)).fail(function(){noty({text:"There was a problem saving camera settings",timeout:3E3})}).always(_.bind(function(){d.removeClass("loading")},this)):noty({text:"The resolution is not supported by your camera",timeout:3E3})},this)).fail(function(){noty({text:"There was a problem saving camera settings",timeout:3E3})}).always(_.bind(function(){d.removeClass("loading")},this))}}),InternetConnectionView=SettingsPage.extend({el:"#internet-connection",
template:_.template($("#internet-connection-settings-page-template").html()),networksDlg:null,storedWifiDeleteDlg:null,settings:null,events:{"click .loading-button.list-networks button":"listNetworksClicked","click .stored-wifis .row .action":"onDeleteNetworkClicked"},initialize:function(b){SettingsPage.prototype.initialize.apply(this,arguments);this.networksDlg=new WiFiNetworksDialog({parent:this});this.storedWifiDeleteDlg=new DeleteWifiNetworkDialog},show:function(){SettingsPage.prototype.show.apply(this);
this.settings||$.getJSON(API_BASEURL+"settings/network",null,_.bind(function(b){this.settings=b;this.render()},this)).fail(function(){noty({text:"There was an error getting WiFi settings.",timeout:3E3})})},render:function(){this.$el.html(this.template({settings:this.settings}))},connect:function(b,d){var c=$.Deferred();$.ajax({url:API_BASEURL+"settings/network/active",type:"POST",contentType:"application/json",dataType:"json",data:JSON.stringify({id:b,password:d})}).done(_.bind(function(b){if(b.name){var d=
null,g=setTimeout(function(){d.call(this,{status:"failed",reason:"timeout"})},7E4),d=function(h){switch(h.status){case "disconnected":case "connecting":break;case "connected":app.eventManager.off("astrobox:InternetConnectingStatus",d,this);noty({text:"Your "+PRODUCT_NAME+" is now connected to "+b.name+".",type:"success",timeout:3E3});this.settings.networks.wireless=b;this.render();c.resolve();clearTimeout(g);break;case "failed":app.eventManager.off("astrobox:InternetConnectingStatus",d,this);message=
"no_secrets"==h.reason?"Invalid password for "+b.name+".":"Unable to connect to "+b.name+".";c.reject(message);clearTimeout(g);break;default:app.eventManager.off("astrobox:InternetConnectingStatus",d,this),c.reject("Unable to connect to "+b.name+"."),clearTimeout(g)}};app.eventManager.on("astrobox:InternetConnectingStatus",d,this)}else b.message&&(noty({text:b.message,timeout:3E3}),c.reject())},this)).fail(_.bind(function(){noty({text:"There was an error saving setting.",timeout:3E3});c.reject()},
this));return c},listNetworksClicked:function(b){var d=$(b.target).closest(".loading-button");d.addClass("loading");$.getJSON(API_BASEURL+"settings/network/wifi-networks",_.bind(function(b){if(b.message)noty({text:b.message});else if(b.networks){var d=this;this.networksDlg.open(_.sortBy(_.uniq(_.sortBy(b.networks,function(b){return b.name}),!0,function(b){return b.name}),function(b){b.active=d.settings.networks.wireless&&d.settings.networks.wireless.name==b.name;return-b.signal}))}},this)).fail(function(){noty({text:"There was an error retrieving networks.",
timeout:3E3})}).complete(function(){d.removeClass("loading")})},onDeleteNetworkClicked:function(b){b.preventDefault();var d=$(b.currentTarget).closest(".row");this.storedWifiDeleteDlg.open({id:d.data("id"),name:d.find(".name").text(),active:d.hasClass("active")}).done(function(b){b&&d.remove()}).fail(function(){noty({text:"Unable to Delete Stored Network"})})}}),DeleteWifiNetworkDialog=Backbone.View.extend({el:"#delete-stored-wifi-modal",networkId:null,promise:null,events:{"click button.secondary":"doClose",
"click button.alert":"doDelete",close:"onClose"},open:function(b){this.promise=$.Deferred();this.networkId=b.id;this.$(".name").text(b.name);b.active?this.$el.addClass("active"):this.$el.removeClass("active");this.$el.foundation("reveal","open");return this.promise},onClose:function(){"pending"==this.promise.state()&&this.promise.resolve(!1)},doClose:function(){this.$el.foundation("reveal","close")},doDelete:function(b){b.preventDefault();var d=$(b.currentTarget).closest(".loading-button");d.addClass("loading");
$.ajax({url:API_BASEURL+"settings/network/stored-wifi/"+this.networkId,type:"DELETE"}).done(_.bind(function(){this.promise.resolve(!0)},this)).fail(_.bind(function(){this.promise.reject()},this)).always(_.bind(function(){d.removeClass("loading");this.doClose()},this))}}),WiFiNetworkPasswordDialog=Backbone.View.extend({el:"#wifi-network-password-modal",events:{"click button.connect":"connectClicked","submit form":"connect","change #show-password":"onShowPasswordChanged"},template:_.template($("#wifi-network-password-modal-template").html()),
parent:null,initialize:function(b){this.parent=b.parent},render:function(b){this.$el.html(this.template({wifi:b}))},open:function(b){this.render(b);this.$el.foundation("reveal","open",{close_on_background_click:!1,close_on_esc:!1});this.$el.one("opened",_.bind(function(){this.$el.find(".network-password-field").focus()},this))},connectClicked:function(b){b.preventDefault();this.$("form").submit()},onShowPasswordChanged:function(b){b=$(b.currentTarget).is(":checked");var d=this.$("input[name=password]");
b?d.attr("type","text"):d.attr("type","password")},connect:function(b){b.preventDefault();var d=$(b.currentTarget);b=d.find(".network-id-field").val();var c=d.find(".network-password-field").val(),f=this.$("button.connect").closest(".loading-button"),e=this.$("button.cancel");f.addClass("loading");e.hide();this.parent.connect(b,c).done(_.bind(function(){d.find(".network-password-field").val("");this.$el.foundation("reveal","close");f.removeClass("loading");e.show()},this)).fail(_.bind(function(b){f.removeClass("loading");
e.show();noty({text:b,timeout:3E3});this.$el.foundation("reveal","close")},this));return!1}}),WiFiNetworksDialog=Backbone.View.extend({el:"#wifi-network-list-modal",networksTemplate:_.template($("#wifi-network-modal-row").html()),passwordDlg:null,parent:null,networks:null,initialize:function(b){this.parent=b.parent},open:function(b){var d=this.$el.find(".modal-content");d.empty();this.networks=b;d.html(this.networksTemplate({networks:this.networks}));d.find("button").bind("click",_.bind(this.networkSelected,
this));this.$el.foundation("reveal","open")},networkSelected:function(b){b.preventDefault();b=$(b.target);this.passwordDlg||(this.passwordDlg=new WiFiNetworkPasswordDialog({parent:this.parent}));var d=this.networks[b.data("id")];if(d.secured)this.passwordDlg.open(d);else{var c=b.closest(".loading-button");c.addClass("loading");this.parent.connect(d.id,null).done(_.bind(function(){this.$el.foundation("reveal","close");c.removeClass("loading")},this)).fail(function(b){noty({text:b,timeout:3E3});c.removeClass("loading")})}}}),
WifiHotspotView=SettingsPage.extend({el:"#wifi-hotspot",template:_.template($("#wifi-hotspot-settings-page-template").html()),settings:null,events:{"click .loading-button.start-hotspot button":"startHotspotClicked","click .loading-button.stop-hotspot button":"stopHotspotClicked","change .hotspot-off input":"hotspotOffChanged"},show:function(){SettingsPage.prototype.show.apply(this);this.settings||$.getJSON(API_BASEURL+"settings/network/hotspot",null,_.bind(function(b){this.settings=b;this.render()},
this)).fail(function(){noty({text:"There was an error getting WiFi Hotspot settings.",timeout:3E3})})},render:function(){this.$el.html(this.template({settings:this.settings}))},startHotspotClicked:function(b){var d=$(b.target).closest(".loading-button");d.addClass("loading");$.ajax({url:API_BASEURL+"settings/network/hotspot",type:"POST",success:_.bind(function(b,d,e){noty({text:"Your "+PRODUCT_NAME+" has created a hotspot. Connect to <b>"+this.settings.hotspot.name+"</b>.",type:"success",timeout:3E3});
this.settings.hotspot.active=!0;this.render()},this),error:function(b){noty({text:b.responseText,timeout:3E3})},complete:function(){d.removeClass("loading")}})},stopHotspotClicked:function(b){var d=$(b.target).closest(".loading-button");d.addClass("loading");$.ajax({url:API_BASEURL+"settings/network/hotspot",type:"DELETE",success:_.bind(function(b,d,e){noty({text:"The hotspot has been stopped",type:"success",timeout:3E3});this.settings.hotspot.active=!1;this.render()},this),error:function(b){noty({text:b.responseText,
timeout:3E3})},complete:function(){d.removeClass("loading")}})},hotspotOffChanged:function(b){var d=$(b.currentTarget).is(":checked");$.ajax({url:"/api/settings/network/hotspot",method:"PUT",data:JSON.stringify({hotspotOnlyOffline:d}),contentType:"application/json",dataType:"json"}).done(_.bind(function(){this.settings.hotspot.hotspotOnlyOffline=d},this)).fail(function(){noty({text:"There was an error saving hotspot option.",timeout:3E3})})}}),SoftwareUpdateView=SettingsPage.extend({el:"#software-update",
events:{"click .loading-button.check button":"onCheckClicked"},systemInfo:null,outdatedTemplate:null,updateDialog:null,show:function(){SettingsPage.prototype.show.apply(this);this.systemInfo||$.getJSON(API_BASEURL+"settings/software/system-info",null,_.bind(function(b){this.systemInfo=b;b.outdated&&(this.outdatedTemplate||(this.outdatedTemplate=_.template($("#software-system-outdated-template").html())),this.$el.prepend(this.outdatedTemplate(b)))},this)).fail(function(){noty({text:"There was an error getting System Information.",
timeout:3E3})})},onCheckClicked:function(b){var d=this.$el.find(".loading-button.check");d.addClass("loading");$.ajax({url:API_BASEURL+"settings/software/check",type:"GET",dataType:"json",success:_.bind(function(b){this.updateDialog||(this.updateDialog=new SoftwareUpdateDialog);this.updateDialog.open(b)},this),error:function(b){400==b.status?noty({text:b.responseText,timeout:3E3}):noty({text:"There was a problem checking for new software.",timeout:3E3})},complete:function(){d.removeClass("loading")}})}}),
SoftwareUpdateDialog=Backbone.View.extend({el:"#software-update-modal",data:null,contentTemplate:null,open:function(b){this.contentTemplate||(this.contentTemplate=_.template($("#software-update-modal-content").text()));this.data=b;var d=this.$el.find(".content");d.empty();d.html(this.contentTemplate({data:b,date_format:app.utils.dateFormat}));d.find("button.cancel").bind("click",_.bind(this.close,this));d.find("button.go").bind("click",_.bind(this.doUpdate,this));this.$el.foundation("reveal","open")},
close:function(){this.$el.foundation("reveal","close")},doUpdate:function(){var b=this.$el.find(".loading-button");b.addClass("loading");$.ajax({url:API_BASEURL+"settings/software/update",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({release_id:this.data.release.id}),success:function(){location.reload()},error:function(d){400==d.status?noty({text:d.responseText,timeout:3E3}):noty({text:"There was a problem updating to the new version.",timeout:3E3});b.removeClass("loading")}})}}),
SoftwareAdvancedView=SettingsPage.extend({el:"#software-advanced",template:_.template($("#software-advanced-content-template").html()),resetConfirmDialog:null,sendLogDialog:null,clearLogDialog:null,settings:null,events:{"change #serial-logs":"serialLogChanged","change #apikey-regenerate":"regenerateApiKeyChange"},initialize:function(b){SettingsPage.prototype.initialize.apply(this,arguments);this.resetConfirmDialog=new ResetConfirmDialog;this.sendLogDialog=new SendLogDialog;this.clearLogDialog=new ClearLogsDialog({parent:this})},
show:function(){SettingsPage.prototype.show.apply(this);this.settings||$.getJSON(API_BASEURL+"settings/software/advanced",null,_.bind(function(b){this.settings=b;this.render()},this)).fail(function(){noty({text:"There was an error getting software advanced settings.",timeout:3E3})})},render:function(){this.$el.html(this.template({data:this.settings,size_format:app.utils.sizeFormat}))},regenerateApiKeyChange:function(b){var d=$(b.currentTarget),c=d.is(":checked");$.ajax({url:"/api/settings/software/advanced/apikey",
method:"PUT",data:JSON.stringify({regenerate:c}),contentType:"application/json",dataType:"json"}).fail(function(){noty({text:"There was an error changing key regeneration.",timeout:3E3});d.prop("checked",!c)})},serialLogChanged:function(b){var d=$(b.currentTarget),c=d.is(":checked");$.ajax({url:"/api/settings/software/logs/serial",method:"PUT",data:JSON.stringify({active:c}),contentType:"application/json",dataType:"json"}).done(function(){c?$("#app").addClass("serial-log"):$("#app").removeClass("serial-log")}).fail(function(){noty({text:"There was an error changing serial logs.",
timeout:3E3});d.prop("checked",!c)})}}),SendLogDialog=Backbone.View.extend({el:"#send-logs-modal",events:{"click button.secondary":"doClose","click button.success":"doSend","open.fndtn.reveal":"onOpen"},onOpen:function(){this.$("input[name=ticket]").val("");this.$("textarea[name=message]").val("")},doClose:function(){this.$el.foundation("reveal","close");this.$("input[name=ticket]").val("");this.$("textarea[name=message]").val("")},doSend:function(){var b=this.$(".loading-button"),d={ticket:this.$("input[name=ticket]").val(),
message:this.$("textarea[name=message]").val()};b.addClass("loading");$.post(API_BASEURL+"settings/software/logs",d).done(_.bind(function(){noty({text:"Logs sent to AstroPrint!",type:"success",timeout:3E3});this.$el.foundation("reveal","close");this.$("input[name=ticket]").val("");this.$("textarea[name=message]").val("")},this)).fail(function(){noty({text:"There was a problem sending your logs.",timeout:3E3})}).always(function(){b.removeClass("loading")})}}),ClearLogsDialog=Backbone.View.extend({el:"#delete-logs-modal",
events:{"click button.secondary":"doClose","click button.alert":"doDelete","open.fndtn.reveal":"onOpen"},parent:null,initialize:function(b){this.parent=b.parent},doClose:function(){this.$el.foundation("reveal","close")},doDelete:function(){this.$(".loading-button").addClass("loading");$.ajax({url:API_BASEURL+"settings/software/logs",type:"DELETE",contentType:"application/json",dataType:"json",data:JSON.stringify({}),success:_.bind(function(){this.parent.$(".size").text("0 kB");this.doClose()},this),
error:function(){noty({text:"There was a problem clearing your logs.",timeout:3E3})},complete:_.bind(function(){this.$(".loading-button").removeClass("loading")},this)})}}),ResetConfirmDialog=Backbone.View.extend({el:"#restore-confirm-modal",events:{"click button.secondary":"doClose","click button.alert":"doReset","open.fndtn.reveal":"onOpen"},onOpen:function(){this.$("input").val("")},doClose:function(){this.$el.foundation("reveal","close")},doReset:function(){if("RESET"==this.$("input").val()){var b=
this.$(".loading-button");b.addClass("loading");$.ajax({url:API_BASEURL+"settings/software/settings",type:"DELETE",contentType:"application/json",dataType:"json",data:JSON.stringify({})}).done(function(){noty({text:"Device Reset, please wait for reload...",type:"success",timeout:7E3});setTimeout(function(){location.href=""},7E3)}).fail(function(){b.removeClass("loading");noty({text:"There was a problem with your reset.",timeout:3E3})})}}}),SettingsMenu=Backbone.View.extend({el:"#settings-side-bar",
subviews:null,initialize:function(b){b.subviews&&(this.subviews=b.subviews)},changeActive:function(b){var d=this.$el.find("li."+b);this.$el.find("li.active").removeClass("active");d.closest("li").addClass("active");this.subviews[b].show()}}),SettingsView=Backbone.View.extend({el:"#settings-view",menu:null,subviews:null,initialize:function(){this.subviews={"printer-connection":new PrinterConnectionView({parent:this}),"printer-profile":new PrinterProfileView({parent:this}),"network-name":new NetworkNameView({parent:this}),
"internet-connection":new InternetConnectionView({parent:this}),"video-stream":new CameraVideoStreamView({parent:this}),"wifi-hotspot":new WifiHotspotView({parent:this}),"software-update":new SoftwareUpdateView({parent:this}),"software-advanced":new SoftwareAdvancedView({parent:this})};this.menu=new SettingsMenu({subviews:this.subviews})},onShow:function(){this.subviews["printer-connection"].show()}});var ConnectionView=Backbone.View.extend({el:"#connection-view",events:{"click i.printer":"printerTapped","click i.server":"serverTapped","click i.astroprint":"astroprintTapped","mouseover i":"onMouseOver","mouseout i":"onMouseOut","mouseover a.offline":"onMouseOver","mouseout a.offline":"onMouseOut"},socketData:null,tooltip:null,initialize:function(b){this.socketData=b.socket;this.listenTo(this.socketData,"change:box_reachable",this.onReachableChanged)},connect:function(b){var d=this;$.ajax({url:API_BASEURL+
"connection",method:"GET",dataType:"json",success:function(c){if("Error"==c.current.state.substr(0,5)||"Closed"==c.current.state||"Offline"==c.current.state){"Error"==c.current.state.substr(0,5)&&console.error("Printer connection had error: "+c.current.state);var f=c.options.portPreference;c.options.ports&&!_.has(c.options.ports,f)&&(f=_.keys(c.options.ports)[0]);f?(c={command:"connect",port:f,baudrate:c.options.baudratePreference,autoconnect:!0},d.setPrinterConnection("blink-animation"),$.ajax({url:API_BASEURL+
"connection",type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8",data:JSON.stringify(c),error:function(){d.setPrinterConnection("failed");b&&(app.router.navigate("settings/printer-connection",{trigger:!0,replace:!0}),noty({text:"Check Connection Settings.",type:"information",timeout:3E3}))}})):b&&(app.router.navigate("settings/printer-connection",{trigger:!0,replace:!0}),noty({text:"Check Connection Settings.",type:"information",timeout:3E3}))}else if("Connecting"!=c.current.state){if("Printing"==
c.current.state||"Paused"==c.current.state)app.setPrinting(),"Printing"==c.current.state&&app.router.navigate("printing",{replace:!0,trigger:!0});d.setPrinterConnection("connected")}else d.setPrinterConnection("blink-animation")}})},disconnect:function(){$.ajax({url:API_BASEURL+"connection",type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8",data:JSON.stringify({command:"disconnect"}),success:function(b){self.$el.removeClass("connected")}})},setServerConnection:function(b){var d=
this.$el.find("i.server"),c="";d.removeClass("blink-animation connected failed").addClass(b);switch(b){case "blink-animation":c="Connecting to <b>"+ASTROBOX_NAME+"</b>...";break;case "connected":c="Connected to <b>"+ASTROBOX_NAME+"</b>";break;case "failed":c="<b>"+ASTROBOX_NAME+"</b> is unreachable"}c&&d.data("title",c)},setPrinterConnection:function(b){var d=this.$el.find("i.printer"),c="";d.removeClass("blink-animation connected failed").addClass(b);switch(b){case "blink-animation":c="Connecting to printer...";
break;case "connected":c="Connected to printer";$("html").removeClass("no-printer");break;case "failed":$("html").addClass("no-printer"),c="The printer is not connected"}c&&d.data("title",c)},setAstroprintConnection:function(b){var d=this.$el.find("i.astroprint"),c="";d.removeClass("blink-animation connected failed").addClass(b);switch(b){case "blink-animation":c="Connecting to the astroprint.com...";break;case "connected":c="Connected to astroprint.com";break;case "failed":c="Not connected to astroprint.com"}c&&
d.data("title",c)},printerTapped:function(b){b.stopPropagation();$(b.target).hasClass("failed")&&this.connect(!0)},serverTapped:function(b){b.stopPropagation();$(b.target).hasClass("failed")&&(this.socketData.reconnect(),this.connect())},astroprintTapped:function(b){b.stopPropagation();var d=$(b.target);d.hasClass("failed")&&(LOGGED_USER?(d.addClass("blink-animation"),$.ajax({url:API_BASEURL+"boxrouter",method:"POST",dataType:"json",complete:function(b){d.removeClass("blink-animation")}})):$("#login-modal").foundation("reveal",
"open"))},onReachableChanged:function(b,d){switch(d){case "reachable":this.setServerConnection("connected");break;case "unreachable":this.setServerConnection("failed");break;case "checking":this.setServerConnection("blink-animation")}},onMouseOver:function(b){if(!$("html").hasClass("touch")){b=$(b.currentTarget);this.tooltip||(this.tooltip=$('<div class="tooltip radius"><span class="pip"></span><div class="text"></div></div>'),$("body").append(this.tooltip));var d=b.offset(),c=$(document).width(),
f=d.top+b.height()-5,d=c-(d.left+b.outerWidth()/2+10);this.tooltip.css("top",f).css("right",d).css("background",b.css("color")).removeClass("hide").find(".text").html(b.data("title"));this.tooltip.find(".pip").css("border-color","transparent transparent "+b.css("color")+" transparent")}},onMouseOut:function(b){this.tooltip.addClass("hide");this.tooltip.find(".text").html("")}});var TurnoffConfirmationModal=Backbone.View.extend({el:"#turnoff-modal",turnoffView:null,events:{"click button.alert":"onConfirm","click button.secondary":"close"},onConfirm:function(){this.$el.foundation("reveal","close");this.turnoffView||(this.turnoffView=new TurnoffView);app.router.selectView(this.turnoffView);this.turnoffView.doTurnoff()},open:function(){this.$el.foundation("reveal","open")},close:function(){this.$el.foundation("reveal","close")}}),TurnoffView=Backbone.View.extend({el:"#turnoff-view",
doTurnoff:function(){$.ajax({url:API_BASEURL+"system",type:"POST",data:{action:"shutdown"}}).done(_.bind(function(){setTimeout(_.bind(function(){this.$el.addClass("done");this.$el.find(".icon-off").removeClass("blink-animation")},this),6E3)},this)).fail(_.bind(function(){this.$el.find(".icon-off").removeClass("blink-animation");noty({text:"There was an error starting turn off sequence.",timeout:5E3});this.$el.removeClass("active").addClass("hide");$("#app").removeClass("hide")},this))}});var RebootConfirmationModal=Backbone.View.extend({el:"#reboot-modal",rebootView:null,events:{"click button.alert":"onConfirm","click button.secondary":"close"},onConfirm:function(){this.$el.foundation("reveal","close");this.rebootView||(this.rebootView=new RebootView);app.router.selectView(this.rebootView);this.rebootView.doReboot()},open:function(){this.$el.foundation("reveal","open")},close:function(){this.$el.foundation("reveal","close")}}),RebootView=Backbone.View.extend({el:"#reboot-view",doReboot:function(){$.ajax({url:API_BASEURL+
"system",type:"POST",data:{action:"reboot"},success:_.bind(function(){setTimeout(_.bind(function(){this.$el.addClass("done")},this),3E3)},this),error:_.bind(function(){this.$el.find(".icon-refresh").removeClass("animate-spin");noty({text:"There was an error starting reboot sequence.",timeout:5E3})},this)})}});var TempBarHorizontalView=TempBarView.extend({containerDimensions:null,scale:null,type:null,dragging:!1,lastSent:null,events:_.extend(TempBarView.prototype.events,{click:"onClicked"}),setHandle:function(b){if(!this.dragging){var d=this._temp2px(b),c=this.$el.find(".temp-target");c.find("span.target-value").text(b);c.css({transition:"left 0.5s"});c.css({left:d+"px"});setTimeout(function(){c.css({transition:""})},800)}},onTouchMove:function(b){if(this.dragging){b.preventDefault();b.stopPropagation();
var d=this.$(".temp-target");b=("mousemove"==b.type?b.originalEvent.pageX:b.originalEvent.changedTouches[0].clientX)-this.containerDimensions.left-d.innerWidth()/2;b=Math.min(Math.max(b,this.containerDimensions.minLeft),this.containerDimensions.maxLeft);d.find("span.target-value").text(this._px2temp(b));d.css({left:b+"px"})}},onClicked:function(b){b.preventDefault();var d=this.$el.find(".temp-target");b=b.pageX-this.containerDimensions.left-d.innerWidth()/2;b=Math.min(Math.max(b,this.containerDimensions.minLeft),
this.containerDimensions.maxLeft);b=this._px2temp(b);this.setHandle(b);this._sendToolCommand("target",this.type,b)},onResize:function(){var b=this.$el,d=b.find(".temp-target"),c=b.find(".temp-curret-line"),f=b.find(".temp-current"),e=b.find("label"),g=b.width(),f=f.position().left-d.innerWidth(),e=e.innerWidth();this.containerDimensions={left:b.offset().left,width:g,maxLeft:f,minLeft:e,px4degree:(f-e)/(this.scale[1]-this.scale[0])};d.css({left:this._temp2px(this.actual)+"px"});c.css({left:this._temp2px(this.actual)+
d.innerWidth()/2+"px"})},renderTemps:function(b,d){var c=this.$el.find(".temp-target"),f=c.innerWidth();null!==d&&d!=c.find("span.target-value").text()&&this.setHandle(Math.min(Math.round(d),this.scale[1]));null!==b&&(this.$el.find(".temp-current").html(Math.round(b)+"&deg;"),this.$el.find(".temp-curret-line").css({left:this._temp2px(b)+f/2+"px"}))},_temp2px:function(b){return this.containerDimensions.minLeft+b*this.containerDimensions.px4degree},_px2temp:function(b){return Math.round((b-this.containerDimensions.minLeft)/
this.containerDimensions.px4degree)}}),PhotoView=CameraViewBase.extend({el:"#printing-view .camera-view",template:_.template(this.$("#photo-printing-template").html()),events:{"click button.take-pic":"onCameraBtnClicked","change .timelapse select":"timelapseFreqChanged","change #camera-mode-printing":"cameraModeChanged"},parent:null,print_capture:null,photoSeq:0,initialize:function(b){this.print_capture=app.socketData.get("print_capture");this.parent=b.parent;this.listenTo(app.socketData,"change:printing_progress",
this.onPrintingProgressChanged);this.initCamera()},onCameraBtnClicked:function(b){b.preventDefault();var d=$(b.currentTarget).closest(".loading-button");$(".icon-3d-object").hide();d.addClass("loading");this.buttonEvent().fail(function(){$(".icon-3d-object").show();noty({text:"Camera Error.",timeout:3E3})}).always(function(){d.removeClass("loading")})},getPhotoContainer:function(){return this.$(".camera-image")},getVideoContainer:function(){return this.$("#video-stream")},cameraModeChanged:function(b){b=
$(b.currentTarget);var d=this.$("#freqSelector").val();"video"==this.cameraMode&&this.stopStreaming();this.cameraMode=this.cameraModeByValue(b.is(":checked"));this.render();this.$("#freqSelector").val(d)},manageVideoStreamingEvent:function(b){this.onHide();this.videoStreamingError=b.message;-1<b.message.indexOf("camera settings have been changed")?this.videoStreamingErrorTitle="Camera settings changed":this.videoStreamingErrorTitle=null;this.render()},cameraInitialized:function(){CameraViewBase.prototype.cameraInitialized.call(this);
app.eventManager.on("astrobox:videoStreamingEvent",this.manageVideoStreamingEvent,this);this.listenTo(app.socketData,"change:print_capture",this.onPrintCaptureChanged);this.listenTo(app.socketData,"change:camera",this.onCameraChanged);this.onCameraChanged(app.socketData,app.socketData.get("camera"));this.print_capture=app.socketData.get("print_capture")},render:function(){this.$el.html(this.template());var b=this.$(".camera-image"),d=null;this.print_capture&&this.print_capture.last_photo?d=this.print_capture.last_photo:
this.parent.printing_progress&&this.parent.printing_progress.rendered_image&&(d=this.parent.printing_progress.rendered_image);b.attr("src")!=d&&b.attr("src",d);this.canStream||(!this.print_capture||this.print_capture.paused&&"layer"!=this.print_capture.freq?this.$(".timelapse .dot").removeClass("blink-animation"):this.$(".timelapse .dot").addClass("blink-animation"));this.parent.paused?this.$(".timelapse .overlay").show():this.$(".timelapse .overlay").hide();b=0;this.print_capture&&(b=this.print_capture.freq);
this.$(".timelapse select").val(b)},onCameraChanged:function(b,d){var c=this.$(".camera-controls");d?c.hasClass("hide")&&c.removeClass("hide"):c.hasClass("hide")||c.addClass("hide")},onPrintCaptureChanged:function(b,d){if(this.print_capture=d)"photo"==this.cameraMode&&d&&d.last_photo&&this.$(".camera-image").attr("src",d.last_photo),this.$(".timelapse select").val(d.freq)},onPrintingProgressChanged:function(b,d){var c=this.$(".camera-image"),f=c.attr("src");setTimeout(_.bind(function(){!f&&d&&(this.cameraAvailable?
"photo"==this.cameraMode&&(d.last_photo?c.attr("src",d.last_photo):d.rendered_image&&c.attr("src",d.rendered_image)):f!=d.rendered_image&&c.attr("src",d.rendered_image))},this),1)},refreshPhoto:function(b){var d=$(b.target).closest(".loading-button");d.addClass("loading");"photo"==this.cameraMode&&(b=this.$(".camera-image"),b.one("load",function(){d.removeClass("loading")}),b.one("error",function(){d.removeClass("loading");$(this).attr("src",null)}),b.attr("src","/camera/snapshot?apikey="+UI_API_KEY+
"&text="+encodeURIComponent(text)+"&seq="+this.photoSeq++))},timelapseFreqChanged:function(b){b=$(b.target).val();this.print_capture&&b==this.print_capture.freq||$.ajax({url:API_BASEURL+"camera/timelapse",type:"POST",dataType:"json",data:{freq:b}}).fail(_.bind(function(b){402==b.status?(this.$(".timelapse").addClass("hide"),this.$(".locked").removeClass("hide"),$("#upgrade-plan").foundation("reveal","open")):noty({text:"There was an error adjusting your print capture.",timeout:3E3})},this))},onPrintingHide:function(){"video"==
this.cameraMode&&this.stopStreaming()}}),PrintingView=Backbone.View.extend({el:"#printing-view",events:{"click button.stop-print":"stopPrint","click button.pause-print":"togglePausePrint","click button.controls":"showControlPage",show:"show",hide:"onHide"},nozzleBar:null,bedBar:null,photoView:null,printing_progress:null,paused:null,cancelDialog:null,initialize:function(){this.nozzleBar=new TempBarHorizontalView({scale:[0,app.printerProfile.get("max_nozzle_temp")],el:this.$el.find(".temp-bar.nozzle"),
type:"tool0"});this.bedBar=new TempBarHorizontalView({scale:[0,app.printerProfile.get("max_bed_temp")],el:this.$el.find(".temp-bar.bed"),type:"bed"});this.printing_progress=app.socketData.get("printing_progress");this.paused=app.socketData.get("paused");this.listenTo(app.socketData,"change:temps",this.onTempsChanged);this.listenTo(app.socketData,"change:paused",this.onPausedChanged);this.listenTo(app.socketData,"change:printing_progress",this.onProgressChanged);this.photoView=new PhotoView({parent:this})},
render:function(){var b=this.$(".progress .filename");this.printing_progress&&(b.text()!=this.printing_progress.printFileName&&b.text(this.printing_progress.printFileName),this.$el.find(".progress .meter").css("width",this.printing_progress.percent+"%"),this.$el.find(".progress .progress-label").text(this.printing_progress.percent+"%"),b=this._formatTime(this.printing_progress.time_left),this.$el.find(".estimated-hours").text(b[0]),this.$el.find(".estimated-minutes").text(b[1]),this.$el.find(".estimated-seconds").text(b[2]),
this.$el.find(".current-layer").text(this.printing_progress.current_layer),this.printing_progress.layer_count&&this.$el.find(".layer-count").text(this.printing_progress.layer_count),this.printing_progress.heating_up?this.$el.addClass("heating-up"):this.$el.removeClass("heating-up"));var b=this.$el.find("button.pause-print"),d=this.$el.find("button.controls");this.paused?(b.html('<i class="icon-play"></i> Resume Print'),d.show()):(b.html('<i class="icon-pause"></i> Pause Print'),d.hide());b=app.printerProfile.toJSON();
this.nozzleBar.setMax(b.max_nozzle_temp);b.heated_bed?(this.bedBar.setMax(b.max_bed_temp),this.bedBar.$el.removeClass("hide")):this.bedBar.$el.addClass("hide")},onTempsChanged:function(b,d){this.$el.hasClass("hide")||(this.nozzleBar.setTemps(d.extruder.actual,d.extruder.target),this.bedBar.setTemps(d.bed.actual,d.bed.target))},onProgressChanged:function(b,d){this.printing_progress=d;this.render()},onPausedChanged:function(b,d){this.paused=d;this.render();this.photoView.render()},_formatTime:function(b){if(null==
b||isNaN(b))return["--","--","--"];b=parseInt(b,10);var d=Math.floor(b/3600),c=Math.floor((b-3600*d)/60);b=b-3600*d-60*c;10>d&&(d="0"+d);10>c&&(c="0"+c);10>b&&(b="0"+b);return[d,c,b]},show:function(){this.nozzleBar.onResize();this.bedBar.onResize();this.printing_progress=app.socketData.get("printing_progress");this.paused=app.socketData.get("paused");this.render();this.photoView.render()},onHide:function(){this.photoView.onPrintingHide()},stopPrint:function(b){this.cancelDialog||(this.cancelDialog=
new CancelPrintDialog({parent:this}));this.cancelDialog.open()},togglePausePrint:function(b){var d=$(b.target).closest(".loading-button"),c=app.socketData.get("paused");d.addClass("loading");this._jobCommand("pause",null,function(b){b&&_.has(b,"error")?console.error(b.error):app.socketData.set("paused",!c);d.removeClass("loading")})},showControlPage:function(){app.router.navigate("control",{trigger:!0,replace:!0});this.$el.addClass("hide")},_jobCommand:function(b,d,c){$.ajax({url:API_BASEURL+"job",
type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8",data:JSON.stringify(_.extend({command:b},d))}).done(function(b){c&&c(b)}).fail(function(b){c&&c({error:b.responseText})})}}),CancelPrintDialog=Backbone.View.extend({el:"#cancel-print-modal",printJobId:null,events:{"click button.yes":"onYesClicked","click button.send":"onSendClicked","click button.no":"close","change input[name=reason]":"onReasonChanged"},parent:null,initialize:function(b){this.parent=b.parent},open:function(){this.printJobId=
null;this.$el.foundation("reveal","open");this.$("input[name=reason]").prop("checked",!1);this.$("input[name=other_text]").val("").addClass("hide");this.$(".ask").removeClass("hide");this.$(".reasons").addClass("hide").find("h3").removeClass("animated bounceIn")},close:function(){this.$el.foundation("reveal","close")},onYesClicked:function(b){b.preventDefault();var d=$(b.target).closest(".loading-button");d.addClass("loading");this.parent._jobCommand("cancel",null,_.bind(function(b){this.parent.photoView.onHide();
b&&_.has(b,"error")?("no_active_print"==JSON.parse(b.error).id?(noty({text:"No Print Job is active",type:"warning",timeout:3E3}),this.close()):noty({text:"There was an error canceling your job.",timeout:3E3}),d.removeClass("loading")):b.print_job_id?(this.printJobId=b.print_job_id,this.$(".ask").addClass("hide"),this.$(".reasons").removeClass("hide").find("h3").addClass("animated bounceIn"),d.removeClass("loading")):setTimeout(_.bind(function(){d.removeClass("loading");this.close()},this),1500)},
this))},onSendClicked:function(b){var d=this.$("input[name=reason]:checked").val();if(d&&this.printJobId){var c=$(b.target).closest(".loading-button");b=null;c.addClass("loading");b={reason:d};"other"==d&&(d=this.$("input[name=other_text]").val())&&(b.other_text=d);$.ajax({url:API_BASEURL+"astroprint/print-jobs/"+this.printJobId+"/add-reason",type:"PUT",dataType:"json",contentType:"application/json; charset=UTF-8",data:JSON.stringify(b)}).always(_.bind(function(){c.removeClass("loading");this.close()},
this)).fail(function(b){console.error(b)})}else this.close()},onReasonChanged:function(b){b=$(b.currentTarget).val();var d=this.$("input[name=other_text]");"other"==b?d.removeClass("hide").focus():d.addClass("hide")}});var UnreachableView=Backbone.View.extend({el:"#unreachable-view",events:{"click button":"onCheckClicked"},initialize:function(){this.listenTo(app.socketData,"change:box_reachable",this.onReachableChanged)},hide:function(){this.$el.addClass("hide");this.$(".loading-button").removeClass("loading");$("#app").removeClass("hide")},onCheckClicked:function(b){b.preventDefault();app.socketData.reconnect()},onReachableChanged:function(b,d){var c=this.$(".loading-button");"checking"==d?c.addClass("loading"):
c.removeClass("loading")}});var CameraView=CameraViewBase.extend({el:"#camera-view",template:_.template($("#camera-watch-page-template").html()),serverUrl:null,events:{hide:"onHide",show:"onShow","click .buttons .columns button":"onCameraBtnClicked","change #camera-mode-camera":"cameraModeChanged"},manageVideoStreamingEvent:function(b){this.onHide();this.videoStreamingError=b.message;-1<b.message.indexOf("camera settings have been changed")?this.videoStreamingErrorTitle="Camera settings changed":this.videoStreamingErrorTitle=
null;this.render()},onCameraBtnClicked:function(b){b.preventDefault();var d=$(b.currentTarget).closest(".loading-button");$(".camera-screen").hide();d.addClass("loading");this.buttonEvent().fail(function(){$(".camera-screen").show();noty({text:"Camera error.",timeout:3E3})}).always(function(){d.removeClass("loading")})},getPhotoContainer:function(){return this.$(".camera-image")},getVideoContainer:function(){return this.$("#video-stream")}});var SuppliesView=Backbone.View.extend({el:"#supplies-view",initialize:function(){},onShow:function(){}});var HelpView=Backbone.View.extend({el:"#help-view",initialize:function(){},onShow:function(){}});var TerminalView=Backbone.View.extend({el:"#terminal-view",outputView:null,ignoreReceived:["wait"],events:{"submit form":"onSend",show:"onShow",hide:"onHide","click button.clear":"onClear","click .alert-box.warning a":"onDismissAlert"},initialize:function(){this.outputView=new OutputView;app.eventManager.on("astrobox:commsData",_.bind(function(b){"r"==b.direction&&_.contains(this.ignoreReceived,b.data)||this.outputView.add(b.direction,b.data)},this))},onClear:function(b){b.preventDefault();this.outputView.clear()},
onSend:function(b){b.preventDefault();var d=this.$("input"),c=d.val().toUpperCase();if(c){var f=this.$("button.send").closest(".loading-button");f.addClass("loading");$.ajax({url:API_BASEURL+"printer/comm/send",method:"POST",data:{command:c}}).fail(_.bind(function(){f.addClass("error");this.outputView.add("s",c,!0);setTimeout(function(){f.removeClass("error")},3E3)},this)).always(function(){f.removeClass("loading");d.val("")})}return!1},onShow:function(){this.$("input").focus();$.ajax({url:API_BASEURL+
"printer/comm/listen",method:"POST"})},onHide:function(){$.ajax({url:API_BASEURL+"printer/comm/listen",method:"DELETE"})},onDismissAlert:function(b){b.preventDefault();this.$(".alert-box.warning").remove()}}),OutputView=Backbone.View.extend({el:"#terminal-view .output-container",add:function(b,d,c){switch(b){case "s":d='<div class="sent bold'+(c?" failed":"")+'"><i class="icon-'+(c?"attention":"angle-right")+'""></i>'+d+(c?" <small>(failed to sent)</small>":"")+"</div>";break;case "r":d='<div class="received"><i class="icon-angle-left"></i>'+
d+"</div>"}this.$el.append(d);this.$el.scrollTop(this.$el[0].scrollHeight)},clear:function(){this.$el.html("")}});var AppRouter=Backbone.Router.extend({homeView:null,filesView:null,controlView:null,settingsView:null,printingView:null,terminalView:null,cameraView:null,suppliesView:null,helpView:null,routes:{"":"home",files:"files","file-info/:fileId":"fileInfo",control:"control",printing:"printing",settings:"settings","settings/:page":"settings","gcode-terminal":"terminal",camera:"camera",supplies:"supplies",help:"help","*notFound":"notFound"},turningOff:!1,execute:function(b,d){if(b){is_paused=app.socketData.get("paused");
if((is_printing=app.socketData.get("printing"))||is_paused){if(app.setPrinting(),b!=this.printing&&(b!=this.control||!is_paused)){this.navigate("printing",{trigger:!0,replace:!0});return}}else if(b==this.printing){this.navigate("",{trigger:!0,replace:!0});return}b.apply(this,d)}},home:function(){this.homeView||(this.homeView=new HomeView({forceSync:!1}));this.selectView(this.homeView);app.selectQuickNav("dash")},files:function(){this.loadFilesView(!1);this.selectView(this.filesView);app.selectQuickNav("files")},
fileInfo:function(b){var d=_.bind(function(c){c&&this.filesView.fileInfo(b)},this);this.filesView?this.filesView.printFilesListView.refresh(!0,d):this.filesView=new FilesView({forceSync:!0,syncCompleted:d});this.navigate("files",{trigger:!0,replace:!0})},control:function(){this.controlView||(this.controlView=new ControlView);this.selectView(this.controlView);app.selectQuickNav("control")},printing:function(){this.printingView||(this.printingView=new PrintingView);this.selectView(this.printingView)},
settings:function(b){this.settingsView||(this.settingsView=new SettingsView);this.selectView(this.settingsView);this.settingsView.menu.changeActive(b||"printer-connection");app.selectQuickNav("settings")},terminal:function(){this.terminalView||(this.terminalView=new TerminalView);this.selectView(this.terminalView)},camera:function(){this.cameraView||(this.cameraView=new CameraView);this.selectView(this.cameraView);app.selectQuickNav("camera")},selectView:function(b){var d=app.$el.find(".app-view.active");
b=b.$el;var c=b.attr("id");b.removeClass("hide").addClass("active");b.trigger("show");b.data("fullscreen")?($("#app").addClass("hide"),d.each(function(b,d){var g=$(d);g.attr("id")!=c&&g.data("fullscreen")&&g.addClass("hide").removeClass("active")}),d.trigger("hide")):(d.attr("id")!=c&&(d.addClass("hide").removeClass("active"),d.trigger("hide"),"control-view"==c&&this.controlView.tempView.resetBars()),app.selectQuickNav())},notFound:function(){this.navigate("",{trigger:!0,replace:!0})},supplies:function(){this.suppliesView||
(this.suppliesView=new SuppliesView);this.selectView(this.suppliesView)},help:function(){this.helpView||(this.helpView=new HelpView);this.selectView(this.helpView)},loadFilesView:function(b){if(this.filesView)return!0;var d=$.Deferred();this.filesView=new FilesView({forceSync:b,syncCompleted:function(b){b?d.resolve():d.reject("unable_to_refresh")}});return d}});$.ajaxSetup({type:"POST",cache:!1,headers:{"X-Api-Key":UI_API_KEY}});
var AppMenu=Backbone.View.extend({el:"#main-menu",turnOffModal:null,events:{"click li.logout":"logoutClicked"},logoutClicked:function(b){b.preventDefault();var d=$(b.currentTarget).find(".icon-rocket-spinner");d.removeClass("hide");$.ajax({url:API_BASEURL+"astroprint",type:"DELETE",success:function(){location.reload()},complete:function(){d.addClass("hide")}})}}),AstroBoxApp=Backbone.View.extend({el:"body",eventManager:null,appMenu:null,socketData:null,utils:null,router:null,connectionView:null,unreachableView:null,
turnOffModal:null,printerProfile:null,events:{"click button.turn-off, a.turn-off":"turnOffClicked","click button.reboot":"rebootClicked","click a.launch-ap":"launchAstroPrint"},initialize:function(){this.socketData=new SocketData;this.appMenu=new AppMenu;this.utils=new Utils;this.router=new AppRouter;this.connectionView=new ConnectionView({socket:this.socketData});this.printerProfile=new PrinterProfile(initial_printer_profile);this.eventManager=Backbone.Events;this.socketData.connectionView=this.connectionView;
this.socketData.connect(WS_TOKEN);this.listenTo(this.socketData,"change:printing",this.reportPrintingChange);this.listenTo(this.socketData,"change:online",this.onlineStatusChange);this.listenTo(this.socketData,"change:box_reachable",this.onReachableChanged)},turnOffClicked:function(){this.turnOffModal||(this.turnOffModal=new TurnoffConfirmationModal);this.turnOffModal.open()},rebootClicked:function(){this.rebootModal||(this.rebootModal=new RebootConfirmationModal);this.rebootModal.open()},reportPrintingChange:function(b,
d){d?(this.$(".quick-nav").hide(),this.setPrinting(),this.router.navigate("printing",{replace:!0,trigger:!0})):(this.socketData.set({printing_progress:null,print_capture:null,paused:!1},{silent:!0}),$("body").removeClass("printing"),this.$(".quick-nav").show(),this.router.navigate("control",{replace:!0,trigger:!0}))},selectQuickNav:function(b){var d=this.$(".quick-nav");d.find("li.active").removeClass("active");b&&d.find("li."+b).addClass("active")},onlineStatusChange:function(b,d){d?this.$("#app").addClass("online").removeClass("offline"):
this.$("#app").addClass("offline").removeClass("online")},onReachableChanged:function(b,d){"reachable"!=d?setTimeout(_.bind(function(){"unreachable"==this.socketData.get("box_reachable")&&(this.unreachableView||(this.unreachableView=new UnreachableView),this.router.selectView(this.unreachableView))},this),1E3):this.unreachableView&&this.unreachableView.hide()},setPrinting:function(){$("body").addClass("printing");this.$(".quick-nav").hide()},launchAstroPrint:function(b){b.preventDefault();initial_states.userLogged?
this.launchingAp||(this.launchingAp=!0,$.getJSON(API_BASEURL+"astroprint/login-key").done(function(b){location.href="https://cloud.astroprint.com/account/loginKey/"+b.login_key}).fail(function(){location.href="https://cloud.astroprint.com/account/login"}).always(_.bind(function(){this.launchingAp=!1},this))):location.href="https://cloud.astroprint.com/account/login"}});app=new AstroBoxApp;
navigator.sayswho=function(){var b=navigator.userAgent,d,c=b.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(c[1]))return d=/\brv[ :]+(\d+)/g.exec(b)||[],"IE "+(d[1]||"");if("Chrome"===c[1]&&(d=b.match(/\b(OPR|Edge)\/(\d+)/),null!=d))return d.slice(1).join(" ").replace("OPR","Opera");c=c[2]?[c[1],c[2]]:[navigator.appName,navigator.appVersion,"-?"];null!=(d=b.match(/version\/(\d+)/i))&&c.splice(1,1,d[1]);return c.join(" ")}();var navigatorPrevent=!0;Backbone.history.start();
